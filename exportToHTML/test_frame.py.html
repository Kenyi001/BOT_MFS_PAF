<html>
<head>
<title>test_frame.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #5f826b; font-style: italic;}
.s1 { color: #bcbec4;}
.s2 { color: #cf8e6d;}
.s3 { color: #bcbec4;}
.s4 { color: #6aab73;}
.s5 { color: #7a7e85;}
.s6 { color: #2aacb8;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_frame.py</font>
</center></td></tr></table>
<pre><span class="s0">&quot;&quot;&quot; Test cases for DataFrame.plot &quot;&quot;&quot;</span>
<span class="s2">from </span><span class="s1">datetime </span><span class="s2">import </span><span class="s3">(</span>
    <span class="s1">date</span><span class="s3">,</span>
    <span class="s1">datetime</span><span class="s3">,</span>
<span class="s3">)</span>
<span class="s2">import </span><span class="s1">gc</span>
<span class="s2">import </span><span class="s1">itertools</span>
<span class="s2">import </span><span class="s1">re</span>
<span class="s2">import </span><span class="s1">string</span>
<span class="s2">import </span><span class="s1">weakref</span>

<span class="s2">import </span><span class="s1">numpy </span><span class="s2">as </span><span class="s1">np</span>
<span class="s2">import </span><span class="s1">pytest</span>

<span class="s2">from </span><span class="s1">pandas</span><span class="s3">.</span><span class="s1">core</span><span class="s3">.</span><span class="s1">dtypes</span><span class="s3">.</span><span class="s1">api </span><span class="s2">import </span><span class="s1">is_list_like</span>

<span class="s2">import </span><span class="s1">pandas </span><span class="s2">as </span><span class="s1">pd</span>
<span class="s2">from </span><span class="s1">pandas </span><span class="s2">import </span><span class="s3">(</span>
    <span class="s1">DataFrame</span><span class="s3">,</span>
    <span class="s1">MultiIndex</span><span class="s3">,</span>
    <span class="s1">PeriodIndex</span><span class="s3">,</span>
    <span class="s1">Series</span><span class="s3">,</span>
    <span class="s1">bdate_range</span><span class="s3">,</span>
    <span class="s1">date_range</span><span class="s3">,</span>
    <span class="s1">plotting</span><span class="s3">,</span>
<span class="s3">)</span>
<span class="s2">import </span><span class="s1">pandas</span><span class="s3">.</span><span class="s1">_testing </span><span class="s2">as </span><span class="s1">tm</span>
<span class="s2">from </span><span class="s1">pandas</span><span class="s3">.</span><span class="s1">tests</span><span class="s3">.</span><span class="s1">plotting</span><span class="s3">.</span><span class="s1">common </span><span class="s2">import </span><span class="s3">(</span>
    <span class="s1">_check_ax_scales</span><span class="s3">,</span>
    <span class="s1">_check_axes_shape</span><span class="s3">,</span>
    <span class="s1">_check_box_return_type</span><span class="s3">,</span>
    <span class="s1">_check_colors</span><span class="s3">,</span>
    <span class="s1">_check_data</span><span class="s3">,</span>
    <span class="s1">_check_grid_settings</span><span class="s3">,</span>
    <span class="s1">_check_has_errorbars</span><span class="s3">,</span>
    <span class="s1">_check_legend_labels</span><span class="s3">,</span>
    <span class="s1">_check_plot_works</span><span class="s3">,</span>
    <span class="s1">_check_text_labels</span><span class="s3">,</span>
    <span class="s1">_check_ticks_props</span><span class="s3">,</span>
    <span class="s1">_check_visible</span><span class="s3">,</span>
    <span class="s1">get_y_axis</span><span class="s3">,</span>
<span class="s3">)</span>

<span class="s2">from </span><span class="s1">pandas</span><span class="s3">.</span><span class="s1">io</span><span class="s3">.</span><span class="s1">formats</span><span class="s3">.</span><span class="s1">printing </span><span class="s2">import </span><span class="s1">pprint_thing</span>

<span class="s1">mpl </span><span class="s3">= </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">importorskip</span><span class="s3">(</span><span class="s4">&quot;matplotlib&quot;</span><span class="s3">)</span>
<span class="s1">plt </span><span class="s3">= </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">importorskip</span><span class="s3">(</span><span class="s4">&quot;matplotlib.pyplot&quot;</span><span class="s3">)</span>


<span class="s2">class </span><span class="s1">TestDataFramePlots</span><span class="s3">:</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s2">def </span><span class="s1">test_plot</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">makeTimeDataFrame</span><span class="s3">()</span>
        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">grid</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s2">def </span><span class="s1">test_plot_subplots</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">makeTimeDataFrame</span><span class="s3">()</span>
        <span class="s5"># _check_plot_works adds an ax so use default_axes=True to avoid warning</span>
        <span class="s1">axes </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">default_axes</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">subplots</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s1">_check_axes_shape</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">, </span><span class="s1">axes_num</span><span class="s3">=</span><span class="s6">4</span><span class="s3">, </span><span class="s1">layout</span><span class="s3">=(</span><span class="s6">4</span><span class="s3">, </span><span class="s6">1</span><span class="s3">))</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s2">def </span><span class="s1">test_plot_subplots_negative_layout</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">makeTimeDataFrame</span><span class="s3">()</span>
        <span class="s1">axes </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">,</span>
            <span class="s1">default_axes</span><span class="s3">=</span><span class="s2">True</span><span class="s3">,</span>
            <span class="s1">subplots</span><span class="s3">=</span><span class="s2">True</span><span class="s3">,</span>
            <span class="s1">layout</span><span class="s3">=(-</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">),</span>
        <span class="s3">)</span>
        <span class="s1">_check_axes_shape</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">, </span><span class="s1">axes_num</span><span class="s3">=</span><span class="s6">4</span><span class="s3">, </span><span class="s1">layout</span><span class="s3">=(</span><span class="s6">2</span><span class="s3">, </span><span class="s6">2</span><span class="s3">))</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s2">def </span><span class="s1">test_plot_subplots_use_index</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">makeTimeDataFrame</span><span class="s3">()</span>
        <span class="s1">axes </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">,</span>
            <span class="s1">default_axes</span><span class="s3">=</span><span class="s2">True</span><span class="s3">,</span>
            <span class="s1">subplots</span><span class="s3">=</span><span class="s2">True</span><span class="s3">,</span>
            <span class="s1">use_index</span><span class="s3">=</span><span class="s2">False</span><span class="s3">,</span>
        <span class="s3">)</span>
        <span class="s1">_check_ticks_props</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">, </span><span class="s1">xrot</span><span class="s3">=</span><span class="s6">0</span><span class="s3">)</span>
        <span class="s1">_check_axes_shape</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">, </span><span class="s1">axes_num</span><span class="s3">=</span><span class="s6">4</span><span class="s3">, </span><span class="s1">layout</span><span class="s3">=(</span><span class="s6">4</span><span class="s3">, </span><span class="s6">1</span><span class="s3">))</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">xfail</span><span class="s3">(</span><span class="s1">reason</span><span class="s3">=</span><span class="s4">&quot;Api changed in 3.6.0&quot;</span><span class="s3">)</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s2">def </span><span class="s1">test_plot_invalid_arg</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;x&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">], </span><span class="s4">&quot;y&quot;</span><span class="s3">: [</span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">]})</span>
        <span class="s1">msg </span><span class="s3">= </span><span class="s4">&quot;'Line2D' object has no property 'blarg'&quot;</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">AttributeError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">blarg</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s2">def </span><span class="s1">test_plot_tick_props</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">((</span><span class="s6">10</span><span class="s3">, </span><span class="s6">3</span><span class="s3">)),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s1">string</span><span class="s3">.</span><span class="s1">ascii_letters</span><span class="s3">[:</span><span class="s6">10</span><span class="s3">]),</span>
        <span class="s3">)</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">use_index</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s1">_check_ticks_props</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xrot</span><span class="s3">=</span><span class="s6">0</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;kwargs&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s3">{</span><span class="s4">&quot;yticks&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">5</span><span class="s3">, </span><span class="s6">10</span><span class="s3">]},</span>
            <span class="s3">{</span><span class="s4">&quot;xticks&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">5</span><span class="s3">, </span><span class="s6">10</span><span class="s3">]},</span>
            <span class="s3">{</span><span class="s4">&quot;ylim&quot;</span><span class="s3">: (-</span><span class="s6">100</span><span class="s3">, </span><span class="s6">100</span><span class="s3">), </span><span class="s4">&quot;xlim&quot;</span><span class="s3">: (-</span><span class="s6">100</span><span class="s3">, </span><span class="s6">100</span><span class="s3">)},</span>
            <span class="s3">{</span><span class="s4">&quot;default_axes&quot;</span><span class="s3">: </span><span class="s2">True</span><span class="s3">, </span><span class="s4">&quot;subplots&quot;</span><span class="s3">: </span><span class="s2">True</span><span class="s3">, </span><span class="s4">&quot;title&quot;</span><span class="s3">: </span><span class="s4">&quot;blah&quot;</span><span class="s3">},</span>
        <span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_plot_other_args</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">kwargs</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">((</span><span class="s6">10</span><span class="s3">, </span><span class="s6">3</span><span class="s3">)),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s1">string</span><span class="s3">.</span><span class="s1">ascii_letters</span><span class="s3">[:</span><span class="s6">10</span><span class="s3">]),</span>
        <span class="s3">)</span>
        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, **</span><span class="s1">kwargs</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s2">def </span><span class="s1">test_plot_visible_ax</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">((</span><span class="s6">10</span><span class="s3">, </span><span class="s6">3</span><span class="s3">)),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s1">string</span><span class="s3">.</span><span class="s1">ascii_letters</span><span class="s3">[:</span><span class="s6">10</span><span class="s3">]),</span>
        <span class="s3">)</span>
        <span class="s5"># We have to redo it here because _check_plot_works does two plots,</span>
        <span class="s5"># once without an ax kwarg and once with an ax kwarg and the new sharex</span>
        <span class="s5"># behaviour does not remove the visibility of the latter axis (as ax is</span>
        <span class="s5"># present).  see: https://github.com/pandas-dev/pandas/issues/9737</span>

        <span class="s1">axes </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">subplots</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">title</span><span class="s3">=</span><span class="s4">&quot;blah&quot;</span><span class="s3">)</span>
        <span class="s1">_check_axes_shape</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">, </span><span class="s1">axes_num</span><span class="s3">=</span><span class="s6">3</span><span class="s3">, </span><span class="s1">layout</span><span class="s3">=(</span><span class="s6">3</span><span class="s3">, </span><span class="s6">1</span><span class="s3">))</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes</span><span class="s3">[:</span><span class="s6">2</span><span class="s3">]:</span>
            <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">xaxis</span><span class="s3">)  </span><span class="s5"># xaxis must be visible for grid</span>
            <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticklabels</span><span class="s3">(), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>
            <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticklabels</span><span class="s3">(</span><span class="s1">minor</span><span class="s3">=</span><span class="s2">True</span><span class="s3">), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>
            <span class="s1">_check_visible</span><span class="s3">([</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">xaxis</span><span class="s3">.</span><span class="s1">get_label</span><span class="s3">()], </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s3">[</span><span class="s1">axes</span><span class="s3">[</span><span class="s6">2</span><span class="s3">]]:</span>
            <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">xaxis</span><span class="s3">)</span>
            <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticklabels</span><span class="s3">())</span>
            <span class="s1">_check_visible</span><span class="s3">([</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">xaxis</span><span class="s3">.</span><span class="s1">get_label</span><span class="s3">()])</span>
            <span class="s1">_check_ticks_props</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xrot</span><span class="s3">=</span><span class="s6">0</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s2">def </span><span class="s1">test_plot_title</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">((</span><span class="s6">10</span><span class="s3">, </span><span class="s6">3</span><span class="s3">)),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s1">string</span><span class="s3">.</span><span class="s1">ascii_letters</span><span class="s3">[:</span><span class="s6">10</span><span class="s3">]),</span>
        <span class="s3">)</span>
        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">title</span><span class="s3">=</span><span class="s4">&quot;blah&quot;</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s2">def </span><span class="s1">test_plot_multiindex</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">tuples </span><span class="s3">= </span><span class="s1">zip</span><span class="s3">(</span><span class="s1">string</span><span class="s3">.</span><span class="s1">ascii_letters</span><span class="s3">[:</span><span class="s6">10</span><span class="s3">], </span><span class="s1">range</span><span class="s3">(</span><span class="s6">10</span><span class="s3">))</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">((</span><span class="s6">10</span><span class="s3">, </span><span class="s6">3</span><span class="s3">)),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">MultiIndex</span><span class="s3">.</span><span class="s1">from_tuples</span><span class="s3">(</span><span class="s1">tuples</span><span class="s3">),</span>
        <span class="s3">)</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">use_index</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s1">_check_ticks_props</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xrot</span><span class="s3">=</span><span class="s6">0</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s2">def </span><span class="s1">test_plot_multiindex_unicode</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s5"># unicode</span>
        <span class="s1">index </span><span class="s3">= </span><span class="s1">MultiIndex</span><span class="s3">.</span><span class="s1">from_tuples</span><span class="s3">(</span>
            <span class="s3">[</span>
                <span class="s3">(</span><span class="s4">&quot;</span><span class="s2">\u03b1</span><span class="s4">&quot;</span><span class="s3">, </span><span class="s6">0</span><span class="s3">),</span>
                <span class="s3">(</span><span class="s4">&quot;</span><span class="s2">\u03b1</span><span class="s4">&quot;</span><span class="s3">, </span><span class="s6">1</span><span class="s3">),</span>
                <span class="s3">(</span><span class="s4">&quot;</span><span class="s2">\u03b2</span><span class="s4">&quot;</span><span class="s3">, </span><span class="s6">2</span><span class="s3">),</span>
                <span class="s3">(</span><span class="s4">&quot;</span><span class="s2">\u03b2</span><span class="s4">&quot;</span><span class="s3">, </span><span class="s6">3</span><span class="s3">),</span>
                <span class="s3">(</span><span class="s4">&quot;</span><span class="s2">\u03b3</span><span class="s4">&quot;</span><span class="s3">, </span><span class="s6">4</span><span class="s3">),</span>
                <span class="s3">(</span><span class="s4">&quot;</span><span class="s2">\u03b3</span><span class="s4">&quot;</span><span class="s3">, </span><span class="s6">5</span><span class="s3">),</span>
                <span class="s3">(</span><span class="s4">&quot;</span><span class="s2">\u03b4</span><span class="s4">&quot;</span><span class="s3">, </span><span class="s6">6</span><span class="s3">),</span>
                <span class="s3">(</span><span class="s4">&quot;</span><span class="s2">\u03b4</span><span class="s4">&quot;</span><span class="s3">, </span><span class="s6">7</span><span class="s3">),</span>
            <span class="s3">],</span>
            <span class="s1">names</span><span class="s3">=[</span><span class="s4">&quot;i0&quot;</span><span class="s3">, </span><span class="s4">&quot;i1&quot;</span><span class="s3">],</span>
        <span class="s3">)</span>
        <span class="s1">columns </span><span class="s3">= </span><span class="s1">MultiIndex</span><span class="s3">.</span><span class="s1">from_tuples</span><span class="s3">(</span>
            <span class="s3">[(</span><span class="s4">&quot;bar&quot;</span><span class="s3">, </span><span class="s4">&quot;</span><span class="s2">\u0394</span><span class="s4">&quot;</span><span class="s3">), (</span><span class="s4">&quot;bar&quot;</span><span class="s3">, </span><span class="s4">&quot;</span><span class="s2">\u0395</span><span class="s4">&quot;</span><span class="s3">)], </span><span class="s1">names</span><span class="s3">=[</span><span class="s4">&quot;c0&quot;</span><span class="s3">, </span><span class="s4">&quot;c1&quot;</span><span class="s3">]</span>
        <span class="s3">)</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">integers</span><span class="s3">(</span><span class="s6">0</span><span class="s3">, </span><span class="s6">10</span><span class="s3">, (</span><span class="s6">8</span><span class="s3">, </span><span class="s6">2</span><span class="s3">)),</span>
            <span class="s1">columns</span><span class="s3">=</span><span class="s1">columns</span><span class="s3">,</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">index</span><span class="s3">,</span>
        <span class="s3">)</span>
        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">title</span><span class="s3">=</span><span class="s4">&quot;</span><span class="s2">\u03A3</span><span class="s4">&quot;</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;layout&quot;</span><span class="s3">, [</span><span class="s2">None</span><span class="s3">, (-</span><span class="s6">1</span><span class="s3">, </span><span class="s6">1</span><span class="s3">)])</span>
    <span class="s2">def </span><span class="s1">test_plot_single_column_bar</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">layout</span><span class="s3">):</span>
        <span class="s5"># GH 6951</span>
        <span class="s5"># Test with single column</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;x&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">(</span><span class="s6">10</span><span class="s3">)})</span>
        <span class="s1">axes </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">bar</span><span class="s3">, </span><span class="s1">subplots</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">layout</span><span class="s3">=</span><span class="s1">layout</span><span class="s3">)</span>
        <span class="s1">_check_axes_shape</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">, </span><span class="s1">axes_num</span><span class="s3">=</span><span class="s6">1</span><span class="s3">, </span><span class="s1">layout</span><span class="s3">=(</span><span class="s6">1</span><span class="s3">, </span><span class="s6">1</span><span class="s3">))</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s2">def </span><span class="s1">test_plot_passed_ax</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s5"># When ax is supplied and required number of axes is 1,</span>
        <span class="s5"># passed ax should be used:</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;x&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">(</span><span class="s6">10</span><span class="s3">)})</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">axes </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">bar</span><span class="s3">(</span><span class="s1">subplots</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">) == </span><span class="s6">1</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">axes</span>
        <span class="s2">assert </span><span class="s1">result </span><span class="s2">is </span><span class="s1">axes</span><span class="s3">[</span><span class="s6">0</span><span class="s3">]</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;cols, x, y&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s3">[</span><span class="s1">list</span><span class="s3">(</span><span class="s4">&quot;ABCDE&quot;</span><span class="s3">), </span><span class="s4">&quot;A&quot;</span><span class="s3">, </span><span class="s4">&quot;B&quot;</span><span class="s3">],</span>
            <span class="s3">[[</span><span class="s4">&quot;A&quot;</span><span class="s3">, </span><span class="s4">&quot;B&quot;</span><span class="s3">], </span><span class="s4">&quot;A&quot;</span><span class="s3">, </span><span class="s4">&quot;B&quot;</span><span class="s3">],</span>
            <span class="s3">[[</span><span class="s4">&quot;C&quot;</span><span class="s3">, </span><span class="s4">&quot;A&quot;</span><span class="s3">], </span><span class="s4">&quot;C&quot;</span><span class="s3">, </span><span class="s4">&quot;A&quot;</span><span class="s3">],</span>
            <span class="s3">[[</span><span class="s4">&quot;A&quot;</span><span class="s3">, </span><span class="s4">&quot;C&quot;</span><span class="s3">], </span><span class="s4">&quot;A&quot;</span><span class="s3">, </span><span class="s4">&quot;C&quot;</span><span class="s3">],</span>
            <span class="s3">[[</span><span class="s4">&quot;B&quot;</span><span class="s3">, </span><span class="s4">&quot;C&quot;</span><span class="s3">], </span><span class="s4">&quot;B&quot;</span><span class="s3">, </span><span class="s4">&quot;C&quot;</span><span class="s3">],</span>
            <span class="s3">[[</span><span class="s4">&quot;A&quot;</span><span class="s3">, </span><span class="s4">&quot;D&quot;</span><span class="s3">], </span><span class="s4">&quot;A&quot;</span><span class="s3">, </span><span class="s4">&quot;D&quot;</span><span class="s3">],</span>
            <span class="s3">[[</span><span class="s4">&quot;A&quot;</span><span class="s3">, </span><span class="s4">&quot;E&quot;</span><span class="s3">], </span><span class="s4">&quot;A&quot;</span><span class="s3">, </span><span class="s4">&quot;E&quot;</span><span class="s3">],</span>
        <span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_nullable_int_plot</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">cols</span><span class="s3">, </span><span class="s1">x</span><span class="s3">, </span><span class="s1">y</span><span class="s3">):</span>
        <span class="s5"># GH 32073</span>
        <span class="s1">dates </span><span class="s3">= [</span><span class="s4">&quot;2008&quot;</span><span class="s3">, </span><span class="s4">&quot;2009&quot;</span><span class="s3">, </span><span class="s2">None</span><span class="s3">, </span><span class="s4">&quot;2011&quot;</span><span class="s3">, </span><span class="s4">&quot;2012&quot;</span><span class="s3">]</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s3">{</span>
                <span class="s4">&quot;A&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">, </span><span class="s6">5</span><span class="s3">],</span>
                <span class="s4">&quot;B&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">, </span><span class="s6">5</span><span class="s3">],</span>
                <span class="s4">&quot;C&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">7</span><span class="s3">, </span><span class="s6">5</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">2</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">object</span><span class="s3">),</span>
                <span class="s4">&quot;D&quot;</span><span class="s3">: </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">to_datetime</span><span class="s3">(</span><span class="s1">dates</span><span class="s3">, </span><span class="s1">format</span><span class="s3">=</span><span class="s4">&quot;%Y&quot;</span><span class="s3">).</span><span class="s1">view</span><span class="s3">(</span><span class="s4">&quot;i8&quot;</span><span class="s3">),</span>
                <span class="s4">&quot;E&quot;</span><span class="s3">: </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">to_datetime</span><span class="s3">(</span><span class="s1">dates</span><span class="s3">, </span><span class="s1">format</span><span class="s3">=</span><span class="s4">&quot;%Y&quot;</span><span class="s3">, </span><span class="s1">utc</span><span class="s3">=</span><span class="s2">True</span><span class="s3">).</span><span class="s1">view</span><span class="s3">(</span><span class="s4">&quot;i8&quot;</span><span class="s3">),</span>
            <span class="s3">}</span>
        <span class="s3">)</span>

        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">[</span><span class="s1">cols</span><span class="s3">].</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">x</span><span class="s3">=</span><span class="s1">x</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s1">y</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;plot&quot;</span><span class="s3">, [</span><span class="s4">&quot;line&quot;</span><span class="s3">, </span><span class="s4">&quot;bar&quot;</span><span class="s3">, </span><span class="s4">&quot;hist&quot;</span><span class="s3">, </span><span class="s4">&quot;pie&quot;</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_integer_array_plot_series</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">plot</span><span class="s3">):</span>
        <span class="s5"># GH 25587</span>
        <span class="s1">arr </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s4">&quot;UInt32&quot;</span><span class="s3">)</span>

        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">arr</span><span class="s3">)</span>
        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">getattr</span><span class="s3">(</span><span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">plot</span><span class="s3">))</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;plot, kwargs&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s3">[</span><span class="s4">&quot;line&quot;</span><span class="s3">, {}],</span>
            <span class="s3">[</span><span class="s4">&quot;bar&quot;</span><span class="s3">, {}],</span>
            <span class="s3">[</span><span class="s4">&quot;hist&quot;</span><span class="s3">, {}],</span>
            <span class="s3">[</span><span class="s4">&quot;pie&quot;</span><span class="s3">, {</span><span class="s4">&quot;y&quot;</span><span class="s3">: </span><span class="s4">&quot;y&quot;</span><span class="s3">}],</span>
            <span class="s3">[</span><span class="s4">&quot;scatter&quot;</span><span class="s3">, {</span><span class="s4">&quot;x&quot;</span><span class="s3">: </span><span class="s4">&quot;x&quot;</span><span class="s3">, </span><span class="s4">&quot;y&quot;</span><span class="s3">: </span><span class="s4">&quot;y&quot;</span><span class="s3">}],</span>
            <span class="s3">[</span><span class="s4">&quot;hexbin&quot;</span><span class="s3">, {</span><span class="s4">&quot;x&quot;</span><span class="s3">: </span><span class="s4">&quot;x&quot;</span><span class="s3">, </span><span class="s4">&quot;y&quot;</span><span class="s3">: </span><span class="s4">&quot;y&quot;</span><span class="s3">}],</span>
        <span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_integer_array_plot_df</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">plot</span><span class="s3">, </span><span class="s1">kwargs</span><span class="s3">):</span>
        <span class="s5"># GH 25587</span>
        <span class="s1">arr </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s4">&quot;UInt32&quot;</span><span class="s3">)</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;x&quot;</span><span class="s3">: </span><span class="s1">arr</span><span class="s3">, </span><span class="s4">&quot;y&quot;</span><span class="s3">: </span><span class="s1">arr</span><span class="s3">})</span>
        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">getattr</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">plot</span><span class="s3">), **</span><span class="s1">kwargs</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_nonnumeric_exclude</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;A&quot;</span><span class="s3">: [</span><span class="s4">&quot;x&quot;</span><span class="s3">, </span><span class="s4">&quot;y&quot;</span><span class="s3">, </span><span class="s4">&quot;z&quot;</span><span class="s3">], </span><span class="s4">&quot;B&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">]})</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">()</span>
        <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_lines</span><span class="s3">()) == </span><span class="s6">1  </span><span class="s5"># B was plotted</span>

    <span class="s2">def </span><span class="s1">test_implicit_label</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">10</span><span class="s3">, </span><span class="s6">3</span><span class="s3">)), </span><span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s4">&quot;c&quot;</span><span class="s3">]</span>
        <span class="s3">)</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s4">&quot;b&quot;</span><span class="s3">)</span>
        <span class="s1">_check_text_labels</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">xaxis</span><span class="s3">.</span><span class="s1">get_label</span><span class="s3">(), </span><span class="s4">&quot;a&quot;</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_donot_overwrite_index_name</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s5"># GH 8494</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">2</span><span class="s3">, </span><span class="s6">2</span><span class="s3">)), </span><span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">]</span>
        <span class="s3">)</span>
        <span class="s1">df</span><span class="s3">.</span><span class="s1">index</span><span class="s3">.</span><span class="s1">name </span><span class="s3">= </span><span class="s4">&quot;NAME&quot;</span>
        <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">y</span><span class="s3">=</span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s1">label</span><span class="s3">=</span><span class="s4">&quot;LABEL&quot;</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">df</span><span class="s3">.</span><span class="s1">index</span><span class="s3">.</span><span class="s1">name </span><span class="s3">== </span><span class="s4">&quot;NAME&quot;</span>

    <span class="s2">def </span><span class="s1">test_plot_xy</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s5"># columns.inferred_type == 'string'</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">makeTimeDataFrame</span><span class="s3">(</span><span class="s6">5</span><span class="s3">)</span>
        <span class="s1">_check_data</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s6">0</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s6">1</span><span class="s3">), </span><span class="s1">df</span><span class="s3">.</span><span class="s1">set_index</span><span class="s3">(</span><span class="s4">&quot;A&quot;</span><span class="s3">)[</span><span class="s4">&quot;B&quot;</span><span class="s3">].</span><span class="s1">plot</span><span class="s3">())</span>
        <span class="s1">_check_data</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s6">0</span><span class="s3">), </span><span class="s1">df</span><span class="s3">.</span><span class="s1">set_index</span><span class="s3">(</span><span class="s4">&quot;A&quot;</span><span class="s3">).</span><span class="s1">plot</span><span class="s3">())</span>
        <span class="s1">_check_data</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">y</span><span class="s3">=</span><span class="s6">0</span><span class="s3">), </span><span class="s1">df</span><span class="s3">.</span><span class="s1">B</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">())</span>
        <span class="s1">_check_data</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s4">&quot;A&quot;</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s4">&quot;B&quot;</span><span class="s3">), </span><span class="s1">df</span><span class="s3">.</span><span class="s1">set_index</span><span class="s3">(</span><span class="s4">&quot;A&quot;</span><span class="s3">).</span><span class="s1">B</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">())</span>
        <span class="s1">_check_data</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s4">&quot;A&quot;</span><span class="s3">), </span><span class="s1">df</span><span class="s3">.</span><span class="s1">set_index</span><span class="s3">(</span><span class="s4">&quot;A&quot;</span><span class="s3">).</span><span class="s1">plot</span><span class="s3">())</span>
        <span class="s1">_check_data</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">y</span><span class="s3">=</span><span class="s4">&quot;B&quot;</span><span class="s3">), </span><span class="s1">df</span><span class="s3">.</span><span class="s1">B</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">())</span>

    <span class="s2">def </span><span class="s1">test_plot_xy_int_cols</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">makeTimeDataFrame</span><span class="s3">(</span><span class="s6">5</span><span class="s3">)</span>
        <span class="s5"># columns.inferred_type == 'integer'</span>
        <span class="s1">df</span><span class="s3">.</span><span class="s1">columns </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">1</span><span class="s3">, </span><span class="s1">len</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">columns</span><span class="s3">) + </span><span class="s6">1</span><span class="s3">)</span>
        <span class="s1">_check_data</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s6">1</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s6">2</span><span class="s3">), </span><span class="s1">df</span><span class="s3">.</span><span class="s1">set_index</span><span class="s3">(</span><span class="s6">1</span><span class="s3">)[</span><span class="s6">2</span><span class="s3">].</span><span class="s1">plot</span><span class="s3">())</span>
        <span class="s1">_check_data</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s6">1</span><span class="s3">), </span><span class="s1">df</span><span class="s3">.</span><span class="s1">set_index</span><span class="s3">(</span><span class="s6">1</span><span class="s3">).</span><span class="s1">plot</span><span class="s3">())</span>
        <span class="s1">_check_data</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">y</span><span class="s3">=</span><span class="s6">1</span><span class="s3">), </span><span class="s1">df</span><span class="s3">[</span><span class="s6">1</span><span class="s3">].</span><span class="s1">plot</span><span class="s3">())</span>

    <span class="s2">def </span><span class="s1">test_plot_xy_figsize_and_title</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">makeTimeDataFrame</span><span class="s3">(</span><span class="s6">5</span><span class="s3">)</span>
        <span class="s5"># figsize and title</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s6">1</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s6">2</span><span class="s3">, </span><span class="s1">title</span><span class="s3">=</span><span class="s4">&quot;Test&quot;</span><span class="s3">, </span><span class="s1">figsize</span><span class="s3">=(</span><span class="s6">16</span><span class="s3">, </span><span class="s6">8</span><span class="s3">))</span>
        <span class="s1">_check_text_labels</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">title</span><span class="s3">, </span><span class="s4">&quot;Test&quot;</span><span class="s3">)</span>
        <span class="s1">_check_axes_shape</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">axes_num</span><span class="s3">=</span><span class="s6">1</span><span class="s3">, </span><span class="s1">layout</span><span class="s3">=(</span><span class="s6">1</span><span class="s3">, </span><span class="s6">1</span><span class="s3">), </span><span class="s1">figsize</span><span class="s3">=(</span><span class="s6">16.0</span><span class="s3">, </span><span class="s6">8.0</span><span class="s3">))</span>

        <span class="s5"># columns.inferred_type == 'mixed'</span>
        <span class="s5"># TODO add MultiIndex test</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;input_log, expected_log&quot;</span><span class="s3">, [(</span><span class="s2">True</span><span class="s3">, </span><span class="s4">&quot;log&quot;</span><span class="s3">), (</span><span class="s4">&quot;sym&quot;</span><span class="s3">, </span><span class="s4">&quot;symlog&quot;</span><span class="s3">)]</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_logscales</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">input_log</span><span class="s3">, </span><span class="s1">expected_log</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;a&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">100</span><span class="s3">)}, </span><span class="s1">index</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">100</span><span class="s3">))</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">logy</span><span class="s3">=</span><span class="s1">input_log</span><span class="s3">)</span>
        <span class="s1">_check_ax_scales</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">yaxis</span><span class="s3">=</span><span class="s1">expected_log</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_yscale</span><span class="s3">() == </span><span class="s1">expected_log</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">logx</span><span class="s3">=</span><span class="s1">input_log</span><span class="s3">)</span>
        <span class="s1">_check_ax_scales</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xaxis</span><span class="s3">=</span><span class="s1">expected_log</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xscale</span><span class="s3">() == </span><span class="s1">expected_log</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">loglog</span><span class="s3">=</span><span class="s1">input_log</span><span class="s3">)</span>
        <span class="s1">_check_ax_scales</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xaxis</span><span class="s3">=</span><span class="s1">expected_log</span><span class="s3">, </span><span class="s1">yaxis</span><span class="s3">=</span><span class="s1">expected_log</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xscale</span><span class="s3">() == </span><span class="s1">expected_log</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_yscale</span><span class="s3">() == </span><span class="s1">expected_log</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;input_param&quot;</span><span class="s3">, [</span><span class="s4">&quot;logx&quot;</span><span class="s3">, </span><span class="s4">&quot;logy&quot;</span><span class="s3">, </span><span class="s4">&quot;loglog&quot;</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_invalid_logscale</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">input_param</span><span class="s3">):</span>
        <span class="s5"># GH: 24867</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;a&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">100</span><span class="s3">)}, </span><span class="s1">index</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">100</span><span class="s3">))</span>

        <span class="s1">msg </span><span class="s3">= </span><span class="s4">&quot;Boolean, None and 'sym' are valid options, 'sm' is given.&quot;</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">ValueError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(**{</span><span class="s1">input_param</span><span class="s3">: </span><span class="s4">&quot;sm&quot;</span><span class="s3">})</span>

    <span class="s2">def </span><span class="s1">test_xcompat</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">makeTimeDataFrame</span><span class="s3">()</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">x_compat</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s1">lines </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_lines</span><span class="s3">()</span>
        <span class="s2">assert not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">lines</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">get_xdata</span><span class="s3">(), </span><span class="s1">PeriodIndex</span><span class="s3">)</span>
        <span class="s1">_check_ticks_props</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xrot</span><span class="s3">=</span><span class="s6">30</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_xcompat_plot_params</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">makeTimeDataFrame</span><span class="s3">()</span>
        <span class="s1">plotting</span><span class="s3">.</span><span class="s1">plot_params</span><span class="s3">[</span><span class="s4">&quot;xaxis.compat&quot;</span><span class="s3">] = </span><span class="s2">True</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">()</span>
        <span class="s1">lines </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_lines</span><span class="s3">()</span>
        <span class="s2">assert not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">lines</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">get_xdata</span><span class="s3">(), </span><span class="s1">PeriodIndex</span><span class="s3">)</span>
        <span class="s1">_check_ticks_props</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xrot</span><span class="s3">=</span><span class="s6">30</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_xcompat_plot_params_x_compat</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">makeTimeDataFrame</span><span class="s3">()</span>
        <span class="s1">plotting</span><span class="s3">.</span><span class="s1">plot_params</span><span class="s3">[</span><span class="s4">&quot;x_compat&quot;</span><span class="s3">] = </span><span class="s2">False</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">()</span>
        <span class="s1">lines </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_lines</span><span class="s3">()</span>
        <span class="s2">assert not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">lines</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">get_xdata</span><span class="s3">(), </span><span class="s1">PeriodIndex</span><span class="s3">)</span>
        <span class="s1">msg </span><span class="s3">= </span><span class="s4">r&quot;PeriodDtype\[B\] is deprecated&quot;</span>
        <span class="s2">with </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_produces_warning</span><span class="s3">(</span><span class="s1">FutureWarning</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s2">assert </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">PeriodIndex</span><span class="s3">(</span><span class="s1">lines</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">get_xdata</span><span class="s3">()), </span><span class="s1">PeriodIndex</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_xcompat_plot_params_context_manager</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">makeTimeDataFrame</span><span class="s3">()</span>
        <span class="s5"># useful if you're plotting a bunch together</span>
        <span class="s2">with </span><span class="s1">plotting</span><span class="s3">.</span><span class="s1">plot_params</span><span class="s3">.</span><span class="s1">use</span><span class="s3">(</span><span class="s4">&quot;x_compat&quot;</span><span class="s3">, </span><span class="s2">True</span><span class="s3">):</span>
            <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">()</span>
            <span class="s1">lines </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_lines</span><span class="s3">()</span>
            <span class="s2">assert not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">lines</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">get_xdata</span><span class="s3">(), </span><span class="s1">PeriodIndex</span><span class="s3">)</span>
            <span class="s1">_check_ticks_props</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xrot</span><span class="s3">=</span><span class="s6">30</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_xcompat_plot_period</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">makeTimeDataFrame</span><span class="s3">()</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">()</span>
        <span class="s1">lines </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_lines</span><span class="s3">()</span>
        <span class="s2">assert not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">lines</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">get_xdata</span><span class="s3">(), </span><span class="s1">PeriodIndex</span><span class="s3">)</span>
        <span class="s1">msg </span><span class="s3">= </span><span class="s4">r&quot;PeriodDtype\[B\] is deprecated &quot;</span>
        <span class="s2">with </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_produces_warning</span><span class="s3">(</span><span class="s1">FutureWarning</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s2">assert </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">PeriodIndex</span><span class="s3">(</span><span class="s1">lines</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">get_xdata</span><span class="s3">()), </span><span class="s1">PeriodIndex</span><span class="s3">)</span>
        <span class="s1">_check_ticks_props</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xrot</span><span class="s3">=</span><span class="s6">0</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_period_compat</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s5"># GH 9012</span>
        <span class="s5"># period-array conversions</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">((</span><span class="s6">21</span><span class="s3">, </span><span class="s6">2</span><span class="s3">)),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">bdate_range</span><span class="s3">(</span><span class="s1">datetime</span><span class="s3">(</span><span class="s6">2000</span><span class="s3">, </span><span class="s6">1</span><span class="s3">, </span><span class="s6">1</span><span class="s3">), </span><span class="s1">datetime</span><span class="s3">(</span><span class="s6">2000</span><span class="s3">, </span><span class="s6">1</span><span class="s3">, </span><span class="s6">31</span><span class="s3">)),</span>
            <span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">],</span>
        <span class="s3">)</span>

        <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">()</span>
        <span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">axhline</span><span class="s3">(</span><span class="s1">y</span><span class="s3">=</span><span class="s6">0</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;index_dtype&quot;</span><span class="s3">, [</span><span class="s1">np</span><span class="s3">.</span><span class="s1">int64</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_unsorted_index</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">index_dtype</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s3">{</span><span class="s4">&quot;y&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">100</span><span class="s3">)},</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">pd</span><span class="s3">.</span><span class="s1">Index</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">99</span><span class="s3">, -</span><span class="s6">1</span><span class="s3">, -</span><span class="s6">1</span><span class="s3">), </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">index_dtype</span><span class="s3">),</span>
            <span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">int64</span><span class="s3">,</span>
        <span class="s3">)</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">()</span>
        <span class="s1">lines </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_lines</span><span class="s3">()[</span><span class="s6">0</span><span class="s3">]</span>
        <span class="s1">rs </span><span class="s3">= </span><span class="s1">lines</span><span class="s3">.</span><span class="s1">get_xydata</span><span class="s3">()</span>
        <span class="s1">rs </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">rs</span><span class="s3">[:, </span><span class="s6">1</span><span class="s3">], </span><span class="s1">rs</span><span class="s3">[:, </span><span class="s6">0</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">int64</span><span class="s3">, </span><span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;y&quot;</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">rs</span><span class="s3">, </span><span class="s1">df</span><span class="s3">.</span><span class="s1">y</span><span class="s3">, </span><span class="s1">check_index_type</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;df&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;y&quot;</span><span class="s3">: [</span><span class="s6">0.0</span><span class="s3">, </span><span class="s6">1.0</span><span class="s3">, </span><span class="s6">2.0</span><span class="s3">, </span><span class="s6">3.0</span><span class="s3">]}, </span><span class="s1">index</span><span class="s3">=[</span><span class="s6">1.0</span><span class="s3">, </span><span class="s6">0.0</span><span class="s3">, </span><span class="s6">3.0</span><span class="s3">, </span><span class="s6">2.0</span><span class="s3">]),</span>
            <span class="s1">DataFrame</span><span class="s3">(</span>
                <span class="s3">{</span><span class="s4">&quot;y&quot;</span><span class="s3">: [</span><span class="s6">0.0</span><span class="s3">, </span><span class="s6">1.0</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s6">3.0</span><span class="s3">, </span><span class="s6">4.0</span><span class="s3">, </span><span class="s6">5.0</span><span class="s3">, </span><span class="s6">6.0</span><span class="s3">]},</span>
                <span class="s1">index</span><span class="s3">=[</span><span class="s6">1.0</span><span class="s3">, </span><span class="s6">0.0</span><span class="s3">, </span><span class="s6">3.0</span><span class="s3">, </span><span class="s6">2.0</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s6">3.0</span><span class="s3">, </span><span class="s6">2.0</span><span class="s3">],</span>
            <span class="s3">),</span>
        <span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_unsorted_index_lims</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">df</span><span class="s3">):</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">()</span>
        <span class="s1">xmin</span><span class="s3">, </span><span class="s1">xmax </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xlim</span><span class="s3">()</span>
        <span class="s1">lines </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_lines</span><span class="s3">()</span>
        <span class="s2">assert </span><span class="s1">xmin </span><span class="s3">&lt;= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nanmin</span><span class="s3">(</span><span class="s1">lines</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">get_data</span><span class="s3">()[</span><span class="s6">0</span><span class="s3">])</span>
        <span class="s2">assert </span><span class="s1">xmax </span><span class="s3">&gt;= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nanmax</span><span class="s3">(</span><span class="s1">lines</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">get_data</span><span class="s3">()[</span><span class="s6">0</span><span class="s3">])</span>

    <span class="s2">def </span><span class="s1">test_unsorted_index_lims_x_y</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;y&quot;</span><span class="s3">: [</span><span class="s6">0.0</span><span class="s3">, </span><span class="s6">1.0</span><span class="s3">, </span><span class="s6">2.0</span><span class="s3">, </span><span class="s6">3.0</span><span class="s3">], </span><span class="s4">&quot;z&quot;</span><span class="s3">: [</span><span class="s6">91.0</span><span class="s3">, </span><span class="s6">90.0</span><span class="s3">, </span><span class="s6">93.0</span><span class="s3">, </span><span class="s6">92.0</span><span class="s3">]})</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s4">&quot;z&quot;</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s4">&quot;y&quot;</span><span class="s3">)</span>
        <span class="s1">xmin</span><span class="s3">, </span><span class="s1">xmax </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xlim</span><span class="s3">()</span>
        <span class="s1">lines </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_lines</span><span class="s3">()</span>
        <span class="s2">assert </span><span class="s1">xmin </span><span class="s3">&lt;= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nanmin</span><span class="s3">(</span><span class="s1">lines</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">get_data</span><span class="s3">()[</span><span class="s6">0</span><span class="s3">])</span>
        <span class="s2">assert </span><span class="s1">xmax </span><span class="s3">&gt;= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nanmax</span><span class="s3">(</span><span class="s1">lines</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">get_data</span><span class="s3">()[</span><span class="s6">0</span><span class="s3">])</span>

    <span class="s2">def </span><span class="s1">test_negative_log</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= -</span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">((</span><span class="s6">6</span><span class="s3">, </span><span class="s6">4</span><span class="s3">)),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s1">string</span><span class="s3">.</span><span class="s1">ascii_letters</span><span class="s3">[:</span><span class="s6">6</span><span class="s3">]),</span>
            <span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;x&quot;</span><span class="s3">, </span><span class="s4">&quot;y&quot;</span><span class="s3">, </span><span class="s4">&quot;z&quot;</span><span class="s3">, </span><span class="s4">&quot;four&quot;</span><span class="s3">],</span>
        <span class="s3">)</span>
        <span class="s1">msg </span><span class="s3">= </span><span class="s4">&quot;Log-y scales are not supported in area plot&quot;</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">ValueError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">area</span><span class="s3">(</span><span class="s1">logy</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">ValueError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">area</span><span class="s3">(</span><span class="s1">loglog</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">_compare_stacked_y_cood</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">normal_lines</span><span class="s3">, </span><span class="s1">stacked_lines</span><span class="s3">):</span>
        <span class="s1">base </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">zeros</span><span class="s3">(</span><span class="s1">len</span><span class="s3">(</span><span class="s1">normal_lines</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">get_data</span><span class="s3">()[</span><span class="s6">1</span><span class="s3">]))</span>
        <span class="s2">for </span><span class="s1">nl</span><span class="s3">, </span><span class="s1">sl </span><span class="s2">in </span><span class="s1">zip</span><span class="s3">(</span><span class="s1">normal_lines</span><span class="s3">, </span><span class="s1">stacked_lines</span><span class="s3">):</span>
            <span class="s1">base </span><span class="s3">+= </span><span class="s1">nl</span><span class="s3">.</span><span class="s1">get_data</span><span class="s3">()[</span><span class="s6">1</span><span class="s3">]  </span><span class="s5"># get y coordinates</span>
            <span class="s1">sy </span><span class="s3">= </span><span class="s1">sl</span><span class="s3">.</span><span class="s1">get_data</span><span class="s3">()[</span><span class="s6">1</span><span class="s3">]</span>
            <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span><span class="s1">base</span><span class="s3">, </span><span class="s1">sy</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;kind&quot;</span><span class="s3">, [</span><span class="s4">&quot;line&quot;</span><span class="s3">, </span><span class="s4">&quot;area&quot;</span><span class="s3">])</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;mult&quot;</span><span class="s3">, [</span><span class="s6">1</span><span class="s3">, -</span><span class="s6">1</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_line_area_stacked</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">, </span><span class="s1">mult</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">mult </span><span class="s3">* </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">((</span><span class="s6">6</span><span class="s3">, </span><span class="s6">4</span><span class="s3">)), </span><span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;w&quot;</span><span class="s3">, </span><span class="s4">&quot;x&quot;</span><span class="s3">, </span><span class="s4">&quot;y&quot;</span><span class="s3">, </span><span class="s4">&quot;z&quot;</span><span class="s3">]</span>
        <span class="s3">)</span>

        <span class="s1">ax1 </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">, </span><span class="s1">stacked</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>
        <span class="s1">ax2 </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">, </span><span class="s1">stacked</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_compare_stacked_y_cood</span><span class="s3">(</span><span class="s1">ax1</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">, </span><span class="s1">ax2</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;kind&quot;</span><span class="s3">, [</span><span class="s4">&quot;line&quot;</span><span class="s3">, </span><span class="s4">&quot;area&quot;</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_line_area_stacked_sep_df</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">):</span>
        <span class="s5"># each column has either positive or negative value</span>
        <span class="s1">sep_df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s3">{</span>
                <span class="s4">&quot;w&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">(</span><span class="s6">6</span><span class="s3">),</span>
                <span class="s4">&quot;x&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">(</span><span class="s6">6</span><span class="s3">),</span>
                <span class="s4">&quot;y&quot;</span><span class="s3">: -</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">(</span><span class="s6">6</span><span class="s3">),</span>
                <span class="s4">&quot;z&quot;</span><span class="s3">: -</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">(</span><span class="s6">6</span><span class="s3">),</span>
            <span class="s3">}</span>
        <span class="s3">)</span>
        <span class="s1">ax1 </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">sep_df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">, </span><span class="s1">stacked</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>
        <span class="s1">ax2 </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">sep_df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">, </span><span class="s1">stacked</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_compare_stacked_y_cood</span><span class="s3">(</span><span class="s1">ax1</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">[:</span><span class="s6">2</span><span class="s3">], </span><span class="s1">ax2</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">[:</span><span class="s6">2</span><span class="s3">])</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_compare_stacked_y_cood</span><span class="s3">(</span><span class="s1">ax1</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">[</span><span class="s6">2</span><span class="s3">:], </span><span class="s1">ax2</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">[</span><span class="s6">2</span><span class="s3">:])</span>

    <span class="s2">def </span><span class="s1">test_line_area_stacked_mixed</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">mixed_df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">6</span><span class="s3">, </span><span class="s6">4</span><span class="s3">)),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s1">string</span><span class="s3">.</span><span class="s1">ascii_letters</span><span class="s3">[:</span><span class="s6">6</span><span class="s3">]),</span>
            <span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;w&quot;</span><span class="s3">, </span><span class="s4">&quot;x&quot;</span><span class="s3">, </span><span class="s4">&quot;y&quot;</span><span class="s3">, </span><span class="s4">&quot;z&quot;</span><span class="s3">],</span>
        <span class="s3">)</span>
        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">mixed_df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">stacked</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>

        <span class="s1">msg </span><span class="s3">= (</span>
            <span class="s4">&quot;When stacked is True, each column must be either all positive or &quot;</span>
            <span class="s4">&quot;all negative. Column 'w' contains both positive and negative &quot;</span>
            <span class="s4">&quot;values&quot;</span>
        <span class="s3">)</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">ValueError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s1">mixed_df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">stacked</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;kind&quot;</span><span class="s3">, [</span><span class="s4">&quot;line&quot;</span><span class="s3">, </span><span class="s4">&quot;area&quot;</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_line_area_stacked_positive_idx</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">((</span><span class="s6">6</span><span class="s3">, </span><span class="s6">4</span><span class="s3">)), </span><span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;w&quot;</span><span class="s3">, </span><span class="s4">&quot;x&quot;</span><span class="s3">, </span><span class="s4">&quot;y&quot;</span><span class="s3">, </span><span class="s4">&quot;z&quot;</span><span class="s3">]</span>
        <span class="s3">)</span>
        <span class="s5"># Use an index with strictly positive values, preventing</span>
        <span class="s5">#  matplotlib from warning about ignoring xlim</span>
        <span class="s1">df2 </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">set_index</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">index </span><span class="s3">+ </span><span class="s6">1</span><span class="s3">)</span>
        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df2</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">, </span><span class="s1">logx</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">stacked</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;idx&quot;</span><span class="s3">, [</span><span class="s1">range</span><span class="s3">(</span><span class="s6">4</span><span class="s3">), </span><span class="s1">date_range</span><span class="s3">(</span><span class="s4">&quot;2023-01-1&quot;</span><span class="s3">, </span><span class="s1">freq</span><span class="s3">=</span><span class="s4">&quot;D&quot;</span><span class="s3">, </span><span class="s1">periods</span><span class="s3">=</span><span class="s6">4</span><span class="s3">)]</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_line_area_nan_df</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">idx</span><span class="s3">):</span>
        <span class="s1">values1 </span><span class="s3">= [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s6">3</span><span class="s3">]</span>
        <span class="s1">values2 </span><span class="s3">= [</span><span class="s6">3</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">1</span><span class="s3">]</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;a&quot;</span><span class="s3">: </span><span class="s1">values1</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">: </span><span class="s1">values2</span><span class="s3">}, </span><span class="s1">index</span><span class="s3">=</span><span class="s1">idx</span><span class="s3">)</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">)</span>
        <span class="s1">masked1 </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">get_ydata</span><span class="s3">()</span>
        <span class="s1">masked2 </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">[</span><span class="s6">1</span><span class="s3">].</span><span class="s1">get_ydata</span><span class="s3">()</span>
        <span class="s5"># remove nan for comparison purpose</span>

        <span class="s1">exp </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">delete</span><span class="s3">(</span><span class="s1">masked1</span><span class="s3">.</span><span class="s1">data</span><span class="s3">, </span><span class="s6">2</span><span class="s3">), </span><span class="s1">exp</span><span class="s3">)</span>

        <span class="s1">exp </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">3</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">1</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">delete</span><span class="s3">(</span><span class="s1">masked2</span><span class="s3">.</span><span class="s1">data</span><span class="s3">, </span><span class="s6">1</span><span class="s3">), </span><span class="s1">exp</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span><span class="s1">masked1</span><span class="s3">.</span><span class="s1">mask</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s2">False</span><span class="s3">, </span><span class="s2">False</span><span class="s3">, </span><span class="s2">True</span><span class="s3">, </span><span class="s2">False</span><span class="s3">]))</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span><span class="s1">masked2</span><span class="s3">.</span><span class="s1">mask</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s2">False</span><span class="s3">, </span><span class="s2">True</span><span class="s3">, </span><span class="s2">False</span><span class="s3">, </span><span class="s2">False</span><span class="s3">]))</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;idx&quot;</span><span class="s3">, [</span><span class="s1">range</span><span class="s3">(</span><span class="s6">4</span><span class="s3">), </span><span class="s1">date_range</span><span class="s3">(</span><span class="s4">&quot;2023-01-1&quot;</span><span class="s3">, </span><span class="s1">freq</span><span class="s3">=</span><span class="s4">&quot;D&quot;</span><span class="s3">, </span><span class="s1">periods</span><span class="s3">=</span><span class="s6">4</span><span class="s3">)]</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_line_area_nan_df_stacked</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">idx</span><span class="s3">):</span>
        <span class="s1">values1 </span><span class="s3">= [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s6">3</span><span class="s3">]</span>
        <span class="s1">values2 </span><span class="s3">= [</span><span class="s6">3</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">1</span><span class="s3">]</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;a&quot;</span><span class="s3">: </span><span class="s1">values1</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">: </span><span class="s1">values2</span><span class="s3">}, </span><span class="s1">index</span><span class="s3">=</span><span class="s1">idx</span><span class="s3">)</span>

        <span class="s1">expected1 </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">3</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">)</span>
        <span class="s1">expected2 </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">3</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">1</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">)</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">stacked</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">get_ydata</span><span class="s3">(), </span><span class="s1">expected1</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">[</span><span class="s6">1</span><span class="s3">].</span><span class="s1">get_ydata</span><span class="s3">(), </span><span class="s1">expected1 </span><span class="s3">+ </span><span class="s1">expected2</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;idx&quot;</span><span class="s3">, [</span><span class="s1">range</span><span class="s3">(</span><span class="s6">4</span><span class="s3">), </span><span class="s1">date_range</span><span class="s3">(</span><span class="s4">&quot;2023-01-1&quot;</span><span class="s3">, </span><span class="s1">freq</span><span class="s3">=</span><span class="s4">&quot;D&quot;</span><span class="s3">, </span><span class="s1">periods</span><span class="s3">=</span><span class="s6">4</span><span class="s3">)]</span>
    <span class="s3">)</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;kwargs&quot;</span><span class="s3">, [{}, {</span><span class="s4">&quot;stacked&quot;</span><span class="s3">: </span><span class="s2">False</span><span class="s3">}])</span>
    <span class="s2">def </span><span class="s1">test_line_area_nan_df_stacked_area</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">idx</span><span class="s3">, </span><span class="s1">kwargs</span><span class="s3">):</span>
        <span class="s1">values1 </span><span class="s3">= [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s6">3</span><span class="s3">]</span>
        <span class="s1">values2 </span><span class="s3">= [</span><span class="s6">3</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">1</span><span class="s3">]</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;a&quot;</span><span class="s3">: </span><span class="s1">values1</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">: </span><span class="s1">values2</span><span class="s3">}, </span><span class="s1">index</span><span class="s3">=</span><span class="s1">idx</span><span class="s3">)</span>

        <span class="s1">expected1 </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">3</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">)</span>
        <span class="s1">expected2 </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">3</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">1</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">)</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">area</span><span class="s3">, **</span><span class="s1">kwargs</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">get_ydata</span><span class="s3">(), </span><span class="s1">expected1</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">kwargs</span><span class="s3">:</span>
            <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">[</span><span class="s6">1</span><span class="s3">].</span><span class="s1">get_ydata</span><span class="s3">(), </span><span class="s1">expected2</span><span class="s3">)</span>
        <span class="s2">else</span><span class="s3">:</span>
            <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">[</span><span class="s6">1</span><span class="s3">].</span><span class="s1">get_ydata</span><span class="s3">(), </span><span class="s1">expected1 </span><span class="s3">+ </span><span class="s1">expected2</span><span class="s3">)</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">area</span><span class="s3">, </span><span class="s1">stacked</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">get_ydata</span><span class="s3">(), </span><span class="s1">expected1</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">[</span><span class="s6">1</span><span class="s3">].</span><span class="s1">get_ydata</span><span class="s3">(), </span><span class="s1">expected2</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;kwargs&quot;</span><span class="s3">, [{}, {</span><span class="s4">&quot;secondary_y&quot;</span><span class="s3">: </span><span class="s2">True</span><span class="s3">}])</span>
    <span class="s2">def </span><span class="s1">test_line_lim</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">kwargs</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">((</span><span class="s6">6</span><span class="s3">, </span><span class="s6">3</span><span class="s3">)), </span><span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;x&quot;</span><span class="s3">, </span><span class="s4">&quot;y&quot;</span><span class="s3">, </span><span class="s4">&quot;z&quot;</span><span class="s3">])</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(**</span><span class="s1">kwargs</span><span class="s3">)</span>
        <span class="s1">xmin</span><span class="s3">, </span><span class="s1">xmax </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xlim</span><span class="s3">()</span>
        <span class="s1">lines </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_lines</span><span class="s3">()</span>
        <span class="s2">assert </span><span class="s1">xmin </span><span class="s3">&lt;= </span><span class="s1">lines</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">get_data</span><span class="s3">()[</span><span class="s6">0</span><span class="s3">][</span><span class="s6">0</span><span class="s3">]</span>
        <span class="s2">assert </span><span class="s1">xmax </span><span class="s3">&gt;= </span><span class="s1">lines</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">get_data</span><span class="s3">()[</span><span class="s6">0</span><span class="s3">][-</span><span class="s6">1</span><span class="s3">]</span>

    <span class="s2">def </span><span class="s1">test_line_lim_subplots</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">((</span><span class="s6">6</span><span class="s3">, </span><span class="s6">3</span><span class="s3">)), </span><span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;x&quot;</span><span class="s3">, </span><span class="s4">&quot;y&quot;</span><span class="s3">, </span><span class="s4">&quot;z&quot;</span><span class="s3">])</span>
        <span class="s1">axes </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">secondary_y</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">subplots</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s1">_check_axes_shape</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">, </span><span class="s1">axes_num</span><span class="s3">=</span><span class="s6">3</span><span class="s3">, </span><span class="s1">layout</span><span class="s3">=(</span><span class="s6">3</span><span class="s3">, </span><span class="s6">1</span><span class="s3">))</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes</span><span class="s3">:</span>
            <span class="s2">assert </span><span class="s1">hasattr</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s4">&quot;left_ax&quot;</span><span class="s3">)</span>
            <span class="s2">assert not </span><span class="s1">hasattr</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s4">&quot;right_ax&quot;</span><span class="s3">)</span>
            <span class="s1">xmin</span><span class="s3">, </span><span class="s1">xmax </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xlim</span><span class="s3">()</span>
            <span class="s1">lines </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_lines</span><span class="s3">()</span>
            <span class="s2">assert </span><span class="s1">xmin </span><span class="s3">&lt;= </span><span class="s1">lines</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">get_data</span><span class="s3">()[</span><span class="s6">0</span><span class="s3">][</span><span class="s6">0</span><span class="s3">]</span>
            <span class="s2">assert </span><span class="s1">xmax </span><span class="s3">&gt;= </span><span class="s1">lines</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">get_data</span><span class="s3">()[</span><span class="s6">0</span><span class="s3">][-</span><span class="s6">1</span><span class="s3">]</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">xfail</span><span class="s3">(</span>
        <span class="s1">strict</span><span class="s3">=</span><span class="s2">False</span><span class="s3">,</span>
        <span class="s1">reason</span><span class="s3">=</span><span class="s4">&quot;2020-12-01 this has been failing periodically on the &quot;</span>
        <span class="s4">&quot;ymin==0 assertion for a week or so.&quot;</span><span class="s3">,</span>
    <span class="s3">)</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;stacked&quot;</span><span class="s3">, [</span><span class="s2">True</span><span class="s3">, </span><span class="s2">False</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_area_lim</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">stacked</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">((</span><span class="s6">6</span><span class="s3">, </span><span class="s6">4</span><span class="s3">)), </span><span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;x&quot;</span><span class="s3">, </span><span class="s4">&quot;y&quot;</span><span class="s3">, </span><span class="s4">&quot;z&quot;</span><span class="s3">, </span><span class="s4">&quot;four&quot;</span><span class="s3">]</span>
        <span class="s3">)</span>

        <span class="s1">neg_df </span><span class="s3">= -</span><span class="s1">df</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">area</span><span class="s3">, </span><span class="s1">stacked</span><span class="s3">=</span><span class="s1">stacked</span><span class="s3">)</span>
        <span class="s1">xmin</span><span class="s3">, </span><span class="s1">xmax </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xlim</span><span class="s3">()</span>
        <span class="s1">ymin</span><span class="s3">, </span><span class="s1">ymax </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_ylim</span><span class="s3">()</span>
        <span class="s1">lines </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_lines</span><span class="s3">()</span>
        <span class="s2">assert </span><span class="s1">xmin </span><span class="s3">&lt;= </span><span class="s1">lines</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">get_data</span><span class="s3">()[</span><span class="s6">0</span><span class="s3">][</span><span class="s6">0</span><span class="s3">]</span>
        <span class="s2">assert </span><span class="s1">xmax </span><span class="s3">&gt;= </span><span class="s1">lines</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">get_data</span><span class="s3">()[</span><span class="s6">0</span><span class="s3">][-</span><span class="s6">1</span><span class="s3">]</span>
        <span class="s2">assert </span><span class="s1">ymin </span><span class="s3">== </span><span class="s6">0</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">neg_df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">area</span><span class="s3">, </span><span class="s1">stacked</span><span class="s3">=</span><span class="s1">stacked</span><span class="s3">)</span>
        <span class="s1">ymin</span><span class="s3">, </span><span class="s1">ymax </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_ylim</span><span class="s3">()</span>
        <span class="s2">assert </span><span class="s1">ymax </span><span class="s3">== </span><span class="s6">0</span>

    <span class="s2">def </span><span class="s1">test_area_sharey_dont_overwrite</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s5"># GH37942</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">((</span><span class="s6">4</span><span class="s3">, </span><span class="s6">2</span><span class="s3">)), </span><span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;x&quot;</span><span class="s3">, </span><span class="s4">&quot;y&quot;</span><span class="s3">])</span>
        <span class="s1">fig</span><span class="s3">, (</span><span class="s1">ax1</span><span class="s3">, </span><span class="s1">ax2</span><span class="s3">) = </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">(</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s1">sharey</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>

        <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax1</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">=</span><span class="s4">&quot;area&quot;</span><span class="s3">)</span>
        <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax2</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">=</span><span class="s4">&quot;area&quot;</span><span class="s3">)</span>

        <span class="s2">assert </span><span class="s1">get_y_axis</span><span class="s3">(</span><span class="s1">ax1</span><span class="s3">).</span><span class="s1">joined</span><span class="s3">(</span><span class="s1">ax1</span><span class="s3">, </span><span class="s1">ax2</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">get_y_axis</span><span class="s3">(</span><span class="s1">ax2</span><span class="s3">).</span><span class="s1">joined</span><span class="s3">(</span><span class="s1">ax1</span><span class="s3">, </span><span class="s1">ax2</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;stacked&quot;</span><span class="s3">, [</span><span class="s2">True</span><span class="s3">, </span><span class="s2">False</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_bar_linewidth</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">stacked</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">5</span><span class="s3">, </span><span class="s6">5</span><span class="s3">)))</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">bar</span><span class="s3">(</span><span class="s1">stacked</span><span class="s3">=</span><span class="s1">stacked</span><span class="s3">, </span><span class="s1">linewidth</span><span class="s3">=</span><span class="s6">2</span><span class="s3">)</span>
        <span class="s2">for </span><span class="s1">r </span><span class="s2">in </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">:</span>
            <span class="s2">assert </span><span class="s1">r</span><span class="s3">.</span><span class="s1">get_linewidth</span><span class="s3">() == </span><span class="s6">2</span>

    <span class="s2">def </span><span class="s1">test_bar_linewidth_subplots</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">5</span><span class="s3">, </span><span class="s6">5</span><span class="s3">)))</span>
        <span class="s5"># subplots</span>
        <span class="s1">axes </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">bar</span><span class="s3">(</span><span class="s1">linewidth</span><span class="s3">=</span><span class="s6">2</span><span class="s3">, </span><span class="s1">subplots</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s1">_check_axes_shape</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">, </span><span class="s1">axes_num</span><span class="s3">=</span><span class="s6">5</span><span class="s3">, </span><span class="s1">layout</span><span class="s3">=(</span><span class="s6">5</span><span class="s3">, </span><span class="s6">1</span><span class="s3">))</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes</span><span class="s3">:</span>
            <span class="s2">for </span><span class="s1">r </span><span class="s2">in </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">:</span>
                <span class="s2">assert </span><span class="s1">r</span><span class="s3">.</span><span class="s1">get_linewidth</span><span class="s3">() == </span><span class="s6">2</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;meth, dim&quot;</span><span class="s3">, [(</span><span class="s4">&quot;bar&quot;</span><span class="s3">, </span><span class="s4">&quot;get_width&quot;</span><span class="s3">), (</span><span class="s4">&quot;barh&quot;</span><span class="s3">, </span><span class="s4">&quot;get_height&quot;</span><span class="s3">)]</span>
    <span class="s3">)</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;stacked&quot;</span><span class="s3">, [</span><span class="s2">True</span><span class="s3">, </span><span class="s2">False</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_bar_barwidth</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">meth</span><span class="s3">, </span><span class="s1">dim</span><span class="s3">, </span><span class="s1">stacked</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">5</span><span class="s3">, </span><span class="s6">5</span><span class="s3">)))</span>

        <span class="s1">width </span><span class="s3">= </span><span class="s6">0.9</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">getattr</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">meth</span><span class="s3">)(</span><span class="s1">stacked</span><span class="s3">=</span><span class="s1">stacked</span><span class="s3">, </span><span class="s1">width</span><span class="s3">=</span><span class="s1">width</span><span class="s3">)</span>
        <span class="s2">for </span><span class="s1">r </span><span class="s2">in </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">:</span>
            <span class="s2">if not </span><span class="s1">stacked</span><span class="s3">:</span>
                <span class="s2">assert </span><span class="s1">getattr</span><span class="s3">(</span><span class="s1">r</span><span class="s3">, </span><span class="s1">dim</span><span class="s3">)() == </span><span class="s1">width </span><span class="s3">/ </span><span class="s1">len</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">columns</span><span class="s3">)</span>
            <span class="s2">else</span><span class="s3">:</span>
                <span class="s2">assert </span><span class="s1">getattr</span><span class="s3">(</span><span class="s1">r</span><span class="s3">, </span><span class="s1">dim</span><span class="s3">)() == </span><span class="s1">width</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;meth, dim&quot;</span><span class="s3">, [(</span><span class="s4">&quot;bar&quot;</span><span class="s3">, </span><span class="s4">&quot;get_width&quot;</span><span class="s3">), (</span><span class="s4">&quot;barh&quot;</span><span class="s3">, </span><span class="s4">&quot;get_height&quot;</span><span class="s3">)]</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_barh_barwidth_subplots</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">meth</span><span class="s3">, </span><span class="s1">dim</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">5</span><span class="s3">, </span><span class="s6">5</span><span class="s3">)))</span>

        <span class="s1">width </span><span class="s3">= </span><span class="s6">0.9</span>

        <span class="s1">axes </span><span class="s3">= </span><span class="s1">getattr</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">meth</span><span class="s3">)(</span><span class="s1">width</span><span class="s3">=</span><span class="s1">width</span><span class="s3">, </span><span class="s1">subplots</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes</span><span class="s3">:</span>
            <span class="s2">for </span><span class="s1">r </span><span class="s2">in </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">:</span>
                <span class="s2">assert </span><span class="s1">getattr</span><span class="s3">(</span><span class="s1">r</span><span class="s3">, </span><span class="s1">dim</span><span class="s3">)() == </span><span class="s1">width</span>

    <span class="s2">def </span><span class="s1">test_bar_bottom_left_bottom</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">((</span><span class="s6">5</span><span class="s3">, </span><span class="s6">5</span><span class="s3">)))</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">bar</span><span class="s3">(</span><span class="s1">stacked</span><span class="s3">=</span><span class="s2">False</span><span class="s3">, </span><span class="s1">bottom</span><span class="s3">=</span><span class="s6">1</span><span class="s3">)</span>
        <span class="s1">result </span><span class="s3">= [</span><span class="s1">p</span><span class="s3">.</span><span class="s1">get_y</span><span class="s3">() </span><span class="s2">for </span><span class="s1">p </span><span class="s2">in </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">]</span>
        <span class="s2">assert </span><span class="s1">result </span><span class="s3">== [</span><span class="s6">1</span><span class="s3">] * </span><span class="s6">25</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">bar</span><span class="s3">(</span><span class="s1">stacked</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">bottom</span><span class="s3">=[-</span><span class="s6">1</span><span class="s3">, -</span><span class="s6">2</span><span class="s3">, -</span><span class="s6">3</span><span class="s3">, -</span><span class="s6">4</span><span class="s3">, -</span><span class="s6">5</span><span class="s3">])</span>
        <span class="s1">result </span><span class="s3">= [</span><span class="s1">p</span><span class="s3">.</span><span class="s1">get_y</span><span class="s3">() </span><span class="s2">for </span><span class="s1">p </span><span class="s2">in </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">[:</span><span class="s6">5</span><span class="s3">]]</span>
        <span class="s2">assert </span><span class="s1">result </span><span class="s3">== [-</span><span class="s6">1</span><span class="s3">, -</span><span class="s6">2</span><span class="s3">, -</span><span class="s6">3</span><span class="s3">, -</span><span class="s6">4</span><span class="s3">, -</span><span class="s6">5</span><span class="s3">]</span>

    <span class="s2">def </span><span class="s1">test_bar_bottom_left_left</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">((</span><span class="s6">5</span><span class="s3">, </span><span class="s6">5</span><span class="s3">)))</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">barh</span><span class="s3">(</span><span class="s1">stacked</span><span class="s3">=</span><span class="s2">False</span><span class="s3">, </span><span class="s1">left</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">1</span><span class="s3">, </span><span class="s6">1</span><span class="s3">, </span><span class="s6">1</span><span class="s3">, </span><span class="s6">1</span><span class="s3">, </span><span class="s6">1</span><span class="s3">]))</span>
        <span class="s1">result </span><span class="s3">= [</span><span class="s1">p</span><span class="s3">.</span><span class="s1">get_x</span><span class="s3">() </span><span class="s2">for </span><span class="s1">p </span><span class="s2">in </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">]</span>
        <span class="s2">assert </span><span class="s1">result </span><span class="s3">== [</span><span class="s6">1</span><span class="s3">] * </span><span class="s6">25</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">barh</span><span class="s3">(</span><span class="s1">stacked</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">left</span><span class="s3">=[</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">, </span><span class="s6">5</span><span class="s3">])</span>
        <span class="s1">result </span><span class="s3">= [</span><span class="s1">p</span><span class="s3">.</span><span class="s1">get_x</span><span class="s3">() </span><span class="s2">for </span><span class="s1">p </span><span class="s2">in </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">[:</span><span class="s6">5</span><span class="s3">]]</span>
        <span class="s2">assert </span><span class="s1">result </span><span class="s3">== [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">, </span><span class="s6">5</span><span class="s3">]</span>

    <span class="s2">def </span><span class="s1">test_bar_bottom_left_subplots</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">((</span><span class="s6">5</span><span class="s3">, </span><span class="s6">5</span><span class="s3">)))</span>
        <span class="s1">axes </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">bar</span><span class="s3">(</span><span class="s1">subplots</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">bottom</span><span class="s3">=-</span><span class="s6">1</span><span class="s3">)</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes</span><span class="s3">:</span>
            <span class="s1">result </span><span class="s3">= [</span><span class="s1">p</span><span class="s3">.</span><span class="s1">get_y</span><span class="s3">() </span><span class="s2">for </span><span class="s1">p </span><span class="s2">in </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">]</span>
            <span class="s2">assert </span><span class="s1">result </span><span class="s3">== [-</span><span class="s6">1</span><span class="s3">] * </span><span class="s6">5</span>

        <span class="s1">axes </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">barh</span><span class="s3">(</span><span class="s1">subplots</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">left</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">1</span><span class="s3">, </span><span class="s6">1</span><span class="s3">, </span><span class="s6">1</span><span class="s3">, </span><span class="s6">1</span><span class="s3">, </span><span class="s6">1</span><span class="s3">]))</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes</span><span class="s3">:</span>
            <span class="s1">result </span><span class="s3">= [</span><span class="s1">p</span><span class="s3">.</span><span class="s1">get_x</span><span class="s3">() </span><span class="s2">for </span><span class="s1">p </span><span class="s2">in </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">]</span>
            <span class="s2">assert </span><span class="s1">result </span><span class="s3">== [</span><span class="s6">1</span><span class="s3">] * </span><span class="s6">5</span>

    <span class="s2">def </span><span class="s1">test_bar_nan</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;A&quot;</span><span class="s3">: [</span><span class="s6">10</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s6">20</span><span class="s3">], </span><span class="s4">&quot;B&quot;</span><span class="s3">: [</span><span class="s6">5</span><span class="s3">, </span><span class="s6">10</span><span class="s3">, </span><span class="s6">20</span><span class="s3">], </span><span class="s4">&quot;C&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">]})</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">bar</span><span class="s3">()</span>
        <span class="s1">expected </span><span class="s3">= [</span><span class="s6">10</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">20</span><span class="s3">, </span><span class="s6">5</span><span class="s3">, </span><span class="s6">10</span><span class="s3">, </span><span class="s6">20</span><span class="s3">, </span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">]</span>
        <span class="s1">result </span><span class="s3">= [</span><span class="s1">p</span><span class="s3">.</span><span class="s1">get_height</span><span class="s3">() </span><span class="s2">for </span><span class="s1">p </span><span class="s2">in </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">]</span>
        <span class="s2">assert </span><span class="s1">result </span><span class="s3">== </span><span class="s1">expected</span>

    <span class="s2">def </span><span class="s1">test_bar_nan_stacked</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;A&quot;</span><span class="s3">: [</span><span class="s6">10</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s6">20</span><span class="s3">], </span><span class="s4">&quot;B&quot;</span><span class="s3">: [</span><span class="s6">5</span><span class="s3">, </span><span class="s6">10</span><span class="s3">, </span><span class="s6">20</span><span class="s3">], </span><span class="s4">&quot;C&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">]})</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">bar</span><span class="s3">(</span><span class="s1">stacked</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= [</span><span class="s6">10</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">20</span><span class="s3">, </span><span class="s6">5</span><span class="s3">, </span><span class="s6">10</span><span class="s3">, </span><span class="s6">20</span><span class="s3">, </span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">]</span>
        <span class="s1">result </span><span class="s3">= [</span><span class="s1">p</span><span class="s3">.</span><span class="s1">get_height</span><span class="s3">() </span><span class="s2">for </span><span class="s1">p </span><span class="s2">in </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">]</span>
        <span class="s2">assert </span><span class="s1">result </span><span class="s3">== </span><span class="s1">expected</span>

        <span class="s1">result </span><span class="s3">= [</span><span class="s1">p</span><span class="s3">.</span><span class="s1">get_y</span><span class="s3">() </span><span class="s2">for </span><span class="s1">p </span><span class="s2">in </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">]</span>
        <span class="s1">expected </span><span class="s3">= [</span><span class="s6">0.0</span><span class="s3">, </span><span class="s6">0.0</span><span class="s3">, </span><span class="s6">0.0</span><span class="s3">, </span><span class="s6">10.0</span><span class="s3">, </span><span class="s6">0.0</span><span class="s3">, </span><span class="s6">20.0</span><span class="s3">, </span><span class="s6">15.0</span><span class="s3">, </span><span class="s6">10.0</span><span class="s3">, </span><span class="s6">40.0</span><span class="s3">]</span>
        <span class="s2">assert </span><span class="s1">result </span><span class="s3">== </span><span class="s1">expected</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;idx&quot;</span><span class="s3">, [</span><span class="s1">pd</span><span class="s3">.</span><span class="s1">Index</span><span class="s3">, </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">CategoricalIndex</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_bar_categorical</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">idx</span><span class="s3">):</span>
        <span class="s5"># GH 13019</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">6</span><span class="s3">, </span><span class="s6">5</span><span class="s3">)),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">idx</span><span class="s3">(</span><span class="s1">list</span><span class="s3">(</span><span class="s4">&quot;ABCDEF&quot;</span><span class="s3">)),</span>
            <span class="s1">columns</span><span class="s3">=</span><span class="s1">idx</span><span class="s3">(</span><span class="s1">list</span><span class="s3">(</span><span class="s4">&quot;abcde&quot;</span><span class="s3">)),</span>
        <span class="s3">)</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">bar</span><span class="s3">()</span>
        <span class="s1">ticks </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">xaxis</span><span class="s3">.</span><span class="s1">get_ticklocs</span><span class="s3">()</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span><span class="s1">ticks</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">0</span><span class="s3">, </span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">, </span><span class="s6">5</span><span class="s3">]))</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xlim</span><span class="s3">() == (-</span><span class="s6">0.5</span><span class="s3">, </span><span class="s6">5.5</span><span class="s3">)</span>
        <span class="s5"># check left-edge of bars</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">get_x</span><span class="s3">() == -</span><span class="s6">0.25</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">[-</span><span class="s6">1</span><span class="s3">].</span><span class="s1">get_x</span><span class="s3">() == </span><span class="s6">5.15</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">bar</span><span class="s3">(</span><span class="s1">stacked</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span><span class="s1">ticks</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">0</span><span class="s3">, </span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">, </span><span class="s6">5</span><span class="s3">]))</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xlim</span><span class="s3">() == (-</span><span class="s6">0.5</span><span class="s3">, </span><span class="s6">5.5</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">get_x</span><span class="s3">() == -</span><span class="s6">0.25</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">[-</span><span class="s6">1</span><span class="s3">].</span><span class="s1">get_x</span><span class="s3">() == </span><span class="s6">4.75</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;x, y&quot;</span><span class="s3">, [(</span><span class="s4">&quot;x&quot;</span><span class="s3">, </span><span class="s4">&quot;y&quot;</span><span class="s3">), (</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">)])</span>
    <span class="s2">def </span><span class="s1">test_plot_scatter</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">x</span><span class="s3">, </span><span class="s1">y</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">6</span><span class="s3">, </span><span class="s6">4</span><span class="s3">)),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s1">string</span><span class="s3">.</span><span class="s1">ascii_letters</span><span class="s3">[:</span><span class="s6">6</span><span class="s3">]),</span>
            <span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;x&quot;</span><span class="s3">, </span><span class="s4">&quot;y&quot;</span><span class="s3">, </span><span class="s4">&quot;z&quot;</span><span class="s3">, </span><span class="s4">&quot;four&quot;</span><span class="s3">],</span>
        <span class="s3">)</span>

        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">scatter</span><span class="s3">, </span><span class="s1">x</span><span class="s3">=</span><span class="s1">x</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s1">y</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_plot_scatter_error</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">6</span><span class="s3">, </span><span class="s6">4</span><span class="s3">)),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s1">string</span><span class="s3">.</span><span class="s1">ascii_letters</span><span class="s3">[:</span><span class="s6">6</span><span class="s3">]),</span>
            <span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;x&quot;</span><span class="s3">, </span><span class="s4">&quot;y&quot;</span><span class="s3">, </span><span class="s4">&quot;z&quot;</span><span class="s3">, </span><span class="s4">&quot;four&quot;</span><span class="s3">],</span>
        <span class="s3">)</span>
        <span class="s1">msg </span><span class="s3">= </span><span class="s1">re</span><span class="s3">.</span><span class="s1">escape</span><span class="s3">(</span><span class="s4">&quot;scatter() missing 1 required positional argument: 'y'&quot;</span><span class="s3">)</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">TypeError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">scatter</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s4">&quot;x&quot;</span><span class="s3">)</span>
        <span class="s1">msg </span><span class="s3">= </span><span class="s1">re</span><span class="s3">.</span><span class="s1">escape</span><span class="s3">(</span><span class="s4">&quot;scatter() missing 1 required positional argument: 'x'&quot;</span><span class="s3">)</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">TypeError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">scatter</span><span class="s3">(</span><span class="s1">y</span><span class="s3">=</span><span class="s4">&quot;y&quot;</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_plot_scatter_shape</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">6</span><span class="s3">, </span><span class="s6">4</span><span class="s3">)),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s1">string</span><span class="s3">.</span><span class="s1">ascii_letters</span><span class="s3">[:</span><span class="s6">6</span><span class="s3">]),</span>
            <span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;x&quot;</span><span class="s3">, </span><span class="s4">&quot;y&quot;</span><span class="s3">, </span><span class="s4">&quot;z&quot;</span><span class="s3">, </span><span class="s4">&quot;four&quot;</span><span class="s3">],</span>
        <span class="s3">)</span>
        <span class="s5"># GH 6951</span>
        <span class="s1">axes </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s4">&quot;x&quot;</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s4">&quot;y&quot;</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">=</span><span class="s4">&quot;scatter&quot;</span><span class="s3">, </span><span class="s1">subplots</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s1">_check_axes_shape</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">, </span><span class="s1">axes_num</span><span class="s3">=</span><span class="s6">1</span><span class="s3">, </span><span class="s1">layout</span><span class="s3">=(</span><span class="s6">1</span><span class="s3">, </span><span class="s6">1</span><span class="s3">))</span>

    <span class="s2">def </span><span class="s1">test_raise_error_on_datetime_time_data</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s5"># GH 8113, datetime.time type is not supported by matplotlib in scatter</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">(</span><span class="s6">10</span><span class="s3">), </span><span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;a&quot;</span><span class="s3">])</span>
        <span class="s1">df</span><span class="s3">[</span><span class="s4">&quot;dtime&quot;</span><span class="s3">] = </span><span class="s1">date_range</span><span class="s3">(</span><span class="s1">start</span><span class="s3">=</span><span class="s4">&quot;2014-01-01&quot;</span><span class="s3">, </span><span class="s1">freq</span><span class="s3">=</span><span class="s4">&quot;h&quot;</span><span class="s3">, </span><span class="s1">periods</span><span class="s3">=</span><span class="s6">10</span><span class="s3">).</span><span class="s1">time</span>
        <span class="s1">msg </span><span class="s3">= </span><span class="s4">&quot;must be a string or a (real )?number, not 'datetime.time'&quot;</span>

        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">TypeError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">kind</span><span class="s3">=</span><span class="s4">&quot;scatter&quot;</span><span class="s3">, </span><span class="s1">x</span><span class="s3">=</span><span class="s4">&quot;dtime&quot;</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s4">&quot;a&quot;</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;x, y&quot;</span><span class="s3">, [(</span><span class="s4">&quot;dates&quot;</span><span class="s3">, </span><span class="s4">&quot;vals&quot;</span><span class="s3">), (</span><span class="s6">0</span><span class="s3">, </span><span class="s6">1</span><span class="s3">)])</span>
    <span class="s2">def </span><span class="s1">test_scatterplot_datetime_data</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">x</span><span class="s3">, </span><span class="s1">y</span><span class="s3">):</span>
        <span class="s5"># GH 30391</span>
        <span class="s1">dates </span><span class="s3">= </span><span class="s1">date_range</span><span class="s3">(</span><span class="s1">start</span><span class="s3">=</span><span class="s1">date</span><span class="s3">(</span><span class="s6">2019</span><span class="s3">, </span><span class="s6">1</span><span class="s3">, </span><span class="s6">1</span><span class="s3">), </span><span class="s1">periods</span><span class="s3">=</span><span class="s6">12</span><span class="s3">, </span><span class="s1">freq</span><span class="s3">=</span><span class="s4">&quot;W&quot;</span><span class="s3">)</span>
        <span class="s1">vals </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">normal</span><span class="s3">(</span><span class="s6">0</span><span class="s3">, </span><span class="s6">1</span><span class="s3">, </span><span class="s1">len</span><span class="s3">(</span><span class="s1">dates</span><span class="s3">))</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;dates&quot;</span><span class="s3">: </span><span class="s1">dates</span><span class="s3">, </span><span class="s4">&quot;vals&quot;</span><span class="s3">: </span><span class="s1">vals</span><span class="s3">})</span>

        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">scatter</span><span class="s3">, </span><span class="s1">x</span><span class="s3">=</span><span class="s1">x</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s1">y</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;x, y&quot;</span><span class="s3">, [(</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">), (</span><span class="s6">0</span><span class="s3">, </span><span class="s6">1</span><span class="s3">)])</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;b_col&quot;</span><span class="s3">, [[</span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">], [</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s4">&quot;c&quot;</span><span class="s3">]])</span>
    <span class="s2">def </span><span class="s1">test_scatterplot_object_data</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">b_col</span><span class="s3">, </span><span class="s1">x</span><span class="s3">, </span><span class="s1">y</span><span class="s3">):</span>
        <span class="s5"># GH 18755</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;a&quot;</span><span class="s3">: [</span><span class="s4">&quot;A&quot;</span><span class="s3">, </span><span class="s4">&quot;B&quot;</span><span class="s3">, </span><span class="s4">&quot;C&quot;</span><span class="s3">], </span><span class="s4">&quot;b&quot;</span><span class="s3">: </span><span class="s1">b_col</span><span class="s3">})</span>

        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">scatter</span><span class="s3">, </span><span class="s1">x</span><span class="s3">=</span><span class="s1">x</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s1">y</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;ordered&quot;</span><span class="s3">, [</span><span class="s2">True</span><span class="s3">, </span><span class="s2">False</span><span class="s3">])</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;categories&quot;</span><span class="s3">,</span>
        <span class="s3">([</span><span class="s4">&quot;setosa&quot;</span><span class="s3">, </span><span class="s4">&quot;versicolor&quot;</span><span class="s3">, </span><span class="s4">&quot;virginica&quot;</span><span class="s3">], [</span><span class="s4">&quot;versicolor&quot;</span><span class="s3">, </span><span class="s4">&quot;virginica&quot;</span><span class="s3">, </span><span class="s4">&quot;setosa&quot;</span><span class="s3">]),</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_scatterplot_color_by_categorical</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">ordered</span><span class="s3">, </span><span class="s1">categories</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s3">[[</span><span class="s6">5.1</span><span class="s3">, </span><span class="s6">3.5</span><span class="s3">], [</span><span class="s6">4.9</span><span class="s3">, </span><span class="s6">3.0</span><span class="s3">], [</span><span class="s6">7.0</span><span class="s3">, </span><span class="s6">3.2</span><span class="s3">], [</span><span class="s6">6.4</span><span class="s3">, </span><span class="s6">3.2</span><span class="s3">], [</span><span class="s6">5.9</span><span class="s3">, </span><span class="s6">3.0</span><span class="s3">]],</span>
            <span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;length&quot;</span><span class="s3">, </span><span class="s4">&quot;width&quot;</span><span class="s3">],</span>
        <span class="s3">)</span>
        <span class="s1">df</span><span class="s3">[</span><span class="s4">&quot;species&quot;</span><span class="s3">] = </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">Categorical</span><span class="s3">(</span>
            <span class="s3">[</span><span class="s4">&quot;setosa&quot;</span><span class="s3">, </span><span class="s4">&quot;setosa&quot;</span><span class="s3">, </span><span class="s4">&quot;virginica&quot;</span><span class="s3">, </span><span class="s4">&quot;virginica&quot;</span><span class="s3">, </span><span class="s4">&quot;versicolor&quot;</span><span class="s3">],</span>
            <span class="s1">ordered</span><span class="s3">=</span><span class="s1">ordered</span><span class="s3">,</span>
            <span class="s1">categories</span><span class="s3">=</span><span class="s1">categories</span><span class="s3">,</span>
        <span class="s3">)</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">scatter</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s6">0</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s6">1</span><span class="s3">, </span><span class="s1">c</span><span class="s3">=</span><span class="s4">&quot;species&quot;</span><span class="s3">)</span>
        <span class="s3">(</span><span class="s1">colorbar_collection</span><span class="s3">,) = </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">collections</span>
        <span class="s1">colorbar </span><span class="s3">= </span><span class="s1">colorbar_collection</span><span class="s3">.</span><span class="s1">colorbar</span>

        <span class="s1">expected_ticks </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">0.5</span><span class="s3">, </span><span class="s6">1.5</span><span class="s3">, </span><span class="s6">2.5</span><span class="s3">])</span>
        <span class="s1">result_ticks </span><span class="s3">= </span><span class="s1">colorbar</span><span class="s3">.</span><span class="s1">get_ticks</span><span class="s3">()</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span><span class="s1">result_ticks</span><span class="s3">, </span><span class="s1">expected_ticks</span><span class="s3">)</span>

        <span class="s1">expected_boundaries </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">0.0</span><span class="s3">, </span><span class="s6">1.0</span><span class="s3">, </span><span class="s6">2.0</span><span class="s3">, </span><span class="s6">3.0</span><span class="s3">])</span>
        <span class="s1">result_boundaries </span><span class="s3">= </span><span class="s1">colorbar</span><span class="s3">.</span><span class="s1">_boundaries</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span><span class="s1">result_boundaries</span><span class="s3">, </span><span class="s1">expected_boundaries</span><span class="s3">)</span>

        <span class="s1">expected_yticklabels </span><span class="s3">= </span><span class="s1">categories</span>
        <span class="s1">result_yticklabels </span><span class="s3">= [</span><span class="s1">i</span><span class="s3">.</span><span class="s1">get_text</span><span class="s3">() </span><span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">colorbar</span><span class="s3">.</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_ymajorticklabels</span><span class="s3">()]</span>
        <span class="s2">assert </span><span class="s1">all</span><span class="s3">(</span><span class="s1">i </span><span class="s3">== </span><span class="s1">j </span><span class="s2">for </span><span class="s1">i</span><span class="s3">, </span><span class="s1">j </span><span class="s2">in </span><span class="s1">zip</span><span class="s3">(</span><span class="s1">result_yticklabels</span><span class="s3">, </span><span class="s1">expected_yticklabels</span><span class="s3">))</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;x, y&quot;</span><span class="s3">, [(</span><span class="s4">&quot;x&quot;</span><span class="s3">, </span><span class="s4">&quot;y&quot;</span><span class="s3">), (</span><span class="s4">&quot;y&quot;</span><span class="s3">, </span><span class="s4">&quot;x&quot;</span><span class="s3">), (</span><span class="s4">&quot;y&quot;</span><span class="s3">, </span><span class="s4">&quot;y&quot;</span><span class="s3">)])</span>
    <span class="s2">def </span><span class="s1">test_plot_scatter_with_categorical_data</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">x</span><span class="s3">, </span><span class="s1">y</span><span class="s3">):</span>
        <span class="s5"># after fixing GH 18755, should be able to plot categorical data</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;x&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">], </span><span class="s4">&quot;y&quot;</span><span class="s3">: </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">Categorical</span><span class="s3">([</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;c&quot;</span><span class="s3">])})</span>

        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">scatter</span><span class="s3">, </span><span class="s1">x</span><span class="s3">=</span><span class="s1">x</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s1">y</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;x, y, c&quot;</span><span class="s3">, [(</span><span class="s4">&quot;x&quot;</span><span class="s3">, </span><span class="s4">&quot;y&quot;</span><span class="s3">, </span><span class="s4">&quot;z&quot;</span><span class="s3">), (</span><span class="s6">0</span><span class="s3">, </span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">)])</span>
    <span class="s2">def </span><span class="s1">test_plot_scatter_with_c</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">x</span><span class="s3">, </span><span class="s1">y</span><span class="s3">, </span><span class="s1">c</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">integers</span><span class="s3">(</span><span class="s1">low</span><span class="s3">=</span><span class="s6">0</span><span class="s3">, </span><span class="s1">high</span><span class="s3">=</span><span class="s6">100</span><span class="s3">, </span><span class="s1">size</span><span class="s3">=(</span><span class="s6">6</span><span class="s3">, </span><span class="s6">4</span><span class="s3">)),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s1">string</span><span class="s3">.</span><span class="s1">ascii_letters</span><span class="s3">[:</span><span class="s6">6</span><span class="s3">]),</span>
            <span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;x&quot;</span><span class="s3">, </span><span class="s4">&quot;y&quot;</span><span class="s3">, </span><span class="s4">&quot;z&quot;</span><span class="s3">, </span><span class="s4">&quot;four&quot;</span><span class="s3">],</span>
        <span class="s3">)</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">scatter</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s1">x</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s1">y</span><span class="s3">, </span><span class="s1">c</span><span class="s3">=</span><span class="s1">c</span><span class="s3">)</span>
        <span class="s5"># default to Greys</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">collections</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">cmap</span><span class="s3">.</span><span class="s1">name </span><span class="s3">== </span><span class="s4">&quot;Greys&quot;</span>

        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">collections</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">colorbar</span><span class="s3">.</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_ylabel</span><span class="s3">() == </span><span class="s4">&quot;z&quot;</span>

    <span class="s2">def </span><span class="s1">test_plot_scatter_with_c_props</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">integers</span><span class="s3">(</span><span class="s1">low</span><span class="s3">=</span><span class="s6">0</span><span class="s3">, </span><span class="s1">high</span><span class="s3">=</span><span class="s6">100</span><span class="s3">, </span><span class="s1">size</span><span class="s3">=(</span><span class="s6">6</span><span class="s3">, </span><span class="s6">4</span><span class="s3">)),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s1">string</span><span class="s3">.</span><span class="s1">ascii_letters</span><span class="s3">[:</span><span class="s6">6</span><span class="s3">]),</span>
            <span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;x&quot;</span><span class="s3">, </span><span class="s4">&quot;y&quot;</span><span class="s3">, </span><span class="s4">&quot;z&quot;</span><span class="s3">, </span><span class="s4">&quot;four&quot;</span><span class="s3">],</span>
        <span class="s3">)</span>
        <span class="s1">cm </span><span class="s3">= </span><span class="s4">&quot;cubehelix&quot;</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">scatter</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s4">&quot;x&quot;</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s4">&quot;y&quot;</span><span class="s3">, </span><span class="s1">c</span><span class="s3">=</span><span class="s4">&quot;z&quot;</span><span class="s3">, </span><span class="s1">colormap</span><span class="s3">=</span><span class="s1">cm</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">collections</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">cmap</span><span class="s3">.</span><span class="s1">name </span><span class="s3">== </span><span class="s1">cm</span>

        <span class="s5"># verify turning off colorbar works</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">scatter</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s4">&quot;x&quot;</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s4">&quot;y&quot;</span><span class="s3">, </span><span class="s1">c</span><span class="s3">=</span><span class="s4">&quot;z&quot;</span><span class="s3">, </span><span class="s1">colorbar</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">collections</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">colorbar </span><span class="s2">is None</span>

        <span class="s5"># verify that we can still plot a solid color</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">scatter</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s6">0</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s6">1</span><span class="s3">, </span><span class="s1">c</span><span class="s3">=</span><span class="s4">&quot;red&quot;</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">collections</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">colorbar </span><span class="s2">is None</span>
        <span class="s1">_check_colors</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">collections</span><span class="s3">, </span><span class="s1">facecolors</span><span class="s3">=[</span><span class="s4">&quot;r&quot;</span><span class="s3">])</span>

    <span class="s2">def </span><span class="s1">test_plot_scatter_with_c_array</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s5"># Ensure that we can pass an np.array straight through to matplotlib,</span>
        <span class="s5"># this functionality was accidentally removed previously.</span>
        <span class="s5"># See https://github.com/pandas-dev/pandas/issues/8852 for bug report</span>
        <span class="s5">#</span>
        <span class="s5"># Exercise colormap path and non-colormap path as they are independent</span>
        <span class="s5">#</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;A&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">], </span><span class="s4">&quot;B&quot;</span><span class="s3">: [</span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">]})</span>
        <span class="s1">red_rgba </span><span class="s3">= [</span><span class="s6">1.0</span><span class="s3">, </span><span class="s6">0.0</span><span class="s3">, </span><span class="s6">0.0</span><span class="s3">, </span><span class="s6">1.0</span><span class="s3">]</span>
        <span class="s1">green_rgba </span><span class="s3">= [</span><span class="s6">0.0</span><span class="s3">, </span><span class="s6">1.0</span><span class="s3">, </span><span class="s6">0.0</span><span class="s3">, </span><span class="s6">1.0</span><span class="s3">]</span>
        <span class="s1">rgba_array </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s1">red_rgba</span><span class="s3">, </span><span class="s1">green_rgba</span><span class="s3">])</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">scatter</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s4">&quot;A&quot;</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s4">&quot;B&quot;</span><span class="s3">, </span><span class="s1">c</span><span class="s3">=</span><span class="s1">rgba_array</span><span class="s3">)</span>
        <span class="s5"># expect the face colors of the points in the non-colormap path to be</span>
        <span class="s5"># identical to the values we supplied, normally we'd be on shaky ground</span>
        <span class="s5"># comparing floats for equality but here we expect them to be</span>
        <span class="s5"># identical.</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">collections</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">get_facecolor</span><span class="s3">(), </span><span class="s1">rgba_array</span><span class="s3">)</span>
        <span class="s5"># we don't test the colors of the faces in this next plot because they</span>
        <span class="s5"># are dependent on the spring colormap, which may change its colors</span>
        <span class="s5"># later.</span>
        <span class="s1">float_array </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">0.0</span><span class="s3">, </span><span class="s6">1.0</span><span class="s3">])</span>
        <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">scatter</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s4">&quot;A&quot;</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s4">&quot;B&quot;</span><span class="s3">, </span><span class="s1">c</span><span class="s3">=</span><span class="s1">float_array</span><span class="s3">, </span><span class="s1">cmap</span><span class="s3">=</span><span class="s4">&quot;spring&quot;</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_plot_scatter_with_s</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s5"># this refers to GH 32904</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">((</span><span class="s6">10</span><span class="s3">, </span><span class="s6">3</span><span class="s3">)) * </span><span class="s6">100</span><span class="s3">, </span><span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s4">&quot;c&quot;</span><span class="s3">]</span>
        <span class="s3">)</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">scatter</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s1">s</span><span class="s3">=</span><span class="s4">&quot;c&quot;</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span><span class="s1">df</span><span class="s3">[</span><span class="s4">&quot;c&quot;</span><span class="s3">].</span><span class="s1">values</span><span class="s3">, </span><span class="s1">right</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">collections</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">get_sizes</span><span class="s3">())</span>

    <span class="s2">def </span><span class="s1">test_plot_scatter_with_norm</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s5"># added while fixing GH 45809</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">((</span><span class="s6">10</span><span class="s3">, </span><span class="s6">3</span><span class="s3">)) * </span><span class="s6">100</span><span class="s3">, </span><span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s4">&quot;c&quot;</span><span class="s3">]</span>
        <span class="s3">)</span>
        <span class="s1">norm </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">colors</span><span class="s3">.</span><span class="s1">LogNorm</span><span class="s3">()</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">scatter</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s1">c</span><span class="s3">=</span><span class="s4">&quot;c&quot;</span><span class="s3">, </span><span class="s1">norm</span><span class="s3">=</span><span class="s1">norm</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">collections</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">norm </span><span class="s2">is </span><span class="s1">norm</span>

    <span class="s2">def </span><span class="s1">test_plot_scatter_without_norm</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s5"># added while fixing GH 45809</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">((</span><span class="s6">10</span><span class="s3">, </span><span class="s6">3</span><span class="s3">)) * </span><span class="s6">100</span><span class="s3">, </span><span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s4">&quot;c&quot;</span><span class="s3">]</span>
        <span class="s3">)</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">scatter</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s1">c</span><span class="s3">=</span><span class="s4">&quot;c&quot;</span><span class="s3">)</span>
        <span class="s1">plot_norm </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">collections</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">norm</span>
        <span class="s1">color_min_max </span><span class="s3">= (</span><span class="s1">df</span><span class="s3">.</span><span class="s1">c</span><span class="s3">.</span><span class="s1">min</span><span class="s3">(), </span><span class="s1">df</span><span class="s3">.</span><span class="s1">c</span><span class="s3">.</span><span class="s1">max</span><span class="s3">())</span>
        <span class="s1">default_norm </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">colors</span><span class="s3">.</span><span class="s1">Normalize</span><span class="s3">(*</span><span class="s1">color_min_max</span><span class="s3">)</span>
        <span class="s2">for </span><span class="s1">value </span><span class="s2">in </span><span class="s1">df</span><span class="s3">.</span><span class="s1">c</span><span class="s3">:</span>
            <span class="s2">assert </span><span class="s1">plot_norm</span><span class="s3">(</span><span class="s1">value</span><span class="s3">) == </span><span class="s1">default_norm</span><span class="s3">(</span><span class="s1">value</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;kwargs&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s3">{},</span>
            <span class="s3">{</span><span class="s4">&quot;legend&quot;</span><span class="s3">: </span><span class="s2">False</span><span class="s3">},</span>
            <span class="s3">{</span><span class="s4">&quot;default_axes&quot;</span><span class="s3">: </span><span class="s2">True</span><span class="s3">, </span><span class="s4">&quot;subplots&quot;</span><span class="s3">: </span><span class="s2">True</span><span class="s3">},</span>
            <span class="s3">{</span><span class="s4">&quot;stacked&quot;</span><span class="s3">: </span><span class="s2">True</span><span class="s3">},</span>
        <span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_plot_bar</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">kwargs</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">6</span><span class="s3">, </span><span class="s6">4</span><span class="s3">)),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s1">string</span><span class="s3">.</span><span class="s1">ascii_letters</span><span class="s3">[:</span><span class="s6">6</span><span class="s3">]),</span>
            <span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;one&quot;</span><span class="s3">, </span><span class="s4">&quot;two&quot;</span><span class="s3">, </span><span class="s4">&quot;three&quot;</span><span class="s3">, </span><span class="s4">&quot;four&quot;</span><span class="s3">],</span>
        <span class="s3">)</span>

        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">bar</span><span class="s3">, **</span><span class="s1">kwargs</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s2">def </span><span class="s1">test_plot_bar_int_col</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">10</span><span class="s3">, </span><span class="s6">15</span><span class="s3">)),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s1">string</span><span class="s3">.</span><span class="s1">ascii_letters</span><span class="s3">[:</span><span class="s6">10</span><span class="s3">]),</span>
            <span class="s1">columns</span><span class="s3">=</span><span class="s1">range</span><span class="s3">(</span><span class="s6">15</span><span class="s3">),</span>
        <span class="s3">)</span>
        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">bar</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s2">def </span><span class="s1">test_plot_bar_ticks</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;a&quot;</span><span class="s3">: [</span><span class="s6">0</span><span class="s3">, </span><span class="s6">1</span><span class="s3">], </span><span class="s4">&quot;b&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">0</span><span class="s3">]})</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">bar</span><span class="s3">)</span>
        <span class="s1">_check_ticks_props</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xrot</span><span class="s3">=</span><span class="s6">90</span><span class="s3">)</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">bar</span><span class="s3">(</span><span class="s1">rot</span><span class="s3">=</span><span class="s6">35</span><span class="s3">, </span><span class="s1">fontsize</span><span class="s3">=</span><span class="s6">10</span><span class="s3">)</span>
        <span class="s1">_check_ticks_props</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xrot</span><span class="s3">=</span><span class="s6">35</span><span class="s3">, </span><span class="s1">xlabelsize</span><span class="s3">=</span><span class="s6">10</span><span class="s3">, </span><span class="s1">ylabelsize</span><span class="s3">=</span><span class="s6">10</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s2">def </span><span class="s1">test_plot_barh_ticks</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;a&quot;</span><span class="s3">: [</span><span class="s6">0</span><span class="s3">, </span><span class="s6">1</span><span class="s3">], </span><span class="s4">&quot;b&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">0</span><span class="s3">]})</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">barh</span><span class="s3">)</span>
        <span class="s1">_check_ticks_props</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">yrot</span><span class="s3">=</span><span class="s6">0</span><span class="s3">)</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">barh</span><span class="s3">(</span><span class="s1">rot</span><span class="s3">=</span><span class="s6">55</span><span class="s3">, </span><span class="s1">fontsize</span><span class="s3">=</span><span class="s6">11</span><span class="s3">)</span>
        <span class="s1">_check_ticks_props</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">yrot</span><span class="s3">=</span><span class="s6">55</span><span class="s3">, </span><span class="s1">ylabelsize</span><span class="s3">=</span><span class="s6">11</span><span class="s3">, </span><span class="s1">xlabelsize</span><span class="s3">=</span><span class="s6">11</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_boxplot</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">hist_df</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">hist_df</span>
        <span class="s1">numeric_cols </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">_get_numeric_data</span><span class="s3">().</span><span class="s1">columns</span>
        <span class="s1">labels </span><span class="s3">= [</span><span class="s1">pprint_thing</span><span class="s3">(</span><span class="s1">c</span><span class="s3">) </span><span class="s2">for </span><span class="s1">c </span><span class="s2">in </span><span class="s1">numeric_cols</span><span class="s3">]</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">box</span><span class="s3">)</span>
        <span class="s1">_check_text_labels</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticklabels</span><span class="s3">(), </span><span class="s1">labels</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span>
            <span class="s1">ax</span><span class="s3">.</span><span class="s1">xaxis</span><span class="s3">.</span><span class="s1">get_ticklocs</span><span class="s3">(), </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">1</span><span class="s3">, </span><span class="s1">len</span><span class="s3">(</span><span class="s1">numeric_cols</span><span class="s3">) + </span><span class="s6">1</span><span class="s3">)</span>
        <span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">) == </span><span class="s6">7 </span><span class="s3">* </span><span class="s1">len</span><span class="s3">(</span><span class="s1">numeric_cols</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_boxplot_series</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">hist_df</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">hist_df</span>
        <span class="s1">series </span><span class="s3">= </span><span class="s1">df</span><span class="s3">[</span><span class="s4">&quot;height&quot;</span><span class="s3">]</span>
        <span class="s1">axes </span><span class="s3">= </span><span class="s1">series</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">box</span><span class="s3">(</span><span class="s1">rot</span><span class="s3">=</span><span class="s6">40</span><span class="s3">)</span>
        <span class="s1">_check_ticks_props</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">, </span><span class="s1">xrot</span><span class="s3">=</span><span class="s6">40</span><span class="s3">, </span><span class="s1">yrot</span><span class="s3">=</span><span class="s6">0</span><span class="s3">)</span>

        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">series</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">box</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_boxplot_series_positions</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">hist_df</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">hist_df</span>
        <span class="s1">positions </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">1</span><span class="s3">, </span><span class="s6">6</span><span class="s3">, </span><span class="s6">7</span><span class="s3">])</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">box</span><span class="s3">(</span><span class="s1">positions</span><span class="s3">=</span><span class="s1">positions</span><span class="s3">)</span>
        <span class="s1">numeric_cols </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">_get_numeric_data</span><span class="s3">().</span><span class="s1">columns</span>
        <span class="s1">labels </span><span class="s3">= [</span><span class="s1">pprint_thing</span><span class="s3">(</span><span class="s1">c</span><span class="s3">) </span><span class="s2">for </span><span class="s1">c </span><span class="s2">in </span><span class="s1">numeric_cols</span><span class="s3">]</span>
        <span class="s1">_check_text_labels</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticklabels</span><span class="s3">(), </span><span class="s1">labels</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">xaxis</span><span class="s3">.</span><span class="s1">get_ticklocs</span><span class="s3">(), </span><span class="s1">positions</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">) == </span><span class="s6">7 </span><span class="s3">* </span><span class="s1">len</span><span class="s3">(</span><span class="s1">numeric_cols</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_boxplot_vertical</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">hist_df</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">hist_df</span>
        <span class="s1">numeric_cols </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">_get_numeric_data</span><span class="s3">().</span><span class="s1">columns</span>
        <span class="s1">labels </span><span class="s3">= [</span><span class="s1">pprint_thing</span><span class="s3">(</span><span class="s1">c</span><span class="s3">) </span><span class="s2">for </span><span class="s1">c </span><span class="s2">in </span><span class="s1">numeric_cols</span><span class="s3">]</span>

        <span class="s5"># if horizontal, yticklabels are rotated</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">box</span><span class="s3">(</span><span class="s1">rot</span><span class="s3">=</span><span class="s6">50</span><span class="s3">, </span><span class="s1">fontsize</span><span class="s3">=</span><span class="s6">8</span><span class="s3">, </span><span class="s1">vert</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>
        <span class="s1">_check_ticks_props</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xrot</span><span class="s3">=</span><span class="s6">0</span><span class="s3">, </span><span class="s1">yrot</span><span class="s3">=</span><span class="s6">50</span><span class="s3">, </span><span class="s1">ylabelsize</span><span class="s3">=</span><span class="s6">8</span><span class="s3">)</span>
        <span class="s1">_check_text_labels</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_yticklabels</span><span class="s3">(), </span><span class="s1">labels</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">) == </span><span class="s6">7 </span><span class="s3">* </span><span class="s1">len</span><span class="s3">(</span><span class="s1">numeric_cols</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">filterwarnings</span><span class="s3">(</span><span class="s4">&quot;ignore:Attempt:UserWarning&quot;</span><span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_boxplot_vertical_subplots</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">hist_df</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">hist_df</span>
        <span class="s1">numeric_cols </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">_get_numeric_data</span><span class="s3">().</span><span class="s1">columns</span>
        <span class="s1">labels </span><span class="s3">= [</span><span class="s1">pprint_thing</span><span class="s3">(</span><span class="s1">c</span><span class="s3">) </span><span class="s2">for </span><span class="s1">c </span><span class="s2">in </span><span class="s1">numeric_cols</span><span class="s3">]</span>
        <span class="s1">axes </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">box</span><span class="s3">,</span>
            <span class="s1">default_axes</span><span class="s3">=</span><span class="s2">True</span><span class="s3">,</span>
            <span class="s1">subplots</span><span class="s3">=</span><span class="s2">True</span><span class="s3">,</span>
            <span class="s1">vert</span><span class="s3">=</span><span class="s2">False</span><span class="s3">,</span>
            <span class="s1">logx</span><span class="s3">=</span><span class="s2">True</span><span class="s3">,</span>
        <span class="s3">)</span>
        <span class="s1">_check_axes_shape</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">, </span><span class="s1">axes_num</span><span class="s3">=</span><span class="s6">3</span><span class="s3">, </span><span class="s1">layout</span><span class="s3">=(</span><span class="s6">1</span><span class="s3">, </span><span class="s6">3</span><span class="s3">))</span>
        <span class="s1">_check_ax_scales</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">, </span><span class="s1">xaxis</span><span class="s3">=</span><span class="s4">&quot;log&quot;</span><span class="s3">)</span>
        <span class="s2">for </span><span class="s1">ax</span><span class="s3">, </span><span class="s1">label </span><span class="s2">in </span><span class="s1">zip</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">, </span><span class="s1">labels</span><span class="s3">):</span>
            <span class="s1">_check_text_labels</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_yticklabels</span><span class="s3">(), [</span><span class="s1">label</span><span class="s3">])</span>
            <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">) == </span><span class="s6">7</span>

    <span class="s2">def </span><span class="s1">test_boxplot_vertical_positions</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">hist_df</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">hist_df</span>
        <span class="s1">numeric_cols </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">_get_numeric_data</span><span class="s3">().</span><span class="s1">columns</span>
        <span class="s1">labels </span><span class="s3">= [</span><span class="s1">pprint_thing</span><span class="s3">(</span><span class="s1">c</span><span class="s3">) </span><span class="s2">for </span><span class="s1">c </span><span class="s2">in </span><span class="s1">numeric_cols</span><span class="s3">]</span>
        <span class="s1">positions </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">3</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">8</span><span class="s3">])</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">box</span><span class="s3">(</span><span class="s1">positions</span><span class="s3">=</span><span class="s1">positions</span><span class="s3">, </span><span class="s1">vert</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>
        <span class="s1">_check_text_labels</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_yticklabels</span><span class="s3">(), </span><span class="s1">labels</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">yaxis</span><span class="s3">.</span><span class="s1">get_ticklocs</span><span class="s3">(), </span><span class="s1">positions</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">) == </span><span class="s6">7 </span><span class="s3">* </span><span class="s1">len</span><span class="s3">(</span><span class="s1">numeric_cols</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_boxplot_return_type_invalid</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">6</span><span class="s3">, </span><span class="s6">4</span><span class="s3">)),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s1">string</span><span class="s3">.</span><span class="s1">ascii_letters</span><span class="s3">[:</span><span class="s6">6</span><span class="s3">]),</span>
            <span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;one&quot;</span><span class="s3">, </span><span class="s4">&quot;two&quot;</span><span class="s3">, </span><span class="s4">&quot;three&quot;</span><span class="s3">, </span><span class="s4">&quot;four&quot;</span><span class="s3">],</span>
        <span class="s3">)</span>
        <span class="s1">msg </span><span class="s3">= </span><span class="s4">&quot;return_type must be {None, 'axes', 'dict', 'both'}&quot;</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">ValueError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">box</span><span class="s3">(</span><span class="s1">return_type</span><span class="s3">=</span><span class="s4">&quot;not_a_type&quot;</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;return_type&quot;</span><span class="s3">, [</span><span class="s4">&quot;dict&quot;</span><span class="s3">, </span><span class="s4">&quot;axes&quot;</span><span class="s3">, </span><span class="s4">&quot;both&quot;</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_boxplot_return_type_invalid_type</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">return_type</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">6</span><span class="s3">, </span><span class="s6">4</span><span class="s3">)),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s1">string</span><span class="s3">.</span><span class="s1">ascii_letters</span><span class="s3">[:</span><span class="s6">6</span><span class="s3">]),</span>
            <span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;one&quot;</span><span class="s3">, </span><span class="s4">&quot;two&quot;</span><span class="s3">, </span><span class="s4">&quot;three&quot;</span><span class="s3">, </span><span class="s4">&quot;four&quot;</span><span class="s3">],</span>
        <span class="s3">)</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">box</span><span class="s3">(</span><span class="s1">return_type</span><span class="s3">=</span><span class="s1">return_type</span><span class="s3">)</span>
        <span class="s1">_check_box_return_type</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">return_type</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_kde_df</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">pytest</span><span class="s3">.</span><span class="s1">importorskip</span><span class="s3">(</span><span class="s4">&quot;scipy&quot;</span><span class="s3">)</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">100</span><span class="s3">, </span><span class="s6">4</span><span class="s3">)))</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">=</span><span class="s4">&quot;kde&quot;</span><span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= [</span><span class="s1">pprint_thing</span><span class="s3">(</span><span class="s1">c</span><span class="s3">) </span><span class="s2">for </span><span class="s1">c </span><span class="s2">in </span><span class="s1">df</span><span class="s3">.</span><span class="s1">columns</span><span class="s3">]</span>
        <span class="s1">_check_legend_labels</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">labels</span><span class="s3">=</span><span class="s1">expected</span><span class="s3">)</span>
        <span class="s1">_check_ticks_props</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xrot</span><span class="s3">=</span><span class="s6">0</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_kde_df_rot</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">pytest</span><span class="s3">.</span><span class="s1">importorskip</span><span class="s3">(</span><span class="s4">&quot;scipy&quot;</span><span class="s3">)</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">10</span><span class="s3">, </span><span class="s6">4</span><span class="s3">)))</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">kind</span><span class="s3">=</span><span class="s4">&quot;kde&quot;</span><span class="s3">, </span><span class="s1">rot</span><span class="s3">=</span><span class="s6">20</span><span class="s3">, </span><span class="s1">fontsize</span><span class="s3">=</span><span class="s6">5</span><span class="s3">)</span>
        <span class="s1">_check_ticks_props</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xrot</span><span class="s3">=</span><span class="s6">20</span><span class="s3">, </span><span class="s1">xlabelsize</span><span class="s3">=</span><span class="s6">5</span><span class="s3">, </span><span class="s1">ylabelsize</span><span class="s3">=</span><span class="s6">5</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_kde_df_subplots</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">pytest</span><span class="s3">.</span><span class="s1">importorskip</span><span class="s3">(</span><span class="s4">&quot;scipy&quot;</span><span class="s3">)</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">10</span><span class="s3">, </span><span class="s6">4</span><span class="s3">)))</span>
        <span class="s1">axes </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">,</span>
            <span class="s1">default_axes</span><span class="s3">=</span><span class="s2">True</span><span class="s3">,</span>
            <span class="s1">kind</span><span class="s3">=</span><span class="s4">&quot;kde&quot;</span><span class="s3">,</span>
            <span class="s1">subplots</span><span class="s3">=</span><span class="s2">True</span><span class="s3">,</span>
        <span class="s3">)</span>
        <span class="s1">_check_axes_shape</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">, </span><span class="s1">axes_num</span><span class="s3">=</span><span class="s6">4</span><span class="s3">, </span><span class="s1">layout</span><span class="s3">=(</span><span class="s6">4</span><span class="s3">, </span><span class="s6">1</span><span class="s3">))</span>

    <span class="s2">def </span><span class="s1">test_kde_df_logy</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">pytest</span><span class="s3">.</span><span class="s1">importorskip</span><span class="s3">(</span><span class="s4">&quot;scipy&quot;</span><span class="s3">)</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">10</span><span class="s3">, </span><span class="s6">4</span><span class="s3">)))</span>
        <span class="s1">axes </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">kind</span><span class="s3">=</span><span class="s4">&quot;kde&quot;</span><span class="s3">, </span><span class="s1">logy</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">subplots</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s1">_check_ax_scales</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">, </span><span class="s1">yaxis</span><span class="s3">=</span><span class="s4">&quot;log&quot;</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_kde_missing_vals</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">pytest</span><span class="s3">.</span><span class="s1">importorskip</span><span class="s3">(</span><span class="s4">&quot;scipy&quot;</span><span class="s3">)</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">uniform</span><span class="s3">(</span><span class="s1">size</span><span class="s3">=(</span><span class="s6">100</span><span class="s3">, </span><span class="s6">4</span><span class="s3">)))</span>
        <span class="s1">df</span><span class="s3">.</span><span class="s1">loc</span><span class="s3">[</span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">] = </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span>
        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">=</span><span class="s4">&quot;kde&quot;</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_hist_df</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">100</span><span class="s3">, </span><span class="s6">4</span><span class="s3">)))</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">hist</span><span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= [</span><span class="s1">pprint_thing</span><span class="s3">(</span><span class="s1">c</span><span class="s3">) </span><span class="s2">for </span><span class="s1">c </span><span class="s2">in </span><span class="s1">df</span><span class="s3">.</span><span class="s1">columns</span><span class="s3">]</span>
        <span class="s1">_check_legend_labels</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">labels</span><span class="s3">=</span><span class="s1">expected</span><span class="s3">)</span>

        <span class="s1">axes </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">hist</span><span class="s3">,</span>
            <span class="s1">default_axes</span><span class="s3">=</span><span class="s2">True</span><span class="s3">,</span>
            <span class="s1">subplots</span><span class="s3">=</span><span class="s2">True</span><span class="s3">,</span>
            <span class="s1">logy</span><span class="s3">=</span><span class="s2">True</span><span class="s3">,</span>
        <span class="s3">)</span>
        <span class="s1">_check_axes_shape</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">, </span><span class="s1">axes_num</span><span class="s3">=</span><span class="s6">4</span><span class="s3">, </span><span class="s1">layout</span><span class="s3">=(</span><span class="s6">4</span><span class="s3">, </span><span class="s6">1</span><span class="s3">))</span>
        <span class="s1">_check_ax_scales</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">, </span><span class="s1">yaxis</span><span class="s3">=</span><span class="s4">&quot;log&quot;</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_hist_df_series</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">series </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">(</span><span class="s6">10</span><span class="s3">))</span>
        <span class="s1">axes </span><span class="s3">= </span><span class="s1">series</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">hist</span><span class="s3">(</span><span class="s1">rot</span><span class="s3">=</span><span class="s6">40</span><span class="s3">)</span>
        <span class="s1">_check_ticks_props</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">, </span><span class="s1">xrot</span><span class="s3">=</span><span class="s6">40</span><span class="s3">, </span><span class="s1">yrot</span><span class="s3">=</span><span class="s6">0</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_hist_df_series_cumulative_density</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s2">from </span><span class="s1">matplotlib</span><span class="s3">.</span><span class="s1">patches </span><span class="s2">import </span><span class="s1">Rectangle</span>

        <span class="s1">series </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">(</span><span class="s6">10</span><span class="s3">))</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">series</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">hist</span><span class="s3">(</span><span class="s1">cumulative</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">bins</span><span class="s3">=</span><span class="s6">4</span><span class="s3">, </span><span class="s1">density</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s5"># height of last bin (index 5) must be 1.0</span>
        <span class="s1">rects </span><span class="s3">= [</span><span class="s1">x </span><span class="s2">for </span><span class="s1">x </span><span class="s2">in </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_children</span><span class="s3">() </span><span class="s2">if </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">x</span><span class="s3">, </span><span class="s1">Rectangle</span><span class="s3">)]</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_almost_equal</span><span class="s3">(</span><span class="s1">rects</span><span class="s3">[-</span><span class="s6">1</span><span class="s3">].</span><span class="s1">get_height</span><span class="s3">(), </span><span class="s6">1.0</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_hist_df_series_cumulative</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s2">from </span><span class="s1">matplotlib</span><span class="s3">.</span><span class="s1">patches </span><span class="s2">import </span><span class="s1">Rectangle</span>

        <span class="s1">series </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">(</span><span class="s6">10</span><span class="s3">))</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">series</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">hist</span><span class="s3">(</span><span class="s1">cumulative</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">bins</span><span class="s3">=</span><span class="s6">4</span><span class="s3">)</span>
        <span class="s1">rects </span><span class="s3">= [</span><span class="s1">x </span><span class="s2">for </span><span class="s1">x </span><span class="s2">in </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_children</span><span class="s3">() </span><span class="s2">if </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">x</span><span class="s3">, </span><span class="s1">Rectangle</span><span class="s3">)]</span>

        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_almost_equal</span><span class="s3">(</span><span class="s1">rects</span><span class="s3">[-</span><span class="s6">2</span><span class="s3">].</span><span class="s1">get_height</span><span class="s3">(), </span><span class="s6">10.0</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_hist_df_orientation</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">10</span><span class="s3">, </span><span class="s6">4</span><span class="s3">)))</span>
        <span class="s5"># if horizontal, yticklabels are rotated</span>
        <span class="s1">axes </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">hist</span><span class="s3">(</span><span class="s1">rot</span><span class="s3">=</span><span class="s6">50</span><span class="s3">, </span><span class="s1">fontsize</span><span class="s3">=</span><span class="s6">8</span><span class="s3">, </span><span class="s1">orientation</span><span class="s3">=</span><span class="s4">&quot;horizontal&quot;</span><span class="s3">)</span>
        <span class="s1">_check_ticks_props</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">, </span><span class="s1">xrot</span><span class="s3">=</span><span class="s6">0</span><span class="s3">, </span><span class="s1">yrot</span><span class="s3">=</span><span class="s6">50</span><span class="s3">, </span><span class="s1">ylabelsize</span><span class="s3">=</span><span class="s6">8</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;weights&quot;</span><span class="s3">, [</span><span class="s6">0.1 </span><span class="s3">* </span><span class="s1">np</span><span class="s3">.</span><span class="s1">ones</span><span class="s3">(</span><span class="s1">shape</span><span class="s3">=(</span><span class="s6">100</span><span class="s3">,)), </span><span class="s6">0.1 </span><span class="s3">* </span><span class="s1">np</span><span class="s3">.</span><span class="s1">ones</span><span class="s3">(</span><span class="s1">shape</span><span class="s3">=(</span><span class="s6">100</span><span class="s3">, </span><span class="s6">2</span><span class="s3">))]</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_hist_weights</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">weights</span><span class="s3">):</span>
        <span class="s5"># GH 33173</span>

        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">dict</span><span class="s3">(</span><span class="s1">zip</span><span class="s3">([</span><span class="s4">&quot;A&quot;</span><span class="s3">, </span><span class="s4">&quot;B&quot;</span><span class="s3">], </span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">2</span><span class="s3">, </span><span class="s6">100</span><span class="s3">))))</span>
        <span class="s3">)</span>

        <span class="s1">ax1 </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">=</span><span class="s4">&quot;hist&quot;</span><span class="s3">, </span><span class="s1">weights</span><span class="s3">=</span><span class="s1">weights</span><span class="s3">)</span>
        <span class="s1">ax2 </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">=</span><span class="s4">&quot;hist&quot;</span><span class="s3">)</span>

        <span class="s1">patch_height_with_weights </span><span class="s3">= [</span><span class="s1">patch</span><span class="s3">.</span><span class="s1">get_height</span><span class="s3">() </span><span class="s2">for </span><span class="s1">patch </span><span class="s2">in </span><span class="s1">ax1</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">]</span>

        <span class="s5"># original heights with no weights, and we manually multiply with example</span>
        <span class="s5"># weights, so after multiplication, they should be almost same</span>
        <span class="s1">expected_patch_height </span><span class="s3">= [</span><span class="s6">0.1 </span><span class="s3">* </span><span class="s1">patch</span><span class="s3">.</span><span class="s1">get_height</span><span class="s3">() </span><span class="s2">for </span><span class="s1">patch </span><span class="s2">in </span><span class="s1">ax2</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">]</span>

        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_almost_equal</span><span class="s3">(</span><span class="s1">patch_height_with_weights</span><span class="s3">, </span><span class="s1">expected_patch_height</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">_check_box_coord</span><span class="s3">(</span>
        <span class="s1">self</span><span class="s3">,</span>
        <span class="s1">patches</span><span class="s3">,</span>
        <span class="s1">expected_y</span><span class="s3">=</span><span class="s2">None</span><span class="s3">,</span>
        <span class="s1">expected_h</span><span class="s3">=</span><span class="s2">None</span><span class="s3">,</span>
        <span class="s1">expected_x</span><span class="s3">=</span><span class="s2">None</span><span class="s3">,</span>
        <span class="s1">expected_w</span><span class="s3">=</span><span class="s2">None</span><span class="s3">,</span>
    <span class="s3">):</span>
        <span class="s1">result_y </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s1">p</span><span class="s3">.</span><span class="s1">get_y</span><span class="s3">() </span><span class="s2">for </span><span class="s1">p </span><span class="s2">in </span><span class="s1">patches</span><span class="s3">])</span>
        <span class="s1">result_height </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s1">p</span><span class="s3">.</span><span class="s1">get_height</span><span class="s3">() </span><span class="s2">for </span><span class="s1">p </span><span class="s2">in </span><span class="s1">patches</span><span class="s3">])</span>
        <span class="s1">result_x </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s1">p</span><span class="s3">.</span><span class="s1">get_x</span><span class="s3">() </span><span class="s2">for </span><span class="s1">p </span><span class="s2">in </span><span class="s1">patches</span><span class="s3">])</span>
        <span class="s1">result_width </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s1">p</span><span class="s3">.</span><span class="s1">get_width</span><span class="s3">() </span><span class="s2">for </span><span class="s1">p </span><span class="s2">in </span><span class="s1">patches</span><span class="s3">])</span>
        <span class="s5"># dtype is depending on above values, no need to check</span>

        <span class="s2">if </span><span class="s1">expected_y </span><span class="s2">is not None</span><span class="s3">:</span>
            <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span><span class="s1">result_y</span><span class="s3">, </span><span class="s1">expected_y</span><span class="s3">, </span><span class="s1">check_dtype</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">expected_h </span><span class="s2">is not None</span><span class="s3">:</span>
            <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span><span class="s1">result_height</span><span class="s3">, </span><span class="s1">expected_h</span><span class="s3">, </span><span class="s1">check_dtype</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">expected_x </span><span class="s2">is not None</span><span class="s3">:</span>
            <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span><span class="s1">result_x</span><span class="s3">, </span><span class="s1">expected_x</span><span class="s3">, </span><span class="s1">check_dtype</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">expected_w </span><span class="s2">is not None</span><span class="s3">:</span>
            <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span><span class="s1">result_width</span><span class="s3">, </span><span class="s1">expected_w</span><span class="s3">, </span><span class="s1">check_dtype</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;data&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s3">{</span>
                <span class="s4">&quot;A&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">repeat</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">, </span><span class="s6">5</span><span class="s3">]), </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">10</span><span class="s3">, </span><span class="s6">9</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">7</span><span class="s3">, </span><span class="s6">6</span><span class="s3">])),</span>
                <span class="s4">&quot;B&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">repeat</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">, </span><span class="s6">5</span><span class="s3">]), </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">8</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">8</span><span class="s3">])),</span>
                <span class="s4">&quot;C&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">repeat</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">, </span><span class="s6">5</span><span class="s3">]), </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">6</span><span class="s3">, </span><span class="s6">7</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">9</span><span class="s3">, </span><span class="s6">10</span><span class="s3">])),</span>
            <span class="s3">},</span>
            <span class="s3">{</span>
                <span class="s4">&quot;A&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">repeat</span><span class="s3">(</span>
                    <span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">, </span><span class="s6">5</span><span class="s3">]), </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">3</span><span class="s3">, </span><span class="s6">10</span><span class="s3">, </span><span class="s6">9</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">7</span><span class="s3">, </span><span class="s6">6</span><span class="s3">])</span>
                <span class="s3">),</span>
                <span class="s4">&quot;B&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">repeat</span><span class="s3">(</span>
                    <span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">1</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">, </span><span class="s6">5</span><span class="s3">]), </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">8</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">8</span><span class="s3">])</span>
                <span class="s3">),</span>
                <span class="s4">&quot;C&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">repeat</span><span class="s3">(</span>
                    <span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s6">4</span><span class="s3">, </span><span class="s6">5</span><span class="s3">]), </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">6</span><span class="s3">, </span><span class="s6">7</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">9</span><span class="s3">, </span><span class="s6">10</span><span class="s3">])</span>
                <span class="s3">),</span>
            <span class="s3">},</span>
        <span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_hist_df_coord</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">data</span><span class="s3">)</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">hist</span><span class="s3">(</span><span class="s1">bins</span><span class="s3">=</span><span class="s6">5</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_box_coord</span><span class="s3">(</span>
            <span class="s1">ax</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">[:</span><span class="s6">5</span><span class="s3">],</span>
            <span class="s1">expected_y</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">]),</span>
            <span class="s1">expected_h</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">10</span><span class="s3">, </span><span class="s6">9</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">7</span><span class="s3">, </span><span class="s6">6</span><span class="s3">]),</span>
        <span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_box_coord</span><span class="s3">(</span>
            <span class="s1">ax</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">[</span><span class="s6">5</span><span class="s3">:</span><span class="s6">10</span><span class="s3">],</span>
            <span class="s1">expected_y</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">]),</span>
            <span class="s1">expected_h</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">8</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">8</span><span class="s3">]),</span>
        <span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_box_coord</span><span class="s3">(</span>
            <span class="s1">ax</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">[</span><span class="s6">10</span><span class="s3">:],</span>
            <span class="s1">expected_y</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">]),</span>
            <span class="s1">expected_h</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">6</span><span class="s3">, </span><span class="s6">7</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">9</span><span class="s3">, </span><span class="s6">10</span><span class="s3">]),</span>
        <span class="s3">)</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">hist</span><span class="s3">(</span><span class="s1">bins</span><span class="s3">=</span><span class="s6">5</span><span class="s3">, </span><span class="s1">stacked</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_box_coord</span><span class="s3">(</span>
            <span class="s1">ax</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">[:</span><span class="s6">5</span><span class="s3">],</span>
            <span class="s1">expected_y</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">]),</span>
            <span class="s1">expected_h</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">10</span><span class="s3">, </span><span class="s6">9</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">7</span><span class="s3">, </span><span class="s6">6</span><span class="s3">]),</span>
        <span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_box_coord</span><span class="s3">(</span>
            <span class="s1">ax</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">[</span><span class="s6">5</span><span class="s3">:</span><span class="s6">10</span><span class="s3">],</span>
            <span class="s1">expected_y</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">10</span><span class="s3">, </span><span class="s6">9</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">7</span><span class="s3">, </span><span class="s6">6</span><span class="s3">]),</span>
            <span class="s1">expected_h</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">8</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">8</span><span class="s3">]),</span>
        <span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_box_coord</span><span class="s3">(</span>
            <span class="s1">ax</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">[</span><span class="s6">10</span><span class="s3">:],</span>
            <span class="s1">expected_y</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">18</span><span class="s3">, </span><span class="s6">17</span><span class="s3">, </span><span class="s6">16</span><span class="s3">, </span><span class="s6">15</span><span class="s3">, </span><span class="s6">14</span><span class="s3">]),</span>
            <span class="s1">expected_h</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">6</span><span class="s3">, </span><span class="s6">7</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">9</span><span class="s3">, </span><span class="s6">10</span><span class="s3">]),</span>
        <span class="s3">)</span>

        <span class="s1">axes </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">hist</span><span class="s3">(</span><span class="s1">bins</span><span class="s3">=</span><span class="s6">5</span><span class="s3">, </span><span class="s1">stacked</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">subplots</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_box_coord</span><span class="s3">(</span>
            <span class="s1">axes</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">patches</span><span class="s3">,</span>
            <span class="s1">expected_y</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">]),</span>
            <span class="s1">expected_h</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">10</span><span class="s3">, </span><span class="s6">9</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">7</span><span class="s3">, </span><span class="s6">6</span><span class="s3">]),</span>
        <span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_box_coord</span><span class="s3">(</span>
            <span class="s1">axes</span><span class="s3">[</span><span class="s6">1</span><span class="s3">].</span><span class="s1">patches</span><span class="s3">,</span>
            <span class="s1">expected_y</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">]),</span>
            <span class="s1">expected_h</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">8</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">8</span><span class="s3">]),</span>
        <span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_box_coord</span><span class="s3">(</span>
            <span class="s1">axes</span><span class="s3">[</span><span class="s6">2</span><span class="s3">].</span><span class="s1">patches</span><span class="s3">,</span>
            <span class="s1">expected_y</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">]),</span>
            <span class="s1">expected_h</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">6</span><span class="s3">, </span><span class="s6">7</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">9</span><span class="s3">, </span><span class="s6">10</span><span class="s3">]),</span>
        <span class="s3">)</span>

        <span class="s5"># horizontal</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">hist</span><span class="s3">(</span><span class="s1">bins</span><span class="s3">=</span><span class="s6">5</span><span class="s3">, </span><span class="s1">orientation</span><span class="s3">=</span><span class="s4">&quot;horizontal&quot;</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_box_coord</span><span class="s3">(</span>
            <span class="s1">ax</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">[:</span><span class="s6">5</span><span class="s3">],</span>
            <span class="s1">expected_x</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">]),</span>
            <span class="s1">expected_w</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">10</span><span class="s3">, </span><span class="s6">9</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">7</span><span class="s3">, </span><span class="s6">6</span><span class="s3">]),</span>
        <span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_box_coord</span><span class="s3">(</span>
            <span class="s1">ax</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">[</span><span class="s6">5</span><span class="s3">:</span><span class="s6">10</span><span class="s3">],</span>
            <span class="s1">expected_x</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">]),</span>
            <span class="s1">expected_w</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">8</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">8</span><span class="s3">]),</span>
        <span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_box_coord</span><span class="s3">(</span>
            <span class="s1">ax</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">[</span><span class="s6">10</span><span class="s3">:],</span>
            <span class="s1">expected_x</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">]),</span>
            <span class="s1">expected_w</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">6</span><span class="s3">, </span><span class="s6">7</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">9</span><span class="s3">, </span><span class="s6">10</span><span class="s3">]),</span>
        <span class="s3">)</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">hist</span><span class="s3">(</span><span class="s1">bins</span><span class="s3">=</span><span class="s6">5</span><span class="s3">, </span><span class="s1">stacked</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">orientation</span><span class="s3">=</span><span class="s4">&quot;horizontal&quot;</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_box_coord</span><span class="s3">(</span>
            <span class="s1">ax</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">[:</span><span class="s6">5</span><span class="s3">],</span>
            <span class="s1">expected_x</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">]),</span>
            <span class="s1">expected_w</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">10</span><span class="s3">, </span><span class="s6">9</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">7</span><span class="s3">, </span><span class="s6">6</span><span class="s3">]),</span>
        <span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_box_coord</span><span class="s3">(</span>
            <span class="s1">ax</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">[</span><span class="s6">5</span><span class="s3">:</span><span class="s6">10</span><span class="s3">],</span>
            <span class="s1">expected_x</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">10</span><span class="s3">, </span><span class="s6">9</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">7</span><span class="s3">, </span><span class="s6">6</span><span class="s3">]),</span>
            <span class="s1">expected_w</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">8</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">8</span><span class="s3">]),</span>
        <span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_box_coord</span><span class="s3">(</span>
            <span class="s1">ax</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">[</span><span class="s6">10</span><span class="s3">:],</span>
            <span class="s1">expected_x</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">18</span><span class="s3">, </span><span class="s6">17</span><span class="s3">, </span><span class="s6">16</span><span class="s3">, </span><span class="s6">15</span><span class="s3">, </span><span class="s6">14</span><span class="s3">]),</span>
            <span class="s1">expected_w</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">6</span><span class="s3">, </span><span class="s6">7</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">9</span><span class="s3">, </span><span class="s6">10</span><span class="s3">]),</span>
        <span class="s3">)</span>

        <span class="s1">axes </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">hist</span><span class="s3">(</span>
            <span class="s1">bins</span><span class="s3">=</span><span class="s6">5</span><span class="s3">, </span><span class="s1">stacked</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">subplots</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">orientation</span><span class="s3">=</span><span class="s4">&quot;horizontal&quot;</span>
        <span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_box_coord</span><span class="s3">(</span>
            <span class="s1">axes</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">patches</span><span class="s3">,</span>
            <span class="s1">expected_x</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">]),</span>
            <span class="s1">expected_w</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">10</span><span class="s3">, </span><span class="s6">9</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">7</span><span class="s3">, </span><span class="s6">6</span><span class="s3">]),</span>
        <span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_box_coord</span><span class="s3">(</span>
            <span class="s1">axes</span><span class="s3">[</span><span class="s6">1</span><span class="s3">].</span><span class="s1">patches</span><span class="s3">,</span>
            <span class="s1">expected_x</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">]),</span>
            <span class="s1">expected_w</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">8</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">8</span><span class="s3">]),</span>
        <span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_box_coord</span><span class="s3">(</span>
            <span class="s1">axes</span><span class="s3">[</span><span class="s6">2</span><span class="s3">].</span><span class="s1">patches</span><span class="s3">,</span>
            <span class="s1">expected_x</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">]),</span>
            <span class="s1">expected_w</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">6</span><span class="s3">, </span><span class="s6">7</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">9</span><span class="s3">, </span><span class="s6">10</span><span class="s3">]),</span>
        <span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_plot_int_columns</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">100</span><span class="s3">, </span><span class="s6">4</span><span class="s3">))).</span><span class="s1">cumsum</span><span class="s3">()</span>
        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">legend</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;markers&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s3">{</span><span class="s6">0</span><span class="s3">: </span><span class="s4">&quot;^&quot;</span><span class="s3">, </span><span class="s6">1</span><span class="s3">: </span><span class="s4">&quot;+&quot;</span><span class="s3">, </span><span class="s6">2</span><span class="s3">: </span><span class="s4">&quot;o&quot;</span><span class="s3">},</span>
            <span class="s3">{</span><span class="s6">0</span><span class="s3">: </span><span class="s4">&quot;^&quot;</span><span class="s3">, </span><span class="s6">1</span><span class="s3">: </span><span class="s4">&quot;+&quot;</span><span class="s3">},</span>
            <span class="s3">[</span><span class="s4">&quot;^&quot;</span><span class="s3">, </span><span class="s4">&quot;+&quot;</span><span class="s3">, </span><span class="s4">&quot;o&quot;</span><span class="s3">],</span>
            <span class="s3">[</span><span class="s4">&quot;^&quot;</span><span class="s3">, </span><span class="s4">&quot;+&quot;</span><span class="s3">],</span>
        <span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_style_by_column</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">markers</span><span class="s3">):</span>
        <span class="s2">import </span><span class="s1">matplotlib</span><span class="s3">.</span><span class="s1">pyplot </span><span class="s2">as </span><span class="s1">plt</span>

        <span class="s1">fig </span><span class="s3">= </span><span class="s1">plt</span><span class="s3">.</span><span class="s1">gcf</span><span class="s3">()</span>
        <span class="s1">fig</span><span class="s3">.</span><span class="s1">clf</span><span class="s3">()</span>
        <span class="s1">fig</span><span class="s3">.</span><span class="s1">add_subplot</span><span class="s3">(</span><span class="s6">111</span><span class="s3">)</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">10</span><span class="s3">, </span><span class="s6">3</span><span class="s3">)))</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">style</span><span class="s3">=</span><span class="s1">markers</span><span class="s3">)</span>
        <span class="s2">for </span><span class="s1">idx</span><span class="s3">, </span><span class="s1">line </span><span class="s2">in </span><span class="s1">enumerate</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_lines</span><span class="s3">()[: </span><span class="s1">len</span><span class="s3">(</span><span class="s1">markers</span><span class="s3">)]):</span>
            <span class="s2">assert </span><span class="s1">line</span><span class="s3">.</span><span class="s1">get_marker</span><span class="s3">() == </span><span class="s1">markers</span><span class="s3">[</span><span class="s1">idx</span><span class="s3">]</span>

    <span class="s2">def </span><span class="s1">test_line_label_none</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">])</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">()</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_legend</span><span class="s3">() </span><span class="s2">is None</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">legend</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_legend</span><span class="s3">().</span><span class="s1">get_texts</span><span class="s3">()[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">get_text</span><span class="s3">() == </span><span class="s4">&quot;&quot;</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;props, expected&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s3">(</span><span class="s4">&quot;boxprops&quot;</span><span class="s3">, </span><span class="s4">&quot;boxes&quot;</span><span class="s3">),</span>
            <span class="s3">(</span><span class="s4">&quot;whiskerprops&quot;</span><span class="s3">, </span><span class="s4">&quot;whiskers&quot;</span><span class="s3">),</span>
            <span class="s3">(</span><span class="s4">&quot;capprops&quot;</span><span class="s3">, </span><span class="s4">&quot;caps&quot;</span><span class="s3">),</span>
            <span class="s3">(</span><span class="s4">&quot;medianprops&quot;</span><span class="s3">, </span><span class="s4">&quot;medians&quot;</span><span class="s3">),</span>
        <span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_specified_props_kwd_plot_box</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">props</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">):</span>
        <span class="s5"># GH 30346</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s1">k</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">(</span><span class="s6">100</span><span class="s3">) </span><span class="s2">for </span><span class="s1">k </span><span class="s2">in </span><span class="s4">&quot;ABC&quot;</span><span class="s3">})</span>
        <span class="s1">kwd </span><span class="s3">= {</span><span class="s1">props</span><span class="s3">: {</span><span class="s4">&quot;color&quot;</span><span class="s3">: </span><span class="s4">&quot;C1&quot;</span><span class="s3">}}</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">box</span><span class="s3">(</span><span class="s1">return_type</span><span class="s3">=</span><span class="s4">&quot;dict&quot;</span><span class="s3">, **</span><span class="s1">kwd</span><span class="s3">)</span>

        <span class="s2">assert </span><span class="s1">result</span><span class="s3">[</span><span class="s1">expected</span><span class="s3">][</span><span class="s6">0</span><span class="s3">].</span><span class="s1">get_color</span><span class="s3">() == </span><span class="s4">&quot;C1&quot;</span>

    <span class="s2">def </span><span class="s1">test_unordered_ts</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">3.0</span><span class="s3">, </span><span class="s6">2.0</span><span class="s3">, </span><span class="s6">1.0</span><span class="s3">]),</span>
            <span class="s1">index</span><span class="s3">=[</span><span class="s1">date</span><span class="s3">(</span><span class="s6">2012</span><span class="s3">, </span><span class="s6">10</span><span class="s3">, </span><span class="s6">1</span><span class="s3">), </span><span class="s1">date</span><span class="s3">(</span><span class="s6">2012</span><span class="s3">, </span><span class="s6">9</span><span class="s3">, </span><span class="s6">1</span><span class="s3">), </span><span class="s1">date</span><span class="s3">(</span><span class="s6">2012</span><span class="s3">, </span><span class="s6">8</span><span class="s3">, </span><span class="s6">1</span><span class="s3">)],</span>
            <span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;test&quot;</span><span class="s3">],</span>
        <span class="s3">)</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">()</span>
        <span class="s1">xticks </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">get_xdata</span><span class="s3">()</span>
        <span class="s2">assert </span><span class="s1">xticks</span><span class="s3">[</span><span class="s6">0</span><span class="s3">] &lt; </span><span class="s1">xticks</span><span class="s3">[</span><span class="s6">1</span><span class="s3">]</span>
        <span class="s1">ydata </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">get_ydata</span><span class="s3">()</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span><span class="s1">ydata</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s6">1.0</span><span class="s3">, </span><span class="s6">2.0</span><span class="s3">, </span><span class="s6">3.0</span><span class="s3">]))</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;kind&quot;</span><span class="s3">, </span><span class="s1">plotting</span><span class="s3">.</span><span class="s1">PlotAccessor</span><span class="s3">.</span><span class="s1">_common_kinds</span><span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_kind_both_ways</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">):</span>
        <span class="s1">pytest</span><span class="s3">.</span><span class="s1">importorskip</span><span class="s3">(</span><span class="s4">&quot;scipy&quot;</span><span class="s3">)</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;x&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">]})</span>
        <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">)</span>
        <span class="s1">getattr</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">)()</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;kind&quot;</span><span class="s3">, [</span><span class="s4">&quot;scatter&quot;</span><span class="s3">, </span><span class="s4">&quot;hexbin&quot;</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_kind_both_ways_x_y</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">):</span>
        <span class="s1">pytest</span><span class="s3">.</span><span class="s1">importorskip</span><span class="s3">(</span><span class="s4">&quot;scipy&quot;</span><span class="s3">)</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;x&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">]})</span>
        <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s4">&quot;x&quot;</span><span class="s3">, </span><span class="s4">&quot;x&quot;</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">)</span>
        <span class="s1">getattr</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">)(</span><span class="s4">&quot;x&quot;</span><span class="s3">, </span><span class="s4">&quot;x&quot;</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;kind&quot;</span><span class="s3">, </span><span class="s1">plotting</span><span class="s3">.</span><span class="s1">PlotAccessor</span><span class="s3">.</span><span class="s1">_common_kinds</span><span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_all_invalid_plot_data</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">list</span><span class="s3">(</span><span class="s4">&quot;abcd&quot;</span><span class="s3">))</span>
        <span class="s1">msg </span><span class="s3">= </span><span class="s4">&quot;no numeric data to plot&quot;</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">TypeError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;kind&quot;</span><span class="s3">, </span><span class="s1">list</span><span class="s3">(</span><span class="s1">plotting</span><span class="s3">.</span><span class="s1">PlotAccessor</span><span class="s3">.</span><span class="s1">_common_kinds</span><span class="s3">) + [</span><span class="s4">&quot;area&quot;</span><span class="s3">]</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_partially_invalid_plot_data_numeric</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">10</span><span class="s3">, </span><span class="s6">2</span><span class="s3">)),</span>
            <span class="s1">dtype</span><span class="s3">=</span><span class="s1">object</span><span class="s3">,</span>
        <span class="s3">)</span>
        <span class="s1">df</span><span class="s3">[</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">shape</span><span class="s3">[</span><span class="s6">0</span><span class="s3">]) &gt; </span><span class="s6">0.5</span><span class="s3">] = </span><span class="s4">&quot;a&quot;</span>
        <span class="s1">msg </span><span class="s3">= </span><span class="s4">&quot;no numeric data to plot&quot;</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">TypeError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_invalid_kind</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">10</span><span class="s3">, </span><span class="s6">2</span><span class="s3">)))</span>
        <span class="s1">msg </span><span class="s3">= </span><span class="s4">&quot;invalid_plot_kind is not a valid plot kind&quot;</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">ValueError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">kind</span><span class="s3">=</span><span class="s4">&quot;invalid_plot_kind&quot;</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;x,y,lbl&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s3">([</span><span class="s4">&quot;B&quot;</span><span class="s3">, </span><span class="s4">&quot;C&quot;</span><span class="s3">], </span><span class="s4">&quot;A&quot;</span><span class="s3">, </span><span class="s4">&quot;a&quot;</span><span class="s3">),</span>
            <span class="s3">([</span><span class="s4">&quot;A&quot;</span><span class="s3">], [</span><span class="s4">&quot;B&quot;</span><span class="s3">, </span><span class="s4">&quot;C&quot;</span><span class="s3">], [</span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s4">&quot;c&quot;</span><span class="s3">]),</span>
        <span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_invalid_xy_args</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">x</span><span class="s3">, </span><span class="s1">y</span><span class="s3">, </span><span class="s1">lbl</span><span class="s3">):</span>
        <span class="s5"># GH 18671, 19699 allows y to be list-like but not x</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;A&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">], </span><span class="s4">&quot;B&quot;</span><span class="s3">: [</span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">], </span><span class="s4">&quot;C&quot;</span><span class="s3">: [</span><span class="s6">5</span><span class="s3">, </span><span class="s6">6</span><span class="s3">]})</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">ValueError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s4">&quot;x must be a label or position&quot;</span><span class="s3">):</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s1">x</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s1">y</span><span class="s3">, </span><span class="s1">label</span><span class="s3">=</span><span class="s1">lbl</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_bad_label</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;A&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">], </span><span class="s4">&quot;B&quot;</span><span class="s3">: [</span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">], </span><span class="s4">&quot;C&quot;</span><span class="s3">: [</span><span class="s6">5</span><span class="s3">, </span><span class="s6">6</span><span class="s3">]})</span>
        <span class="s1">msg </span><span class="s3">= </span><span class="s4">&quot;label should be list-like and same length as y&quot;</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">ValueError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s4">&quot;A&quot;</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=[</span><span class="s4">&quot;B&quot;</span><span class="s3">, </span><span class="s4">&quot;C&quot;</span><span class="s3">], </span><span class="s1">label</span><span class="s3">=</span><span class="s4">&quot;bad_label&quot;</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;x,y&quot;</span><span class="s3">, [(</span><span class="s4">&quot;A&quot;</span><span class="s3">, </span><span class="s4">&quot;B&quot;</span><span class="s3">), ([</span><span class="s4">&quot;A&quot;</span><span class="s3">], </span><span class="s4">&quot;B&quot;</span><span class="s3">)])</span>
    <span class="s2">def </span><span class="s1">test_invalid_xy_args_dup_cols</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">x</span><span class="s3">, </span><span class="s1">y</span><span class="s3">):</span>
        <span class="s5"># GH 18671, 19699 allows y to be list-like but not x</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">([[</span><span class="s6">1</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">5</span><span class="s3">], [</span><span class="s6">2</span><span class="s3">, </span><span class="s6">4</span><span class="s3">, </span><span class="s6">6</span><span class="s3">]], </span><span class="s1">columns</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s4">&quot;AAB&quot;</span><span class="s3">))</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">ValueError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s4">&quot;x must be a label or position&quot;</span><span class="s3">):</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s1">x</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s1">y</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;x,y,lbl,colors&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s3">(</span><span class="s4">&quot;A&quot;</span><span class="s3">, [</span><span class="s4">&quot;B&quot;</span><span class="s3">], [</span><span class="s4">&quot;b&quot;</span><span class="s3">], [</span><span class="s4">&quot;red&quot;</span><span class="s3">]),</span>
            <span class="s3">(</span><span class="s4">&quot;A&quot;</span><span class="s3">, [</span><span class="s4">&quot;B&quot;</span><span class="s3">, </span><span class="s4">&quot;C&quot;</span><span class="s3">], [</span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s4">&quot;c&quot;</span><span class="s3">], [</span><span class="s4">&quot;red&quot;</span><span class="s3">, </span><span class="s4">&quot;blue&quot;</span><span class="s3">]),</span>
            <span class="s3">(</span><span class="s6">0</span><span class="s3">, [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">], [</span><span class="s4">&quot;bokeh&quot;</span><span class="s3">, </span><span class="s4">&quot;cython&quot;</span><span class="s3">], [</span><span class="s4">&quot;green&quot;</span><span class="s3">, </span><span class="s4">&quot;yellow&quot;</span><span class="s3">]),</span>
        <span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_y_listlike</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">x</span><span class="s3">, </span><span class="s1">y</span><span class="s3">, </span><span class="s1">lbl</span><span class="s3">, </span><span class="s1">colors</span><span class="s3">):</span>
        <span class="s5"># GH 19699: tests list-like y and verifies lbls &amp; colors</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;A&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">], </span><span class="s4">&quot;B&quot;</span><span class="s3">: [</span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">], </span><span class="s4">&quot;C&quot;</span><span class="s3">: [</span><span class="s6">5</span><span class="s3">, </span><span class="s6">6</span><span class="s3">]})</span>
        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">x</span><span class="s3">=</span><span class="s4">&quot;A&quot;</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s1">y</span><span class="s3">, </span><span class="s1">label</span><span class="s3">=</span><span class="s1">lbl</span><span class="s3">)</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s1">x</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s1">y</span><span class="s3">, </span><span class="s1">label</span><span class="s3">=</span><span class="s1">lbl</span><span class="s3">, </span><span class="s1">color</span><span class="s3">=</span><span class="s1">colors</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">) == </span><span class="s1">len</span><span class="s3">(</span><span class="s1">y</span><span class="s3">)</span>
        <span class="s1">_check_colors</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_lines</span><span class="s3">(), </span><span class="s1">linecolors</span><span class="s3">=</span><span class="s1">colors</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;x,y,colnames&quot;</span><span class="s3">, [(</span><span class="s6">0</span><span class="s3">, </span><span class="s6">1</span><span class="s3">, [</span><span class="s4">&quot;A&quot;</span><span class="s3">, </span><span class="s4">&quot;B&quot;</span><span class="s3">]), (</span><span class="s6">1</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, [</span><span class="s6">0</span><span class="s3">, </span><span class="s6">1</span><span class="s3">])])</span>
    <span class="s2">def </span><span class="s1">test_xy_args_integer</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">x</span><span class="s3">, </span><span class="s1">y</span><span class="s3">, </span><span class="s1">colnames</span><span class="s3">):</span>
        <span class="s5"># GH 20056: tests integer args for xy and checks col names</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;A&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">], </span><span class="s4">&quot;B&quot;</span><span class="s3">: [</span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">]})</span>
        <span class="s1">df</span><span class="s3">.</span><span class="s1">columns </span><span class="s3">= </span><span class="s1">colnames</span>
        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">x</span><span class="s3">=</span><span class="s1">x</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s1">y</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_hexbin_basic</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s3">{</span>
                <span class="s4">&quot;A&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">uniform</span><span class="s3">(</span><span class="s1">size</span><span class="s3">=</span><span class="s6">20</span><span class="s3">),</span>
                <span class="s4">&quot;B&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">uniform</span><span class="s3">(</span><span class="s1">size</span><span class="s3">=</span><span class="s6">20</span><span class="s3">),</span>
                <span class="s4">&quot;C&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">20</span><span class="s3">) + </span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">uniform</span><span class="s3">(</span><span class="s1">size</span><span class="s3">=</span><span class="s6">20</span><span class="s3">),</span>
            <span class="s3">}</span>
        <span class="s3">)</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">hexbin</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s4">&quot;A&quot;</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s4">&quot;B&quot;</span><span class="s3">, </span><span class="s1">gridsize</span><span class="s3">=</span><span class="s6">10</span><span class="s3">)</span>
        <span class="s5"># TODO: need better way to test. This just does existence.</span>
        <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">collections</span><span class="s3">) == </span><span class="s6">1</span>

    <span class="s2">def </span><span class="s1">test_hexbin_basic_subplots</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s3">{</span>
                <span class="s4">&quot;A&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">uniform</span><span class="s3">(</span><span class="s1">size</span><span class="s3">=</span><span class="s6">20</span><span class="s3">),</span>
                <span class="s4">&quot;B&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">uniform</span><span class="s3">(</span><span class="s1">size</span><span class="s3">=</span><span class="s6">20</span><span class="s3">),</span>
                <span class="s4">&quot;C&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">20</span><span class="s3">) + </span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">uniform</span><span class="s3">(</span><span class="s1">size</span><span class="s3">=</span><span class="s6">20</span><span class="s3">),</span>
            <span class="s3">}</span>
        <span class="s3">)</span>
        <span class="s5"># GH 6951</span>
        <span class="s1">axes </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">hexbin</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s4">&quot;A&quot;</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s4">&quot;B&quot;</span><span class="s3">, </span><span class="s1">subplots</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s5"># hexbin should have 2 axes in the figure, 1 for plotting and another</span>
        <span class="s5"># is colorbar</span>
        <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">figure</span><span class="s3">.</span><span class="s1">axes</span><span class="s3">) == </span><span class="s6">2</span>
        <span class="s5"># return value is single axes</span>
        <span class="s1">_check_axes_shape</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">, </span><span class="s1">axes_num</span><span class="s3">=</span><span class="s6">1</span><span class="s3">, </span><span class="s1">layout</span><span class="s3">=(</span><span class="s6">1</span><span class="s3">, </span><span class="s6">1</span><span class="s3">))</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;reduce_C&quot;</span><span class="s3">, [</span><span class="s2">None</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">std</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_hexbin_with_c</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">reduce_C</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s3">{</span>
                <span class="s4">&quot;A&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">uniform</span><span class="s3">(</span><span class="s1">size</span><span class="s3">=</span><span class="s6">20</span><span class="s3">),</span>
                <span class="s4">&quot;B&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">uniform</span><span class="s3">(</span><span class="s1">size</span><span class="s3">=</span><span class="s6">20</span><span class="s3">),</span>
                <span class="s4">&quot;C&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">20</span><span class="s3">) + </span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">uniform</span><span class="s3">(</span><span class="s1">size</span><span class="s3">=</span><span class="s6">20</span><span class="s3">),</span>
            <span class="s3">}</span>
        <span class="s3">)</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">hexbin</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s4">&quot;A&quot;</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s4">&quot;B&quot;</span><span class="s3">, </span><span class="s1">C</span><span class="s3">=</span><span class="s4">&quot;C&quot;</span><span class="s3">, </span><span class="s1">reduce_C_function</span><span class="s3">=</span><span class="s1">reduce_C</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">collections</span><span class="s3">) == </span><span class="s6">1</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;kwargs, expected&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s3">({}, </span><span class="s4">&quot;BuGn&quot;</span><span class="s3">),  </span><span class="s5"># default cmap</span>
            <span class="s3">({</span><span class="s4">&quot;colormap&quot;</span><span class="s3">: </span><span class="s4">&quot;cubehelix&quot;</span><span class="s3">}, </span><span class="s4">&quot;cubehelix&quot;</span><span class="s3">),</span>
            <span class="s3">({</span><span class="s4">&quot;cmap&quot;</span><span class="s3">: </span><span class="s4">&quot;YlGn&quot;</span><span class="s3">}, </span><span class="s4">&quot;YlGn&quot;</span><span class="s3">),</span>
        <span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_hexbin_cmap</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">kwargs</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s3">{</span>
                <span class="s4">&quot;A&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">uniform</span><span class="s3">(</span><span class="s1">size</span><span class="s3">=</span><span class="s6">20</span><span class="s3">),</span>
                <span class="s4">&quot;B&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">uniform</span><span class="s3">(</span><span class="s1">size</span><span class="s3">=</span><span class="s6">20</span><span class="s3">),</span>
                <span class="s4">&quot;C&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">20</span><span class="s3">) + </span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">uniform</span><span class="s3">(</span><span class="s1">size</span><span class="s3">=</span><span class="s6">20</span><span class="s3">),</span>
            <span class="s3">}</span>
        <span class="s3">)</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">hexbin</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s4">&quot;A&quot;</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s4">&quot;B&quot;</span><span class="s3">, **</span><span class="s1">kwargs</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">collections</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">cmap</span><span class="s3">.</span><span class="s1">name </span><span class="s3">== </span><span class="s1">expected</span>

    <span class="s2">def </span><span class="s1">test_pie_df_err</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">((</span><span class="s6">5</span><span class="s3">, </span><span class="s6">3</span><span class="s3">)),</span>
            <span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;X&quot;</span><span class="s3">, </span><span class="s4">&quot;Y&quot;</span><span class="s3">, </span><span class="s4">&quot;Z&quot;</span><span class="s3">],</span>
            <span class="s1">index</span><span class="s3">=[</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s4">&quot;c&quot;</span><span class="s3">, </span><span class="s4">&quot;d&quot;</span><span class="s3">, </span><span class="s4">&quot;e&quot;</span><span class="s3">],</span>
        <span class="s3">)</span>
        <span class="s1">msg </span><span class="s3">= </span><span class="s4">&quot;pie requires either y column or 'subplots=True'&quot;</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">ValueError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">pie</span><span class="s3">()</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;y&quot;</span><span class="s3">, [</span><span class="s4">&quot;Y&quot;</span><span class="s3">, </span><span class="s6">2</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_pie_df</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">y</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">((</span><span class="s6">5</span><span class="s3">, </span><span class="s6">3</span><span class="s3">)),</span>
            <span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;X&quot;</span><span class="s3">, </span><span class="s4">&quot;Y&quot;</span><span class="s3">, </span><span class="s4">&quot;Z&quot;</span><span class="s3">],</span>
            <span class="s1">index</span><span class="s3">=[</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s4">&quot;c&quot;</span><span class="s3">, </span><span class="s4">&quot;d&quot;</span><span class="s3">, </span><span class="s4">&quot;e&quot;</span><span class="s3">],</span>
        <span class="s3">)</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">pie</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s1">y</span><span class="s3">)</span>
        <span class="s1">_check_text_labels</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">texts</span><span class="s3">, </span><span class="s1">df</span><span class="s3">.</span><span class="s1">index</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_pie_df_subplots</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">((</span><span class="s6">5</span><span class="s3">, </span><span class="s6">3</span><span class="s3">)),</span>
            <span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;X&quot;</span><span class="s3">, </span><span class="s4">&quot;Y&quot;</span><span class="s3">, </span><span class="s4">&quot;Z&quot;</span><span class="s3">],</span>
            <span class="s1">index</span><span class="s3">=[</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s4">&quot;c&quot;</span><span class="s3">, </span><span class="s4">&quot;d&quot;</span><span class="s3">, </span><span class="s4">&quot;e&quot;</span><span class="s3">],</span>
        <span class="s3">)</span>
        <span class="s1">axes </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">pie</span><span class="s3">,</span>
            <span class="s1">default_axes</span><span class="s3">=</span><span class="s2">True</span><span class="s3">,</span>
            <span class="s1">subplots</span><span class="s3">=</span><span class="s2">True</span><span class="s3">,</span>
        <span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">) == </span><span class="s1">len</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">columns</span><span class="s3">)</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes</span><span class="s3">:</span>
            <span class="s1">_check_text_labels</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">texts</span><span class="s3">, </span><span class="s1">df</span><span class="s3">.</span><span class="s1">index</span><span class="s3">)</span>
        <span class="s2">for </span><span class="s1">ax</span><span class="s3">, </span><span class="s1">ylabel </span><span class="s2">in </span><span class="s1">zip</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">, </span><span class="s1">df</span><span class="s3">.</span><span class="s1">columns</span><span class="s3">):</span>
            <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_ylabel</span><span class="s3">() == </span><span class="s1">ylabel</span>

    <span class="s2">def </span><span class="s1">test_pie_df_labels_colors</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">((</span><span class="s6">5</span><span class="s3">, </span><span class="s6">3</span><span class="s3">)),</span>
            <span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;X&quot;</span><span class="s3">, </span><span class="s4">&quot;Y&quot;</span><span class="s3">, </span><span class="s4">&quot;Z&quot;</span><span class="s3">],</span>
            <span class="s1">index</span><span class="s3">=[</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s4">&quot;c&quot;</span><span class="s3">, </span><span class="s4">&quot;d&quot;</span><span class="s3">, </span><span class="s4">&quot;e&quot;</span><span class="s3">],</span>
        <span class="s3">)</span>
        <span class="s1">labels </span><span class="s3">= [</span><span class="s4">&quot;A&quot;</span><span class="s3">, </span><span class="s4">&quot;B&quot;</span><span class="s3">, </span><span class="s4">&quot;C&quot;</span><span class="s3">, </span><span class="s4">&quot;D&quot;</span><span class="s3">, </span><span class="s4">&quot;E&quot;</span><span class="s3">]</span>
        <span class="s1">color_args </span><span class="s3">= [</span><span class="s4">&quot;r&quot;</span><span class="s3">, </span><span class="s4">&quot;g&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s4">&quot;c&quot;</span><span class="s3">, </span><span class="s4">&quot;m&quot;</span><span class="s3">]</span>
        <span class="s1">axes </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">pie</span><span class="s3">,</span>
            <span class="s1">default_axes</span><span class="s3">=</span><span class="s2">True</span><span class="s3">,</span>
            <span class="s1">subplots</span><span class="s3">=</span><span class="s2">True</span><span class="s3">,</span>
            <span class="s1">labels</span><span class="s3">=</span><span class="s1">labels</span><span class="s3">,</span>
            <span class="s1">colors</span><span class="s3">=</span><span class="s1">color_args</span><span class="s3">,</span>
        <span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">) == </span><span class="s1">len</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">columns</span><span class="s3">)</span>

        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes</span><span class="s3">:</span>
            <span class="s1">_check_text_labels</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">texts</span><span class="s3">, </span><span class="s1">labels</span><span class="s3">)</span>
            <span class="s1">_check_colors</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">, </span><span class="s1">facecolors</span><span class="s3">=</span><span class="s1">color_args</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_pie_df_nan</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">((</span><span class="s6">4</span><span class="s3">, </span><span class="s6">4</span><span class="s3">)))</span>
        <span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">range</span><span class="s3">(</span><span class="s6">4</span><span class="s3">):</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">iloc</span><span class="s3">[</span><span class="s1">i</span><span class="s3">, </span><span class="s1">i</span><span class="s3">] = </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">axes </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">(</span><span class="s1">ncols</span><span class="s3">=</span><span class="s6">4</span><span class="s3">)</span>

        <span class="s5"># GH 37668</span>
        <span class="s1">kwargs </span><span class="s3">= {</span><span class="s4">&quot;normalize&quot;</span><span class="s3">: </span><span class="s2">True</span><span class="s3">}</span>

        <span class="s2">with </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_produces_warning</span><span class="s3">(</span><span class="s2">None</span><span class="s3">):</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">pie</span><span class="s3">(</span><span class="s1">subplots</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">axes</span><span class="s3">, </span><span class="s1">legend</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, **</span><span class="s1">kwargs</span><span class="s3">)</span>

        <span class="s1">base_expected </span><span class="s3">= [</span><span class="s4">&quot;0&quot;</span><span class="s3">, </span><span class="s4">&quot;1&quot;</span><span class="s3">, </span><span class="s4">&quot;2&quot;</span><span class="s3">, </span><span class="s4">&quot;3&quot;</span><span class="s3">]</span>
        <span class="s2">for </span><span class="s1">i</span><span class="s3">, </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">enumerate</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">):</span>
            <span class="s1">expected </span><span class="s3">= </span><span class="s1">list</span><span class="s3">(</span><span class="s1">base_expected</span><span class="s3">)  </span><span class="s5"># force copy</span>
            <span class="s1">expected</span><span class="s3">[</span><span class="s1">i</span><span class="s3">] = </span><span class="s4">&quot;&quot;</span>
            <span class="s1">result </span><span class="s3">= [</span><span class="s1">x</span><span class="s3">.</span><span class="s1">get_text</span><span class="s3">() </span><span class="s2">for </span><span class="s1">x </span><span class="s2">in </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">texts</span><span class="s3">]</span>
            <span class="s2">assert </span><span class="s1">result </span><span class="s3">== </span><span class="s1">expected</span>

            <span class="s5"># legend labels</span>
            <span class="s5"># NaN's not included in legend with subplots</span>
            <span class="s5"># see https://github.com/pandas-dev/pandas/issues/8390</span>
            <span class="s1">result_labels </span><span class="s3">= [</span><span class="s1">x</span><span class="s3">.</span><span class="s1">get_text</span><span class="s3">() </span><span class="s2">for </span><span class="s1">x </span><span class="s2">in </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_legend</span><span class="s3">().</span><span class="s1">get_texts</span><span class="s3">()]</span>
            <span class="s1">expected_labels </span><span class="s3">= </span><span class="s1">base_expected</span><span class="s3">[:</span><span class="s1">i</span><span class="s3">] + </span><span class="s1">base_expected</span><span class="s3">[</span><span class="s1">i </span><span class="s3">+ </span><span class="s6">1 </span><span class="s3">:]</span>
            <span class="s2">assert </span><span class="s1">result_labels </span><span class="s3">== </span><span class="s1">expected_labels</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;kwargs&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s3">{</span><span class="s4">&quot;logy&quot;</span><span class="s3">: </span><span class="s2">True</span><span class="s3">},</span>
            <span class="s3">{</span><span class="s4">&quot;logx&quot;</span><span class="s3">: </span><span class="s2">True</span><span class="s3">, </span><span class="s4">&quot;logy&quot;</span><span class="s3">: </span><span class="s2">True</span><span class="s3">},</span>
            <span class="s3">{</span><span class="s4">&quot;loglog&quot;</span><span class="s3">: </span><span class="s2">True</span><span class="s3">},</span>
        <span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_errorbar_plot</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">kwargs</span><span class="s3">):</span>
        <span class="s1">d </span><span class="s3">= {</span><span class="s4">&quot;x&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">12</span><span class="s3">), </span><span class="s4">&quot;y&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">12</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, -</span><span class="s6">1</span><span class="s3">)}</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">d</span><span class="s3">)</span>
        <span class="s1">d_err </span><span class="s3">= {</span><span class="s4">&quot;x&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">ones</span><span class="s3">(</span><span class="s6">12</span><span class="s3">) * </span><span class="s6">0.2</span><span class="s3">, </span><span class="s4">&quot;y&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">ones</span><span class="s3">(</span><span class="s6">12</span><span class="s3">) * </span><span class="s6">0.4</span><span class="s3">}</span>
        <span class="s1">df_err </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">d_err</span><span class="s3">)</span>

        <span class="s5"># check line plots</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s1">df_err</span><span class="s3">, **</span><span class="s1">kwargs</span><span class="s3">)</span>
        <span class="s1">_check_has_errorbars</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s6">0</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s6">2</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s2">def </span><span class="s1">test_errorbar_plot_bar</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">d </span><span class="s3">= {</span><span class="s4">&quot;x&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">12</span><span class="s3">), </span><span class="s4">&quot;y&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">12</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, -</span><span class="s6">1</span><span class="s3">)}</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">d</span><span class="s3">)</span>
        <span class="s1">d_err </span><span class="s3">= {</span><span class="s4">&quot;x&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">ones</span><span class="s3">(</span><span class="s6">12</span><span class="s3">) * </span><span class="s6">0.2</span><span class="s3">, </span><span class="s4">&quot;y&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">ones</span><span class="s3">(</span><span class="s6">12</span><span class="s3">) * </span><span class="s6">0.4</span><span class="s3">}</span>
        <span class="s1">df_err </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">d_err</span><span class="s3">)</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span>
            <span class="s3">(</span><span class="s1">df </span><span class="s3">+ </span><span class="s6">1</span><span class="s3">).</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s1">df_err</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s1">df_err</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">=</span><span class="s4">&quot;bar&quot;</span><span class="s3">, </span><span class="s1">log</span><span class="s3">=</span><span class="s2">True</span>
        <span class="s3">)</span>
        <span class="s1">_check_has_errorbars</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s6">2</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s6">2</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s2">def </span><span class="s1">test_errorbar_plot_yerr_array</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">d </span><span class="s3">= {</span><span class="s4">&quot;x&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">12</span><span class="s3">), </span><span class="s4">&quot;y&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">12</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, -</span><span class="s6">1</span><span class="s3">)}</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">d</span><span class="s3">)</span>
        <span class="s5"># yerr is raw error values</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">[</span><span class="s4">&quot;y&quot;</span><span class="s3">].</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">ones</span><span class="s3">(</span><span class="s6">12</span><span class="s3">) * </span><span class="s6">0.4</span><span class="s3">)</span>
        <span class="s1">_check_has_errorbars</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s6">0</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s6">1</span><span class="s3">)</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">ones</span><span class="s3">((</span><span class="s6">2</span><span class="s3">, </span><span class="s6">12</span><span class="s3">)) * </span><span class="s6">0.4</span><span class="s3">)</span>
        <span class="s1">_check_has_errorbars</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s6">0</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s6">2</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;yerr&quot;</span><span class="s3">, [</span><span class="s4">&quot;yerr&quot;</span><span class="s3">, </span><span class="s4">&quot;誤差&quot;</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_errorbar_plot_column_name</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">):</span>
        <span class="s1">d </span><span class="s3">= {</span><span class="s4">&quot;x&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">12</span><span class="s3">), </span><span class="s4">&quot;y&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">12</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, -</span><span class="s6">1</span><span class="s3">)}</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">d</span><span class="s3">)</span>
        <span class="s1">df</span><span class="s3">[</span><span class="s1">yerr</span><span class="s3">] = </span><span class="s1">np</span><span class="s3">.</span><span class="s1">ones</span><span class="s3">(</span><span class="s6">12</span><span class="s3">) * </span><span class="s6">0.2</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s1">yerr</span><span class="s3">)</span>
        <span class="s1">_check_has_errorbars</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s6">0</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s6">2</span><span class="s3">)</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s4">&quot;y&quot;</span><span class="s3">, </span><span class="s1">x</span><span class="s3">=</span><span class="s4">&quot;x&quot;</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s1">yerr</span><span class="s3">)</span>
        <span class="s1">_check_has_errorbars</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s6">0</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s6">1</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s2">def </span><span class="s1">test_errorbar_plot_external_valueerror</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">d </span><span class="s3">= {</span><span class="s4">&quot;x&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">12</span><span class="s3">), </span><span class="s4">&quot;y&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">12</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, -</span><span class="s6">1</span><span class="s3">)}</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">d</span><span class="s3">)</span>
        <span class="s2">with </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">external_error_raised</span><span class="s3">(</span><span class="s1">ValueError</span><span class="s3">):</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">yerr</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">(</span><span class="s6">11</span><span class="s3">))</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s2">def </span><span class="s1">test_errorbar_plot_external_typeerror</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">d </span><span class="s3">= {</span><span class="s4">&quot;x&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">12</span><span class="s3">), </span><span class="s4">&quot;y&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">12</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, -</span><span class="s6">1</span><span class="s3">)}</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">d</span><span class="s3">)</span>
        <span class="s1">df_err </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;x&quot;</span><span class="s3">: [</span><span class="s4">&quot;zzz&quot;</span><span class="s3">] * </span><span class="s6">12</span><span class="s3">, </span><span class="s4">&quot;y&quot;</span><span class="s3">: [</span><span class="s4">&quot;zzz&quot;</span><span class="s3">] * </span><span class="s6">12</span><span class="s3">})</span>
        <span class="s2">with </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">external_error_raised</span><span class="s3">(</span><span class="s1">TypeError</span><span class="s3">):</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">yerr</span><span class="s3">=</span><span class="s1">df_err</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;kind&quot;</span><span class="s3">, [</span><span class="s4">&quot;line&quot;</span><span class="s3">, </span><span class="s4">&quot;bar&quot;</span><span class="s3">, </span><span class="s4">&quot;barh&quot;</span><span class="s3">])</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;y_err&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">ones</span><span class="s3">(</span><span class="s6">12</span><span class="s3">) * </span><span class="s6">0.2</span><span class="s3">, </span><span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;x&quot;</span><span class="s3">),</span>
            <span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;x&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">ones</span><span class="s3">(</span><span class="s6">12</span><span class="s3">) * </span><span class="s6">0.2</span><span class="s3">, </span><span class="s4">&quot;y&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">ones</span><span class="s3">(</span><span class="s6">12</span><span class="s3">) * </span><span class="s6">0.4</span><span class="s3">}),</span>
        <span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_errorbar_plot_different_yerr</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">, </span><span class="s1">y_err</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;x&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">12</span><span class="s3">), </span><span class="s4">&quot;y&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">12</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, -</span><span class="s6">1</span><span class="s3">)})</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s1">y_err</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">)</span>
        <span class="s1">_check_has_errorbars</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s6">0</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s6">2</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;kind&quot;</span><span class="s3">, [</span><span class="s4">&quot;line&quot;</span><span class="s3">, </span><span class="s4">&quot;bar&quot;</span><span class="s3">, </span><span class="s4">&quot;barh&quot;</span><span class="s3">])</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;y_err, x_err&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s3">(</span>
                <span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;x&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">ones</span><span class="s3">(</span><span class="s6">12</span><span class="s3">) * </span><span class="s6">0.2</span><span class="s3">, </span><span class="s4">&quot;y&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">ones</span><span class="s3">(</span><span class="s6">12</span><span class="s3">) * </span><span class="s6">0.4</span><span class="s3">}),</span>
                <span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;x&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">ones</span><span class="s3">(</span><span class="s6">12</span><span class="s3">) * </span><span class="s6">0.2</span><span class="s3">, </span><span class="s4">&quot;y&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">ones</span><span class="s3">(</span><span class="s6">12</span><span class="s3">) * </span><span class="s6">0.4</span><span class="s3">}),</span>
            <span class="s3">),</span>
            <span class="s3">(</span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">ones</span><span class="s3">(</span><span class="s6">12</span><span class="s3">) * </span><span class="s6">0.2</span><span class="s3">, </span><span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;x&quot;</span><span class="s3">), </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">ones</span><span class="s3">(</span><span class="s6">12</span><span class="s3">) * </span><span class="s6">0.2</span><span class="s3">, </span><span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;x&quot;</span><span class="s3">)),</span>
            <span class="s3">(</span><span class="s6">0.2</span><span class="s3">, </span><span class="s6">0.2</span><span class="s3">),</span>
        <span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_errorbar_plot_different_yerr_xerr</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">, </span><span class="s1">y_err</span><span class="s3">, </span><span class="s1">x_err</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;x&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">12</span><span class="s3">), </span><span class="s4">&quot;y&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">12</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, -</span><span class="s6">1</span><span class="s3">)})</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s1">y_err</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s1">x_err</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">)</span>
        <span class="s1">_check_has_errorbars</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s6">2</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s6">2</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;kind&quot;</span><span class="s3">, [</span><span class="s4">&quot;line&quot;</span><span class="s3">, </span><span class="s4">&quot;bar&quot;</span><span class="s3">, </span><span class="s4">&quot;barh&quot;</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_errorbar_plot_different_yerr_xerr_subplots</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;x&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">12</span><span class="s3">), </span><span class="s4">&quot;y&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">12</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, -</span><span class="s6">1</span><span class="s3">)})</span>
        <span class="s1">df_err </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;x&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">ones</span><span class="s3">(</span><span class="s6">12</span><span class="s3">) * </span><span class="s6">0.2</span><span class="s3">, </span><span class="s4">&quot;y&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">ones</span><span class="s3">(</span><span class="s6">12</span><span class="s3">) * </span><span class="s6">0.4</span><span class="s3">})</span>
        <span class="s1">axes </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">,</span>
            <span class="s1">default_axes</span><span class="s3">=</span><span class="s2">True</span><span class="s3">,</span>
            <span class="s1">yerr</span><span class="s3">=</span><span class="s1">df_err</span><span class="s3">,</span>
            <span class="s1">xerr</span><span class="s3">=</span><span class="s1">df_err</span><span class="s3">,</span>
            <span class="s1">subplots</span><span class="s3">=</span><span class="s2">True</span><span class="s3">,</span>
            <span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">,</span>
        <span class="s3">)</span>
        <span class="s1">_check_has_errorbars</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s6">1</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s6">1</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">xfail</span><span class="s3">(</span><span class="s1">reason</span><span class="s3">=</span><span class="s4">&quot;Iterator is consumed&quot;</span><span class="s3">, </span><span class="s1">raises</span><span class="s3">=</span><span class="s1">ValueError</span><span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_errorbar_plot_iterator</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">d </span><span class="s3">= {</span><span class="s4">&quot;x&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">12</span><span class="s3">), </span><span class="s4">&quot;y&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">12</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, -</span><span class="s6">1</span><span class="s3">)}</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">d</span><span class="s3">)</span>

        <span class="s5"># yerr is iterator</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s1">itertools</span><span class="s3">.</span><span class="s1">repeat</span><span class="s3">(</span><span class="s6">0.1</span><span class="s3">, </span><span class="s1">len</span><span class="s3">(</span><span class="s1">df</span><span class="s3">)))</span>
        <span class="s1">_check_has_errorbars</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s6">0</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s6">2</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_errorbar_with_integer_column_names</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s5"># test with integer column names</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">abs</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">10</span><span class="s3">, </span><span class="s6">2</span><span class="s3">))))</span>
        <span class="s1">df_err </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">abs</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">10</span><span class="s3">, </span><span class="s6">2</span><span class="s3">))))</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s1">df_err</span><span class="s3">)</span>
        <span class="s1">_check_has_errorbars</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s6">0</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s6">2</span><span class="s3">)</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s6">0</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s6">1</span><span class="s3">)</span>
        <span class="s1">_check_has_errorbars</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s6">0</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s6">1</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;kind&quot;</span><span class="s3">, [</span><span class="s4">&quot;line&quot;</span><span class="s3">, </span><span class="s4">&quot;bar&quot;</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_errorbar_with_partial_columns_kind</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">abs</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">10</span><span class="s3">, </span><span class="s6">3</span><span class="s3">))))</span>
        <span class="s1">df_err </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">abs</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">10</span><span class="s3">, </span><span class="s6">2</span><span class="s3">))), </span><span class="s1">columns</span><span class="s3">=[</span><span class="s6">0</span><span class="s3">, </span><span class="s6">2</span><span class="s3">]</span>
        <span class="s3">)</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s1">df_err</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">)</span>
        <span class="s1">_check_has_errorbars</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s6">0</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s6">2</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s2">def </span><span class="s1">test_errorbar_with_partial_columns_dti</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">abs</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">10</span><span class="s3">, </span><span class="s6">3</span><span class="s3">))))</span>
        <span class="s1">df_err </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">abs</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">10</span><span class="s3">, </span><span class="s6">2</span><span class="s3">))), </span><span class="s1">columns</span><span class="s3">=[</span><span class="s6">0</span><span class="s3">, </span><span class="s6">2</span><span class="s3">]</span>
        <span class="s3">)</span>
        <span class="s1">ix </span><span class="s3">= </span><span class="s1">date_range</span><span class="s3">(</span><span class="s4">&quot;1/1/2000&quot;</span><span class="s3">, </span><span class="s1">periods</span><span class="s3">=</span><span class="s6">10</span><span class="s3">, </span><span class="s1">freq</span><span class="s3">=</span><span class="s4">&quot;M&quot;</span><span class="s3">)</span>
        <span class="s1">df</span><span class="s3">.</span><span class="s1">set_index</span><span class="s3">(</span><span class="s1">ix</span><span class="s3">, </span><span class="s1">inplace</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s1">df_err</span><span class="s3">.</span><span class="s1">set_index</span><span class="s3">(</span><span class="s1">ix</span><span class="s3">, </span><span class="s1">inplace</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s1">df_err</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">=</span><span class="s4">&quot;line&quot;</span><span class="s3">)</span>
        <span class="s1">_check_has_errorbars</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s6">0</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s6">2</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;err_box&quot;</span><span class="s3">, [</span><span class="s2">lambda </span><span class="s1">x</span><span class="s3">: </span><span class="s1">x</span><span class="s3">, </span><span class="s1">DataFrame</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_errorbar_with_partial_columns_box</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">err_box</span><span class="s3">):</span>
        <span class="s1">d </span><span class="s3">= {</span><span class="s4">&quot;x&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">12</span><span class="s3">), </span><span class="s4">&quot;y&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">12</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, -</span><span class="s6">1</span><span class="s3">)}</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">d</span><span class="s3">)</span>
        <span class="s1">err </span><span class="s3">= </span><span class="s1">err_box</span><span class="s3">({</span><span class="s4">&quot;x&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">ones</span><span class="s3">(</span><span class="s6">12</span><span class="s3">) * </span><span class="s6">0.2</span><span class="s3">, </span><span class="s4">&quot;z&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">ones</span><span class="s3">(</span><span class="s6">12</span><span class="s3">) * </span><span class="s6">0.4</span><span class="s3">})</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s1">err</span><span class="s3">)</span>
        <span class="s1">_check_has_errorbars</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s6">0</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s6">1</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;kind&quot;</span><span class="s3">, [</span><span class="s4">&quot;line&quot;</span><span class="s3">, </span><span class="s4">&quot;bar&quot;</span><span class="s3">, </span><span class="s4">&quot;barh&quot;</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_errorbar_timeseries</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">):</span>
        <span class="s1">d </span><span class="s3">= {</span><span class="s4">&quot;x&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">12</span><span class="s3">), </span><span class="s4">&quot;y&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">12</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, -</span><span class="s6">1</span><span class="s3">)}</span>
        <span class="s1">d_err </span><span class="s3">= {</span><span class="s4">&quot;x&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">ones</span><span class="s3">(</span><span class="s6">12</span><span class="s3">) * </span><span class="s6">0.2</span><span class="s3">, </span><span class="s4">&quot;y&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">ones</span><span class="s3">(</span><span class="s6">12</span><span class="s3">) * </span><span class="s6">0.4</span><span class="s3">}</span>

        <span class="s5"># check time-series plots</span>
        <span class="s1">ix </span><span class="s3">= </span><span class="s1">date_range</span><span class="s3">(</span><span class="s4">&quot;1/1/2000&quot;</span><span class="s3">, </span><span class="s4">&quot;1/1/2001&quot;</span><span class="s3">, </span><span class="s1">freq</span><span class="s3">=</span><span class="s4">&quot;M&quot;</span><span class="s3">)</span>
        <span class="s1">tdf </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">d</span><span class="s3">, </span><span class="s1">index</span><span class="s3">=</span><span class="s1">ix</span><span class="s3">)</span>
        <span class="s1">tdf_err </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">d_err</span><span class="s3">, </span><span class="s1">index</span><span class="s3">=</span><span class="s1">ix</span><span class="s3">)</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">tdf</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s1">tdf_err</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">)</span>
        <span class="s1">_check_has_errorbars</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s6">0</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s6">2</span><span class="s3">)</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">tdf</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s1">d_err</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">)</span>
        <span class="s1">_check_has_errorbars</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s6">0</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s6">2</span><span class="s3">)</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">tdf</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s4">&quot;y&quot;</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s1">tdf_err</span><span class="s3">[</span><span class="s4">&quot;x&quot;</span><span class="s3">], </span><span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">)</span>
        <span class="s1">_check_has_errorbars</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s6">0</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s6">1</span><span class="s3">)</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">tdf</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s4">&quot;y&quot;</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s4">&quot;x&quot;</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">)</span>
        <span class="s1">_check_has_errorbars</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s6">0</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s6">1</span><span class="s3">)</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">tdf</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s1">tdf_err</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">)</span>
        <span class="s1">_check_has_errorbars</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s6">0</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s6">2</span><span class="s3">)</span>

        <span class="s1">axes </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span>
            <span class="s1">tdf</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">,</span>
            <span class="s1">default_axes</span><span class="s3">=</span><span class="s2">True</span><span class="s3">,</span>
            <span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">,</span>
            <span class="s1">yerr</span><span class="s3">=</span><span class="s1">tdf_err</span><span class="s3">,</span>
            <span class="s1">subplots</span><span class="s3">=</span><span class="s2">True</span><span class="s3">,</span>
        <span class="s3">)</span>
        <span class="s1">_check_has_errorbars</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s6">0</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s6">1</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_errorbar_asymmetrical</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">err </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">((</span><span class="s6">3</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">5</span><span class="s3">))</span>

        <span class="s5"># each column is [0, 1, 2, 3, 4], [3, 4, 5, 6, 7]...</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">15</span><span class="s3">).</span><span class="s1">reshape</span><span class="s3">(</span><span class="s6">3</span><span class="s3">, </span><span class="s6">5</span><span class="s3">)).</span><span class="s1">T</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">yerr</span><span class="s3">=</span><span class="s1">err</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s1">err </span><span class="s3">/ </span><span class="s6">2</span><span class="s3">)</span>

        <span class="s1">yerr_0_0 </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">collections</span><span class="s3">[</span><span class="s6">1</span><span class="s3">].</span><span class="s1">get_paths</span><span class="s3">()[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">vertices</span><span class="s3">[:, </span><span class="s6">1</span><span class="s3">]</span>
        <span class="s1">expected_0_0 </span><span class="s3">= </span><span class="s1">err</span><span class="s3">[</span><span class="s6">0</span><span class="s3">, :, </span><span class="s6">0</span><span class="s3">] * </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([-</span><span class="s6">1</span><span class="s3">, </span><span class="s6">1</span><span class="s3">])</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_almost_equal</span><span class="s3">(</span><span class="s1">yerr_0_0</span><span class="s3">, </span><span class="s1">expected_0_0</span><span class="s3">)</span>

        <span class="s1">msg </span><span class="s3">= </span><span class="s1">re</span><span class="s3">.</span><span class="s1">escape</span><span class="s3">(</span>
            <span class="s4">&quot;Asymmetrical error bars should be provided with the shape (3, 2, 5)&quot;</span>
        <span class="s3">)</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">ValueError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">yerr</span><span class="s3">=</span><span class="s1">err</span><span class="s3">.</span><span class="s1">T</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_table</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">((</span><span class="s6">10</span><span class="s3">, </span><span class="s6">3</span><span class="s3">)),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s1">string</span><span class="s3">.</span><span class="s1">ascii_letters</span><span class="s3">[:</span><span class="s6">10</span><span class="s3">]),</span>
        <span class="s3">)</span>
        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">table</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">table</span><span class="s3">=</span><span class="s1">df</span><span class="s3">)</span>

        <span class="s5"># GH 35945 UserWarning</span>
        <span class="s2">with </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_produces_warning</span><span class="s3">(</span><span class="s2">None</span><span class="s3">):</span>
            <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">()</span>
            <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">tables</span><span class="s3">) == </span><span class="s6">0</span>
            <span class="s1">plotting</span><span class="s3">.</span><span class="s1">table</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">df</span><span class="s3">.</span><span class="s1">T</span><span class="s3">)</span>
            <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">tables</span><span class="s3">) == </span><span class="s6">1</span>

    <span class="s2">def </span><span class="s1">test_errorbar_scatter</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">abs</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">5</span><span class="s3">, </span><span class="s6">2</span><span class="s3">))),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">range</span><span class="s3">(</span><span class="s6">5</span><span class="s3">),</span>
            <span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;x&quot;</span><span class="s3">, </span><span class="s4">&quot;y&quot;</span><span class="s3">],</span>
        <span class="s3">)</span>
        <span class="s1">df_err </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">abs</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">5</span><span class="s3">, </span><span class="s6">2</span><span class="s3">))) / </span><span class="s6">5</span><span class="s3">,</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">range</span><span class="s3">(</span><span class="s6">5</span><span class="s3">),</span>
            <span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;x&quot;</span><span class="s3">, </span><span class="s4">&quot;y&quot;</span><span class="s3">],</span>
        <span class="s3">)</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">scatter</span><span class="s3">, </span><span class="s1">x</span><span class="s3">=</span><span class="s4">&quot;x&quot;</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s4">&quot;y&quot;</span><span class="s3">)</span>
        <span class="s1">_check_has_errorbars</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s6">0</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s6">0</span><span class="s3">)</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">scatter</span><span class="s3">, </span><span class="s1">x</span><span class="s3">=</span><span class="s4">&quot;x&quot;</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s4">&quot;y&quot;</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s1">df_err</span><span class="s3">)</span>
        <span class="s1">_check_has_errorbars</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s6">1</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s6">0</span><span class="s3">)</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">scatter</span><span class="s3">, </span><span class="s1">x</span><span class="s3">=</span><span class="s4">&quot;x&quot;</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s4">&quot;y&quot;</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s1">df_err</span><span class="s3">)</span>
        <span class="s1">_check_has_errorbars</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s6">0</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s6">1</span><span class="s3">)</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">scatter</span><span class="s3">, </span><span class="s1">x</span><span class="s3">=</span><span class="s4">&quot;x&quot;</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s4">&quot;y&quot;</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s1">df_err</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s1">df_err</span><span class="s3">)</span>
        <span class="s1">_check_has_errorbars</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s6">1</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s6">1</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_errorbar_scatter_color</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s2">def </span><span class="s1">_check_errorbar_color</span><span class="s3">(</span><span class="s1">containers</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">, </span><span class="s1">has_err</span><span class="s3">=</span><span class="s4">&quot;has_xerr&quot;</span><span class="s3">):</span>
            <span class="s1">lines </span><span class="s3">= []</span>
            <span class="s1">errs </span><span class="s3">= </span><span class="s1">next</span><span class="s3">(</span><span class="s1">c</span><span class="s3">.</span><span class="s1">lines </span><span class="s2">for </span><span class="s1">c </span><span class="s2">in </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">containers </span><span class="s2">if </span><span class="s1">getattr</span><span class="s3">(</span><span class="s1">c</span><span class="s3">, </span><span class="s1">has_err</span><span class="s3">, </span><span class="s2">False</span><span class="s3">))</span>
            <span class="s2">for </span><span class="s1">el </span><span class="s2">in </span><span class="s1">errs</span><span class="s3">:</span>
                <span class="s2">if </span><span class="s1">is_list_like</span><span class="s3">(</span><span class="s1">el</span><span class="s3">):</span>
                    <span class="s1">lines</span><span class="s3">.</span><span class="s1">extend</span><span class="s3">(</span><span class="s1">el</span><span class="s3">)</span>
                <span class="s2">else</span><span class="s3">:</span>
                    <span class="s1">lines</span><span class="s3">.</span><span class="s1">append</span><span class="s3">(</span><span class="s1">el</span><span class="s3">)</span>
            <span class="s1">err_lines </span><span class="s3">= [</span><span class="s1">x </span><span class="s2">for </span><span class="s1">x </span><span class="s2">in </span><span class="s1">lines </span><span class="s2">if </span><span class="s1">x </span><span class="s2">in </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">collections</span><span class="s3">]</span>
            <span class="s1">_check_colors</span><span class="s3">(</span><span class="s1">err_lines</span><span class="s3">, </span><span class="s1">linecolors</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s1">expected</span><span class="s3">] * </span><span class="s1">len</span><span class="s3">(</span><span class="s1">err_lines</span><span class="s3">)))</span>

        <span class="s5"># GH 8081</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">abs</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">10</span><span class="s3">, </span><span class="s6">5</span><span class="s3">))),</span>
            <span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s4">&quot;c&quot;</span><span class="s3">, </span><span class="s4">&quot;d&quot;</span><span class="s3">, </span><span class="s4">&quot;e&quot;</span><span class="s3">],</span>
        <span class="s3">)</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">scatter</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s4">&quot;d&quot;</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s4">&quot;e&quot;</span><span class="s3">, </span><span class="s1">c</span><span class="s3">=</span><span class="s4">&quot;red&quot;</span><span class="s3">)</span>
        <span class="s1">_check_has_errorbars</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s6">1</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s6">1</span><span class="s3">)</span>
        <span class="s1">_check_errorbar_color</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">containers</span><span class="s3">, </span><span class="s4">&quot;red&quot;</span><span class="s3">, </span><span class="s1">has_err</span><span class="s3">=</span><span class="s4">&quot;has_xerr&quot;</span><span class="s3">)</span>
        <span class="s1">_check_errorbar_color</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">containers</span><span class="s3">, </span><span class="s4">&quot;red&quot;</span><span class="s3">, </span><span class="s1">has_err</span><span class="s3">=</span><span class="s4">&quot;has_yerr&quot;</span><span class="s3">)</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">scatter</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s4">&quot;e&quot;</span><span class="s3">, </span><span class="s1">color</span><span class="s3">=</span><span class="s4">&quot;green&quot;</span><span class="s3">)</span>
        <span class="s1">_check_has_errorbars</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s6">0</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s6">1</span><span class="s3">)</span>
        <span class="s1">_check_errorbar_color</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">containers</span><span class="s3">, </span><span class="s4">&quot;green&quot;</span><span class="s3">, </span><span class="s1">has_err</span><span class="s3">=</span><span class="s4">&quot;has_yerr&quot;</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_scatter_unknown_colormap</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s5"># GH#48726</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;a&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">], </span><span class="s4">&quot;b&quot;</span><span class="s3">: </span><span class="s6">4</span><span class="s3">})</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">((</span><span class="s1">ValueError</span><span class="s3">, </span><span class="s1">KeyError</span><span class="s3">), </span><span class="s1">match</span><span class="s3">=</span><span class="s4">&quot;'unknown' is not a&quot;</span><span class="s3">):</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s1">colormap</span><span class="s3">=</span><span class="s4">&quot;unknown&quot;</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">=</span><span class="s4">&quot;scatter&quot;</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_sharex_and_ax</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s5"># https://github.com/pandas-dev/pandas/issues/9737 using gridspec,</span>
        <span class="s5"># the axis in fig.get_axis() are sorted differently than pandas</span>
        <span class="s5"># expected them, so make sure that only the right ones are removed</span>
        <span class="s2">import </span><span class="s1">matplotlib</span><span class="s3">.</span><span class="s1">pyplot </span><span class="s2">as </span><span class="s1">plt</span>

        <span class="s1">plt</span><span class="s3">.</span><span class="s1">close</span><span class="s3">(</span><span class="s4">&quot;all&quot;</span><span class="s3">)</span>
        <span class="s1">gs</span><span class="s3">, </span><span class="s1">axes </span><span class="s3">= </span><span class="s1">_generate_4_axes_via_gridspec</span><span class="s3">()</span>

        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s3">{</span>
                <span class="s4">&quot;a&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">, </span><span class="s6">5</span><span class="s3">, </span><span class="s6">6</span><span class="s3">],</span>
                <span class="s4">&quot;b&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">, </span><span class="s6">5</span><span class="s3">, </span><span class="s6">6</span><span class="s3">],</span>
                <span class="s4">&quot;c&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">, </span><span class="s6">5</span><span class="s3">, </span><span class="s6">6</span><span class="s3">],</span>
                <span class="s4">&quot;d&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">, </span><span class="s6">5</span><span class="s3">, </span><span class="s6">6</span><span class="s3">],</span>
            <span class="s3">}</span>
        <span class="s3">)</span>

        <span class="s2">def </span><span class="s1">_check</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">):</span>
            <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes</span><span class="s3">:</span>
                <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">) == </span><span class="s6">1</span>
                <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_yticklabels</span><span class="s3">(), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
            <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s3">[</span><span class="s1">axes</span><span class="s3">[</span><span class="s6">0</span><span class="s3">], </span><span class="s1">axes</span><span class="s3">[</span><span class="s6">2</span><span class="s3">]]:</span>
                <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticklabels</span><span class="s3">(), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>
                <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticklabels</span><span class="s3">(</span><span class="s1">minor</span><span class="s3">=</span><span class="s2">True</span><span class="s3">), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>
            <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s3">[</span><span class="s1">axes</span><span class="s3">[</span><span class="s6">1</span><span class="s3">], </span><span class="s1">axes</span><span class="s3">[</span><span class="s6">3</span><span class="s3">]]:</span>
                <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticklabels</span><span class="s3">(), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
                <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticklabels</span><span class="s3">(</span><span class="s1">minor</span><span class="s3">=</span><span class="s2">True</span><span class="s3">), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>

        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes</span><span class="s3">:</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s1">title</span><span class="s3">=</span><span class="s4">&quot;title&quot;</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">sharex</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s1">gs</span><span class="s3">.</span><span class="s1">tight_layout</span><span class="s3">(</span><span class="s1">plt</span><span class="s3">.</span><span class="s1">gcf</span><span class="s3">())</span>
        <span class="s1">_check</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">)</span>
        <span class="s1">plt</span><span class="s3">.</span><span class="s1">close</span><span class="s3">(</span><span class="s4">&quot;all&quot;</span><span class="s3">)</span>

        <span class="s1">gs</span><span class="s3">, </span><span class="s1">axes </span><span class="s3">= </span><span class="s1">_generate_4_axes_via_gridspec</span><span class="s3">()</span>
        <span class="s2">with </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_produces_warning</span><span class="s3">(</span><span class="s1">UserWarning</span><span class="s3">):</span>
            <span class="s1">axes </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">subplots</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">axes</span><span class="s3">, </span><span class="s1">sharex</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s1">_check</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_sharex_false_and_ax</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s5"># https://github.com/pandas-dev/pandas/issues/9737 using gridspec,</span>
        <span class="s5"># the axis in fig.get_axis() are sorted differently than pandas</span>
        <span class="s5"># expected them, so make sure that only the right ones are removed</span>
        <span class="s2">import </span><span class="s1">matplotlib</span><span class="s3">.</span><span class="s1">pyplot </span><span class="s2">as </span><span class="s1">plt</span>

        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s3">{</span>
                <span class="s4">&quot;a&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">, </span><span class="s6">5</span><span class="s3">, </span><span class="s6">6</span><span class="s3">],</span>
                <span class="s4">&quot;b&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">, </span><span class="s6">5</span><span class="s3">, </span><span class="s6">6</span><span class="s3">],</span>
                <span class="s4">&quot;c&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">, </span><span class="s6">5</span><span class="s3">, </span><span class="s6">6</span><span class="s3">],</span>
                <span class="s4">&quot;d&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">, </span><span class="s6">5</span><span class="s3">, </span><span class="s6">6</span><span class="s3">],</span>
            <span class="s3">}</span>
        <span class="s3">)</span>
        <span class="s1">gs</span><span class="s3">, </span><span class="s1">axes </span><span class="s3">= </span><span class="s1">_generate_4_axes_via_gridspec</span><span class="s3">()</span>
        <span class="s5"># without sharex, no labels should be touched!</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes</span><span class="s3">:</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s1">title</span><span class="s3">=</span><span class="s4">&quot;title&quot;</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>

        <span class="s1">gs</span><span class="s3">.</span><span class="s1">tight_layout</span><span class="s3">(</span><span class="s1">plt</span><span class="s3">.</span><span class="s1">gcf</span><span class="s3">())</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes</span><span class="s3">:</span>
            <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">) == </span><span class="s6">1</span>
            <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_yticklabels</span><span class="s3">(), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
            <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticklabels</span><span class="s3">(), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
            <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticklabels</span><span class="s3">(</span><span class="s1">minor</span><span class="s3">=</span><span class="s2">True</span><span class="s3">), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_sharey_and_ax</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s5"># https://github.com/pandas-dev/pandas/issues/9737 using gridspec,</span>
        <span class="s5"># the axis in fig.get_axis() are sorted differently than pandas</span>
        <span class="s5"># expected them, so make sure that only the right ones are removed</span>
        <span class="s2">import </span><span class="s1">matplotlib</span><span class="s3">.</span><span class="s1">pyplot </span><span class="s2">as </span><span class="s1">plt</span>

        <span class="s1">gs</span><span class="s3">, </span><span class="s1">axes </span><span class="s3">= </span><span class="s1">_generate_4_axes_via_gridspec</span><span class="s3">()</span>

        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s3">{</span>
                <span class="s4">&quot;a&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">, </span><span class="s6">5</span><span class="s3">, </span><span class="s6">6</span><span class="s3">],</span>
                <span class="s4">&quot;b&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">, </span><span class="s6">5</span><span class="s3">, </span><span class="s6">6</span><span class="s3">],</span>
                <span class="s4">&quot;c&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">, </span><span class="s6">5</span><span class="s3">, </span><span class="s6">6</span><span class="s3">],</span>
                <span class="s4">&quot;d&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">, </span><span class="s6">5</span><span class="s3">, </span><span class="s6">6</span><span class="s3">],</span>
            <span class="s3">}</span>
        <span class="s3">)</span>

        <span class="s2">def </span><span class="s1">_check</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">):</span>
            <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes</span><span class="s3">:</span>
                <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">) == </span><span class="s6">1</span>
                <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticklabels</span><span class="s3">(), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
                <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticklabels</span><span class="s3">(</span><span class="s1">minor</span><span class="s3">=</span><span class="s2">True</span><span class="s3">), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
            <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s3">[</span><span class="s1">axes</span><span class="s3">[</span><span class="s6">0</span><span class="s3">], </span><span class="s1">axes</span><span class="s3">[</span><span class="s6">1</span><span class="s3">]]:</span>
                <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_yticklabels</span><span class="s3">(), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
            <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s3">[</span><span class="s1">axes</span><span class="s3">[</span><span class="s6">2</span><span class="s3">], </span><span class="s1">axes</span><span class="s3">[</span><span class="s6">3</span><span class="s3">]]:</span>
                <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_yticklabels</span><span class="s3">(), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>

        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes</span><span class="s3">:</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s1">title</span><span class="s3">=</span><span class="s4">&quot;title&quot;</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">sharey</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s1">gs</span><span class="s3">.</span><span class="s1">tight_layout</span><span class="s3">(</span><span class="s1">plt</span><span class="s3">.</span><span class="s1">gcf</span><span class="s3">())</span>
        <span class="s1">_check</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">)</span>
        <span class="s1">plt</span><span class="s3">.</span><span class="s1">close</span><span class="s3">(</span><span class="s4">&quot;all&quot;</span><span class="s3">)</span>

        <span class="s1">gs</span><span class="s3">, </span><span class="s1">axes </span><span class="s3">= </span><span class="s1">_generate_4_axes_via_gridspec</span><span class="s3">()</span>
        <span class="s2">with </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_produces_warning</span><span class="s3">(</span><span class="s1">UserWarning</span><span class="s3">):</span>
            <span class="s1">axes </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">subplots</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">axes</span><span class="s3">, </span><span class="s1">sharey</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>

        <span class="s1">gs</span><span class="s3">.</span><span class="s1">tight_layout</span><span class="s3">(</span><span class="s1">plt</span><span class="s3">.</span><span class="s1">gcf</span><span class="s3">())</span>
        <span class="s1">_check</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_sharey_and_ax_tight</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s5"># https://github.com/pandas-dev/pandas/issues/9737 using gridspec,</span>
        <span class="s2">import </span><span class="s1">matplotlib</span><span class="s3">.</span><span class="s1">pyplot </span><span class="s2">as </span><span class="s1">plt</span>

        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s3">{</span>
                <span class="s4">&quot;a&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">, </span><span class="s6">5</span><span class="s3">, </span><span class="s6">6</span><span class="s3">],</span>
                <span class="s4">&quot;b&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">, </span><span class="s6">5</span><span class="s3">, </span><span class="s6">6</span><span class="s3">],</span>
                <span class="s4">&quot;c&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">, </span><span class="s6">5</span><span class="s3">, </span><span class="s6">6</span><span class="s3">],</span>
                <span class="s4">&quot;d&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">, </span><span class="s6">5</span><span class="s3">, </span><span class="s6">6</span><span class="s3">],</span>
            <span class="s3">}</span>
        <span class="s3">)</span>
        <span class="s1">gs</span><span class="s3">, </span><span class="s1">axes </span><span class="s3">= </span><span class="s1">_generate_4_axes_via_gridspec</span><span class="s3">()</span>
        <span class="s5"># without sharex, no labels should be touched!</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes</span><span class="s3">:</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s1">title</span><span class="s3">=</span><span class="s4">&quot;title&quot;</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>

        <span class="s1">gs</span><span class="s3">.</span><span class="s1">tight_layout</span><span class="s3">(</span><span class="s1">plt</span><span class="s3">.</span><span class="s1">gcf</span><span class="s3">())</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes</span><span class="s3">:</span>
            <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">) == </span><span class="s6">1</span>
            <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_yticklabels</span><span class="s3">(), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
            <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticklabels</span><span class="s3">(), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
            <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticklabels</span><span class="s3">(</span><span class="s1">minor</span><span class="s3">=</span><span class="s2">True</span><span class="s3">), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;kind&quot;</span><span class="s3">, </span><span class="s1">plotting</span><span class="s3">.</span><span class="s1">PlotAccessor</span><span class="s3">.</span><span class="s1">_all_kinds</span><span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_memory_leak</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">):</span>
        <span class="s0">&quot;&quot;&quot;Check that every plot type gets properly collected.&quot;&quot;&quot;</span>
        <span class="s1">pytest</span><span class="s3">.</span><span class="s1">importorskip</span><span class="s3">(</span><span class="s4">&quot;scipy&quot;</span><span class="s3">)</span>
        <span class="s1">args </span><span class="s3">= {}</span>
        <span class="s2">if </span><span class="s1">kind </span><span class="s2">in </span><span class="s3">[</span><span class="s4">&quot;hexbin&quot;</span><span class="s3">, </span><span class="s4">&quot;scatter&quot;</span><span class="s3">, </span><span class="s4">&quot;pie&quot;</span><span class="s3">]:</span>
            <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
                <span class="s3">{</span>
                    <span class="s4">&quot;A&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">uniform</span><span class="s3">(</span><span class="s1">size</span><span class="s3">=</span><span class="s6">20</span><span class="s3">),</span>
                    <span class="s4">&quot;B&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">uniform</span><span class="s3">(</span><span class="s1">size</span><span class="s3">=</span><span class="s6">20</span><span class="s3">),</span>
                    <span class="s4">&quot;C&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">20</span><span class="s3">) + </span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">uniform</span><span class="s3">(</span><span class="s1">size</span><span class="s3">=</span><span class="s6">20</span><span class="s3">),</span>
                <span class="s3">}</span>
            <span class="s3">)</span>
            <span class="s1">args </span><span class="s3">= {</span><span class="s4">&quot;x&quot;</span><span class="s3">: </span><span class="s4">&quot;A&quot;</span><span class="s3">, </span><span class="s4">&quot;y&quot;</span><span class="s3">: </span><span class="s4">&quot;B&quot;</span><span class="s3">}</span>
        <span class="s2">elif </span><span class="s1">kind </span><span class="s3">== </span><span class="s4">&quot;area&quot;</span><span class="s3">:</span>
            <span class="s1">df </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">makeTimeDataFrame</span><span class="s3">().</span><span class="s1">abs</span><span class="s3">()</span>
        <span class="s2">else</span><span class="s3">:</span>
            <span class="s1">df </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">makeTimeDataFrame</span><span class="s3">()</span>

        <span class="s5"># Use a weakref so we can see if the object gets collected without</span>
        <span class="s5"># also preventing it from being collected</span>
        <span class="s1">ref </span><span class="s3">= </span><span class="s1">weakref</span><span class="s3">.</span><span class="s1">ref</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">, **</span><span class="s1">args</span><span class="s3">))</span>

        <span class="s5"># have matplotlib delete all the figures</span>
        <span class="s1">plt</span><span class="s3">.</span><span class="s1">close</span><span class="s3">(</span><span class="s4">&quot;all&quot;</span><span class="s3">)</span>
        <span class="s5"># force a garbage collection</span>
        <span class="s1">gc</span><span class="s3">.</span><span class="s1">collect</span><span class="s3">()</span>
        <span class="s2">assert </span><span class="s1">ref</span><span class="s3">() </span><span class="s2">is None</span>

    <span class="s2">def </span><span class="s1">test_df_gridspec_patterns_vert_horiz</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s5"># GH 10819</span>
        <span class="s2">from </span><span class="s1">matplotlib </span><span class="s2">import </span><span class="s1">gridspec</span>
        <span class="s2">import </span><span class="s1">matplotlib</span><span class="s3">.</span><span class="s1">pyplot </span><span class="s2">as </span><span class="s1">plt</span>

        <span class="s1">ts </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">(</span><span class="s6">10</span><span class="s3">),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">date_range</span><span class="s3">(</span><span class="s4">&quot;1/1/2000&quot;</span><span class="s3">, </span><span class="s1">periods</span><span class="s3">=</span><span class="s6">10</span><span class="s3">),</span>
        <span class="s3">)</span>

        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">10</span><span class="s3">, </span><span class="s6">2</span><span class="s3">)),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">ts</span><span class="s3">.</span><span class="s1">index</span><span class="s3">,</span>
            <span class="s1">columns</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s4">&quot;AB&quot;</span><span class="s3">),</span>
        <span class="s3">)</span>

        <span class="s2">def </span><span class="s1">_get_vertical_grid</span><span class="s3">():</span>
            <span class="s1">gs </span><span class="s3">= </span><span class="s1">gridspec</span><span class="s3">.</span><span class="s1">GridSpec</span><span class="s3">(</span><span class="s6">3</span><span class="s3">, </span><span class="s6">1</span><span class="s3">)</span>
            <span class="s1">fig </span><span class="s3">= </span><span class="s1">plt</span><span class="s3">.</span><span class="s1">figure</span><span class="s3">()</span>
            <span class="s1">ax1 </span><span class="s3">= </span><span class="s1">fig</span><span class="s3">.</span><span class="s1">add_subplot</span><span class="s3">(</span><span class="s1">gs</span><span class="s3">[:</span><span class="s6">2</span><span class="s3">, :])</span>
            <span class="s1">ax2 </span><span class="s3">= </span><span class="s1">fig</span><span class="s3">.</span><span class="s1">add_subplot</span><span class="s3">(</span><span class="s1">gs</span><span class="s3">[</span><span class="s6">2</span><span class="s3">, :])</span>
            <span class="s2">return </span><span class="s1">ax1</span><span class="s3">, </span><span class="s1">ax2</span>

        <span class="s2">def </span><span class="s1">_get_horizontal_grid</span><span class="s3">():</span>
            <span class="s1">gs </span><span class="s3">= </span><span class="s1">gridspec</span><span class="s3">.</span><span class="s1">GridSpec</span><span class="s3">(</span><span class="s6">1</span><span class="s3">, </span><span class="s6">3</span><span class="s3">)</span>
            <span class="s1">fig </span><span class="s3">= </span><span class="s1">plt</span><span class="s3">.</span><span class="s1">figure</span><span class="s3">()</span>
            <span class="s1">ax1 </span><span class="s3">= </span><span class="s1">fig</span><span class="s3">.</span><span class="s1">add_subplot</span><span class="s3">(</span><span class="s1">gs</span><span class="s3">[:, :</span><span class="s6">2</span><span class="s3">])</span>
            <span class="s1">ax2 </span><span class="s3">= </span><span class="s1">fig</span><span class="s3">.</span><span class="s1">add_subplot</span><span class="s3">(</span><span class="s1">gs</span><span class="s3">[:, </span><span class="s6">2</span><span class="s3">])</span>
            <span class="s2">return </span><span class="s1">ax1</span><span class="s3">, </span><span class="s1">ax2</span>

        <span class="s2">for </span><span class="s1">ax1</span><span class="s3">, </span><span class="s1">ax2 </span><span class="s2">in </span><span class="s3">[</span><span class="s1">_get_vertical_grid</span><span class="s3">(), </span><span class="s1">_get_horizontal_grid</span><span class="s3">()]:</span>
            <span class="s1">ax1 </span><span class="s3">= </span><span class="s1">ts</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax1</span><span class="s3">)</span>
            <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">ax1</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">) == </span><span class="s6">1</span>
            <span class="s1">ax2 </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax2</span><span class="s3">)</span>
            <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">ax2</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">) == </span><span class="s6">2</span>
            <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s3">[</span><span class="s1">ax1</span><span class="s3">, </span><span class="s1">ax2</span><span class="s3">]:</span>
                <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_yticklabels</span><span class="s3">(), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
                <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticklabels</span><span class="s3">(), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
                <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticklabels</span><span class="s3">(</span><span class="s1">minor</span><span class="s3">=</span><span class="s2">True</span><span class="s3">), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
            <span class="s1">plt</span><span class="s3">.</span><span class="s1">close</span><span class="s3">(</span><span class="s4">&quot;all&quot;</span><span class="s3">)</span>

        <span class="s5"># subplots=True</span>
        <span class="s2">for </span><span class="s1">ax1</span><span class="s3">, </span><span class="s1">ax2 </span><span class="s2">in </span><span class="s3">[</span><span class="s1">_get_vertical_grid</span><span class="s3">(), </span><span class="s1">_get_horizontal_grid</span><span class="s3">()]:</span>
            <span class="s1">axes </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">subplots</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=[</span><span class="s1">ax1</span><span class="s3">, </span><span class="s1">ax2</span><span class="s3">])</span>
            <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">ax1</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">) == </span><span class="s6">1</span>
            <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">ax2</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">) == </span><span class="s6">1</span>
            <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes</span><span class="s3">:</span>
                <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_yticklabels</span><span class="s3">(), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
                <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticklabels</span><span class="s3">(), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
                <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticklabels</span><span class="s3">(</span><span class="s1">minor</span><span class="s3">=</span><span class="s2">True</span><span class="s3">), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
            <span class="s1">plt</span><span class="s3">.</span><span class="s1">close</span><span class="s3">(</span><span class="s4">&quot;all&quot;</span><span class="s3">)</span>

        <span class="s5"># vertical / subplots / sharex=True / sharey=True</span>
        <span class="s1">ax1</span><span class="s3">, </span><span class="s1">ax2 </span><span class="s3">= </span><span class="s1">_get_vertical_grid</span><span class="s3">()</span>
        <span class="s2">with </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_produces_warning</span><span class="s3">(</span><span class="s1">UserWarning</span><span class="s3">):</span>
            <span class="s1">axes </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">subplots</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=[</span><span class="s1">ax1</span><span class="s3">, </span><span class="s1">ax2</span><span class="s3">], </span><span class="s1">sharex</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">sharey</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">lines</span><span class="s3">) == </span><span class="s6">1</span>
        <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">[</span><span class="s6">1</span><span class="s3">].</span><span class="s1">lines</span><span class="s3">) == </span><span class="s6">1</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s3">[</span><span class="s1">ax1</span><span class="s3">, </span><span class="s1">ax2</span><span class="s3">]:</span>
            <span class="s5"># yaxis are visible because there is only one column</span>
            <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_yticklabels</span><span class="s3">(), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s5"># xaxis of axes0 (top) are hidden</span>
        <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">get_xticklabels</span><span class="s3">(), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>
        <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">get_xticklabels</span><span class="s3">(</span><span class="s1">minor</span><span class="s3">=</span><span class="s2">True</span><span class="s3">), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>
        <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">[</span><span class="s6">1</span><span class="s3">].</span><span class="s1">get_xticklabels</span><span class="s3">(), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">[</span><span class="s6">1</span><span class="s3">].</span><span class="s1">get_xticklabels</span><span class="s3">(</span><span class="s1">minor</span><span class="s3">=</span><span class="s2">True</span><span class="s3">), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s1">plt</span><span class="s3">.</span><span class="s1">close</span><span class="s3">(</span><span class="s4">&quot;all&quot;</span><span class="s3">)</span>

        <span class="s5"># horizontal / subplots / sharex=True / sharey=True</span>
        <span class="s1">ax1</span><span class="s3">, </span><span class="s1">ax2 </span><span class="s3">= </span><span class="s1">_get_horizontal_grid</span><span class="s3">()</span>
        <span class="s2">with </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_produces_warning</span><span class="s3">(</span><span class="s1">UserWarning</span><span class="s3">):</span>
            <span class="s1">axes </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">subplots</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=[</span><span class="s1">ax1</span><span class="s3">, </span><span class="s1">ax2</span><span class="s3">], </span><span class="s1">sharex</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">sharey</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">lines</span><span class="s3">) == </span><span class="s6">1</span>
        <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">[</span><span class="s6">1</span><span class="s3">].</span><span class="s1">lines</span><span class="s3">) == </span><span class="s6">1</span>
        <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">get_yticklabels</span><span class="s3">(), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s5"># yaxis of axes1 (right) are hidden</span>
        <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">[</span><span class="s6">1</span><span class="s3">].</span><span class="s1">get_yticklabels</span><span class="s3">(), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s3">[</span><span class="s1">ax1</span><span class="s3">, </span><span class="s1">ax2</span><span class="s3">]:</span>
            <span class="s5"># xaxis are visible because there is only one column</span>
            <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticklabels</span><span class="s3">(), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
            <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticklabels</span><span class="s3">(</span><span class="s1">minor</span><span class="s3">=</span><span class="s2">True</span><span class="s3">), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s1">plt</span><span class="s3">.</span><span class="s1">close</span><span class="s3">(</span><span class="s4">&quot;all&quot;</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_df_gridspec_patterns_boxed</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s5"># GH 10819</span>
        <span class="s2">from </span><span class="s1">matplotlib </span><span class="s2">import </span><span class="s1">gridspec</span>
        <span class="s2">import </span><span class="s1">matplotlib</span><span class="s3">.</span><span class="s1">pyplot </span><span class="s2">as </span><span class="s1">plt</span>

        <span class="s1">ts </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">(</span><span class="s6">10</span><span class="s3">),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">date_range</span><span class="s3">(</span><span class="s4">&quot;1/1/2000&quot;</span><span class="s3">, </span><span class="s1">periods</span><span class="s3">=</span><span class="s6">10</span><span class="s3">),</span>
        <span class="s3">)</span>

        <span class="s5"># boxed</span>
        <span class="s2">def </span><span class="s1">_get_boxed_grid</span><span class="s3">():</span>
            <span class="s1">gs </span><span class="s3">= </span><span class="s1">gridspec</span><span class="s3">.</span><span class="s1">GridSpec</span><span class="s3">(</span><span class="s6">3</span><span class="s3">, </span><span class="s6">3</span><span class="s3">)</span>
            <span class="s1">fig </span><span class="s3">= </span><span class="s1">plt</span><span class="s3">.</span><span class="s1">figure</span><span class="s3">()</span>
            <span class="s1">ax1 </span><span class="s3">= </span><span class="s1">fig</span><span class="s3">.</span><span class="s1">add_subplot</span><span class="s3">(</span><span class="s1">gs</span><span class="s3">[:</span><span class="s6">2</span><span class="s3">, :</span><span class="s6">2</span><span class="s3">])</span>
            <span class="s1">ax2 </span><span class="s3">= </span><span class="s1">fig</span><span class="s3">.</span><span class="s1">add_subplot</span><span class="s3">(</span><span class="s1">gs</span><span class="s3">[:</span><span class="s6">2</span><span class="s3">, </span><span class="s6">2</span><span class="s3">])</span>
            <span class="s1">ax3 </span><span class="s3">= </span><span class="s1">fig</span><span class="s3">.</span><span class="s1">add_subplot</span><span class="s3">(</span><span class="s1">gs</span><span class="s3">[</span><span class="s6">2</span><span class="s3">, :</span><span class="s6">2</span><span class="s3">])</span>
            <span class="s1">ax4 </span><span class="s3">= </span><span class="s1">fig</span><span class="s3">.</span><span class="s1">add_subplot</span><span class="s3">(</span><span class="s1">gs</span><span class="s3">[</span><span class="s6">2</span><span class="s3">, </span><span class="s6">2</span><span class="s3">])</span>
            <span class="s2">return </span><span class="s1">ax1</span><span class="s3">, </span><span class="s1">ax2</span><span class="s3">, </span><span class="s1">ax3</span><span class="s3">, </span><span class="s1">ax4</span>

        <span class="s1">axes </span><span class="s3">= </span><span class="s1">_get_boxed_grid</span><span class="s3">()</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">10</span><span class="s3">, </span><span class="s6">4</span><span class="s3">)),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">ts</span><span class="s3">.</span><span class="s1">index</span><span class="s3">,</span>
            <span class="s1">columns</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s4">&quot;ABCD&quot;</span><span class="s3">),</span>
        <span class="s3">)</span>
        <span class="s1">axes </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">subplots</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">axes</span><span class="s3">)</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes</span><span class="s3">:</span>
            <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">) == </span><span class="s6">1</span>
            <span class="s5"># axis are visible because these are not shared</span>
            <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_yticklabels</span><span class="s3">(), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
            <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticklabels</span><span class="s3">(), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
            <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticklabels</span><span class="s3">(</span><span class="s1">minor</span><span class="s3">=</span><span class="s2">True</span><span class="s3">), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s1">plt</span><span class="s3">.</span><span class="s1">close</span><span class="s3">(</span><span class="s4">&quot;all&quot;</span><span class="s3">)</span>

        <span class="s5"># subplots / sharex=True / sharey=True</span>
        <span class="s1">axes </span><span class="s3">= </span><span class="s1">_get_boxed_grid</span><span class="s3">()</span>
        <span class="s2">with </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_produces_warning</span><span class="s3">(</span><span class="s1">UserWarning</span><span class="s3">):</span>
            <span class="s1">axes </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">subplots</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">axes</span><span class="s3">, </span><span class="s1">sharex</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">sharey</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes</span><span class="s3">:</span>
            <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">) == </span><span class="s6">1</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s3">[</span><span class="s1">axes</span><span class="s3">[</span><span class="s6">0</span><span class="s3">], </span><span class="s1">axes</span><span class="s3">[</span><span class="s6">2</span><span class="s3">]]:  </span><span class="s5"># left column</span>
            <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_yticklabels</span><span class="s3">(), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s3">[</span><span class="s1">axes</span><span class="s3">[</span><span class="s6">1</span><span class="s3">], </span><span class="s1">axes</span><span class="s3">[</span><span class="s6">3</span><span class="s3">]]:  </span><span class="s5"># right column</span>
            <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_yticklabels</span><span class="s3">(), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s3">[</span><span class="s1">axes</span><span class="s3">[</span><span class="s6">0</span><span class="s3">], </span><span class="s1">axes</span><span class="s3">[</span><span class="s6">1</span><span class="s3">]]:  </span><span class="s5"># top row</span>
            <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticklabels</span><span class="s3">(), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>
            <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticklabels</span><span class="s3">(</span><span class="s1">minor</span><span class="s3">=</span><span class="s2">True</span><span class="s3">), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s3">[</span><span class="s1">axes</span><span class="s3">[</span><span class="s6">2</span><span class="s3">], </span><span class="s1">axes</span><span class="s3">[</span><span class="s6">3</span><span class="s3">]]:  </span><span class="s5"># bottom row</span>
            <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticklabels</span><span class="s3">(), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
            <span class="s1">_check_visible</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticklabels</span><span class="s3">(</span><span class="s1">minor</span><span class="s3">=</span><span class="s2">True</span><span class="s3">), </span><span class="s1">visible</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s1">plt</span><span class="s3">.</span><span class="s1">close</span><span class="s3">(</span><span class="s4">&quot;all&quot;</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_df_grid_settings</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s5"># Make sure plot defaults to rcParams['axes.grid'] setting, GH 9792</span>
        <span class="s1">_check_grid_settings</span><span class="s3">(</span>
            <span class="s1">DataFrame</span><span class="s3">({</span><span class="s4">&quot;a&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">], </span><span class="s4">&quot;b&quot;</span><span class="s3">: [</span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">]}),</span>
            <span class="s1">plotting</span><span class="s3">.</span><span class="s1">PlotAccessor</span><span class="s3">.</span><span class="s1">_dataframe_kinds</span><span class="s3">,</span>
            <span class="s1">kws</span><span class="s3">={</span><span class="s4">&quot;x&quot;</span><span class="s3">: </span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;y&quot;</span><span class="s3">: </span><span class="s4">&quot;b&quot;</span><span class="s3">},</span>
        <span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_plain_axes</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s5"># supplied ax itself is a SubplotAxes, but figure contains also</span>
        <span class="s5"># a plain Axes object (GH11556)</span>
        <span class="s1">fig</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">fig</span><span class="s3">.</span><span class="s1">add_axes</span><span class="s3">([</span><span class="s6">0.2</span><span class="s3">, </span><span class="s6">0.2</span><span class="s3">, </span><span class="s6">0.2</span><span class="s3">, </span><span class="s6">0.2</span><span class="s3">])</span>
        <span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">(</span><span class="s6">10</span><span class="s3">)).</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_plain_axes_df</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s5"># supplied ax itself is a plain Axes, but because the cmap keyword</span>
        <span class="s5"># a new ax is created for the colorbar -&gt; also multiples axes (GH11520)</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s3">{</span>
                <span class="s4">&quot;a&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">(</span><span class="s6">8</span><span class="s3">),</span>
                <span class="s4">&quot;b&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">(</span><span class="s6">8</span><span class="s3">),</span>
            <span class="s3">}</span>
        <span class="s3">)</span>
        <span class="s1">fig </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">figure</span><span class="s3">()</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">fig</span><span class="s3">.</span><span class="s1">add_axes</span><span class="s3">((</span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">, </span><span class="s6">1</span><span class="s3">, </span><span class="s6">1</span><span class="s3">))</span>
        <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">kind</span><span class="s3">=</span><span class="s4">&quot;scatter&quot;</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">x</span><span class="s3">=</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s1">c</span><span class="s3">=</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s1">cmap</span><span class="s3">=</span><span class="s4">&quot;hsv&quot;</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_plain_axes_make_axes_locatable</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s5"># other examples</span>
        <span class="s1">fig</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s2">from </span><span class="s1">mpl_toolkits</span><span class="s3">.</span><span class="s1">axes_grid1 </span><span class="s2">import </span><span class="s1">make_axes_locatable</span>

        <span class="s1">divider </span><span class="s3">= </span><span class="s1">make_axes_locatable</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">cax </span><span class="s3">= </span><span class="s1">divider</span><span class="s3">.</span><span class="s1">append_axes</span><span class="s3">(</span><span class="s4">&quot;right&quot;</span><span class="s3">, </span><span class="s1">size</span><span class="s3">=</span><span class="s4">&quot;5%&quot;</span><span class="s3">, </span><span class="s1">pad</span><span class="s3">=</span><span class="s6">0.05</span><span class="s3">)</span>
        <span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">(</span><span class="s6">10</span><span class="s3">)).</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">(</span><span class="s6">10</span><span class="s3">)).</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">=</span><span class="s1">cax</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_plain_axes_make_inset_axes</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">fig</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s2">from </span><span class="s1">mpl_toolkits</span><span class="s3">.</span><span class="s1">axes_grid1</span><span class="s3">.</span><span class="s1">inset_locator </span><span class="s2">import </span><span class="s1">inset_axes</span>

        <span class="s1">iax </span><span class="s3">= </span><span class="s1">inset_axes</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">width</span><span class="s3">=</span><span class="s4">&quot;30%&quot;</span><span class="s3">, </span><span class="s1">height</span><span class="s3">=</span><span class="s6">1.0</span><span class="s3">, </span><span class="s1">loc</span><span class="s3">=</span><span class="s6">3</span><span class="s3">)</span>
        <span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">(</span><span class="s6">10</span><span class="s3">)).</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">(</span><span class="s6">10</span><span class="s3">)).</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">=</span><span class="s1">iax</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;method&quot;</span><span class="s3">, [</span><span class="s4">&quot;line&quot;</span><span class="s3">, </span><span class="s4">&quot;barh&quot;</span><span class="s3">, </span><span class="s4">&quot;bar&quot;</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_secondary_axis_font_size</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">method</span><span class="s3">):</span>
        <span class="s5"># GH: 12565</span>
        <span class="s1">df </span><span class="s3">= (</span>
            <span class="s1">DataFrame</span><span class="s3">(</span>
                <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">15</span><span class="s3">, </span><span class="s6">2</span><span class="s3">)), </span><span class="s1">columns</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s4">&quot;AB&quot;</span><span class="s3">)</span>
            <span class="s3">)</span>
            <span class="s3">.</span><span class="s1">assign</span><span class="s3">(</span><span class="s1">C</span><span class="s3">=</span><span class="s2">lambda </span><span class="s1">df</span><span class="s3">: </span><span class="s1">df</span><span class="s3">.</span><span class="s1">B</span><span class="s3">.</span><span class="s1">cumsum</span><span class="s3">())</span>
            <span class="s3">.</span><span class="s1">assign</span><span class="s3">(</span><span class="s1">D</span><span class="s3">=</span><span class="s2">lambda </span><span class="s1">df</span><span class="s3">: </span><span class="s1">df</span><span class="s3">.</span><span class="s1">C </span><span class="s3">* </span><span class="s6">1.1</span><span class="s3">)</span>
        <span class="s3">)</span>

        <span class="s1">fontsize </span><span class="s3">= </span><span class="s6">20</span>
        <span class="s1">sy </span><span class="s3">= [</span><span class="s4">&quot;C&quot;</span><span class="s3">, </span><span class="s4">&quot;D&quot;</span><span class="s3">]</span>

        <span class="s1">kwargs </span><span class="s3">= {</span><span class="s4">&quot;secondary_y&quot;</span><span class="s3">: </span><span class="s1">sy</span><span class="s3">, </span><span class="s4">&quot;fontsize&quot;</span><span class="s3">: </span><span class="s1">fontsize</span><span class="s3">, </span><span class="s4">&quot;mark_right&quot;</span><span class="s3">: </span><span class="s2">True</span><span class="s3">}</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">getattr</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">method</span><span class="s3">)(**</span><span class="s1">kwargs</span><span class="s3">)</span>
        <span class="s1">_check_ticks_props</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">right_ax</span><span class="s3">, </span><span class="s1">ylabelsize</span><span class="s3">=</span><span class="s1">fontsize</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_x_string_values_ticks</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s5"># Test if string plot index have a fixed xtick position</span>
        <span class="s5"># GH: 7612, GH: 22334</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s3">{</span>
                <span class="s4">&quot;sales&quot;</span><span class="s3">: [</span><span class="s6">3</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">],</span>
                <span class="s4">&quot;visits&quot;</span><span class="s3">: [</span><span class="s6">20</span><span class="s3">, </span><span class="s6">42</span><span class="s3">, </span><span class="s6">28</span><span class="s3">],</span>
                <span class="s4">&quot;day&quot;</span><span class="s3">: [</span><span class="s4">&quot;Monday&quot;</span><span class="s3">, </span><span class="s4">&quot;Tuesday&quot;</span><span class="s3">, </span><span class="s4">&quot;Wednesday&quot;</span><span class="s3">],</span>
            <span class="s3">}</span>
        <span class="s3">)</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">area</span><span class="s3">(</span><span class="s1">x</span><span class="s3">=</span><span class="s4">&quot;day&quot;</span><span class="s3">)</span>
        <span class="s1">ax</span><span class="s3">.</span><span class="s1">set_xlim</span><span class="s3">(-</span><span class="s6">1</span><span class="s3">, </span><span class="s6">3</span><span class="s3">)</span>
        <span class="s1">xticklabels </span><span class="s3">= [</span><span class="s1">t</span><span class="s3">.</span><span class="s1">get_text</span><span class="s3">() </span><span class="s2">for </span><span class="s1">t </span><span class="s2">in </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticklabels</span><span class="s3">()]</span>
        <span class="s1">labels_position </span><span class="s3">= </span><span class="s1">dict</span><span class="s3">(</span><span class="s1">zip</span><span class="s3">(</span><span class="s1">xticklabels</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticks</span><span class="s3">()))</span>
        <span class="s5"># Testing if the label stayed at the right position</span>
        <span class="s2">assert </span><span class="s1">labels_position</span><span class="s3">[</span><span class="s4">&quot;Monday&quot;</span><span class="s3">] == </span><span class="s6">0.0</span>
        <span class="s2">assert </span><span class="s1">labels_position</span><span class="s3">[</span><span class="s4">&quot;Tuesday&quot;</span><span class="s3">] == </span><span class="s6">1.0</span>
        <span class="s2">assert </span><span class="s1">labels_position</span><span class="s3">[</span><span class="s4">&quot;Wednesday&quot;</span><span class="s3">] == </span><span class="s6">2.0</span>

    <span class="s2">def </span><span class="s1">test_x_multiindex_values_ticks</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s5"># Test if multiindex plot index have a fixed xtick position</span>
        <span class="s5"># GH: 15912</span>
        <span class="s1">index </span><span class="s3">= </span><span class="s1">MultiIndex</span><span class="s3">.</span><span class="s1">from_product</span><span class="s3">([[</span><span class="s6">2012</span><span class="s3">, </span><span class="s6">2013</span><span class="s3">], [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">]])</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s6">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s6">4</span><span class="s3">, </span><span class="s6">2</span><span class="s3">)),</span>
            <span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;A&quot;</span><span class="s3">, </span><span class="s4">&quot;B&quot;</span><span class="s3">],</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">index</span><span class="s3">,</span>
        <span class="s3">)</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">()</span>
        <span class="s1">ax</span><span class="s3">.</span><span class="s1">set_xlim</span><span class="s3">(-</span><span class="s6">1</span><span class="s3">, </span><span class="s6">4</span><span class="s3">)</span>
        <span class="s1">xticklabels </span><span class="s3">= [</span><span class="s1">t</span><span class="s3">.</span><span class="s1">get_text</span><span class="s3">() </span><span class="s2">for </span><span class="s1">t </span><span class="s2">in </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticklabels</span><span class="s3">()]</span>
        <span class="s1">labels_position </span><span class="s3">= </span><span class="s1">dict</span><span class="s3">(</span><span class="s1">zip</span><span class="s3">(</span><span class="s1">xticklabels</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticks</span><span class="s3">()))</span>
        <span class="s5"># Testing if the label stayed at the right position</span>
        <span class="s2">assert </span><span class="s1">labels_position</span><span class="s3">[</span><span class="s4">&quot;(2012, 1)&quot;</span><span class="s3">] == </span><span class="s6">0.0</span>
        <span class="s2">assert </span><span class="s1">labels_position</span><span class="s3">[</span><span class="s4">&quot;(2012, 2)&quot;</span><span class="s3">] == </span><span class="s6">1.0</span>
        <span class="s2">assert </span><span class="s1">labels_position</span><span class="s3">[</span><span class="s4">&quot;(2013, 1)&quot;</span><span class="s3">] == </span><span class="s6">2.0</span>
        <span class="s2">assert </span><span class="s1">labels_position</span><span class="s3">[</span><span class="s4">&quot;(2013, 2)&quot;</span><span class="s3">] == </span><span class="s6">3.0</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;kind&quot;</span><span class="s3">, [</span><span class="s4">&quot;line&quot;</span><span class="s3">, </span><span class="s4">&quot;area&quot;</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_xlim_plot_line</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">):</span>
        <span class="s5"># test if xlim is set correctly in plot.line and plot.area</span>
        <span class="s5"># GH 27686</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">([</span><span class="s6">2</span><span class="s3">, </span><span class="s6">4</span><span class="s3">], </span><span class="s1">index</span><span class="s3">=[</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">])</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">)</span>
        <span class="s1">xlims </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xlim</span><span class="s3">()</span>
        <span class="s2">assert </span><span class="s1">xlims</span><span class="s3">[</span><span class="s6">0</span><span class="s3">] &lt; </span><span class="s6">1</span>
        <span class="s2">assert </span><span class="s1">xlims</span><span class="s3">[</span><span class="s6">1</span><span class="s3">] &gt; </span><span class="s6">2</span>

    <span class="s2">def </span><span class="s1">test_xlim_plot_line_correctly_in_mixed_plot_type</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s5"># test if xlim is set correctly when ax contains multiple different kinds</span>
        <span class="s5"># of plots, GH 27686</span>
        <span class="s1">fig</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>

        <span class="s1">indexes </span><span class="s3">= [</span><span class="s4">&quot;k1&quot;</span><span class="s3">, </span><span class="s4">&quot;k2&quot;</span><span class="s3">, </span><span class="s4">&quot;k3&quot;</span><span class="s3">, </span><span class="s4">&quot;k4&quot;</span><span class="s3">]</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s3">{</span>
                <span class="s4">&quot;s1&quot;</span><span class="s3">: [</span><span class="s6">1000</span><span class="s3">, </span><span class="s6">2000</span><span class="s3">, </span><span class="s6">1500</span><span class="s3">, </span><span class="s6">2000</span><span class="s3">],</span>
                <span class="s4">&quot;s2&quot;</span><span class="s3">: [</span><span class="s6">900</span><span class="s3">, </span><span class="s6">1400</span><span class="s3">, </span><span class="s6">2000</span><span class="s3">, </span><span class="s6">3000</span><span class="s3">],</span>
                <span class="s4">&quot;s3&quot;</span><span class="s3">: [</span><span class="s6">1500</span><span class="s3">, </span><span class="s6">1500</span><span class="s3">, </span><span class="s6">1600</span><span class="s3">, </span><span class="s6">1200</span><span class="s3">],</span>
                <span class="s4">&quot;secondary_y&quot;</span><span class="s3">: [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">3</span><span class="s3">, </span><span class="s6">4</span><span class="s3">, </span><span class="s6">3</span><span class="s3">],</span>
            <span class="s3">},</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">indexes</span><span class="s3">,</span>
        <span class="s3">)</span>
        <span class="s1">df</span><span class="s3">[[</span><span class="s4">&quot;s1&quot;</span><span class="s3">, </span><span class="s4">&quot;s2&quot;</span><span class="s3">, </span><span class="s4">&quot;s3&quot;</span><span class="s3">]].</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">bar</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">stacked</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>
        <span class="s1">df</span><span class="s3">[[</span><span class="s4">&quot;secondary_y&quot;</span><span class="s3">]].</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">secondary_y</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>

        <span class="s1">xlims </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xlim</span><span class="s3">()</span>
        <span class="s2">assert </span><span class="s1">xlims</span><span class="s3">[</span><span class="s6">0</span><span class="s3">] &lt; </span><span class="s6">0</span>
        <span class="s2">assert </span><span class="s1">xlims</span><span class="s3">[</span><span class="s6">1</span><span class="s3">] &gt; </span><span class="s6">3</span>

        <span class="s5"># make sure axis labels are plotted correctly as well</span>
        <span class="s1">xticklabels </span><span class="s3">= [</span><span class="s1">t</span><span class="s3">.</span><span class="s1">get_text</span><span class="s3">() </span><span class="s2">for </span><span class="s1">t </span><span class="s2">in </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticklabels</span><span class="s3">()]</span>
        <span class="s2">assert </span><span class="s1">xticklabels </span><span class="s3">== </span><span class="s1">indexes</span>

    <span class="s2">def </span><span class="s1">test_plot_no_rows</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s5"># GH 27758</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;foo&quot;</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">int</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">df</span><span class="s3">.</span><span class="s1">empty</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">()</span>
        <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_lines</span><span class="s3">()) == </span><span class="s6">1</span>
        <span class="s1">line </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_lines</span><span class="s3">()[</span><span class="s6">0</span><span class="s3">]</span>
        <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">line</span><span class="s3">.</span><span class="s1">get_xdata</span><span class="s3">()) == </span><span class="s6">0</span>
        <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">line</span><span class="s3">.</span><span class="s1">get_ydata</span><span class="s3">()) == </span><span class="s6">0</span>

    <span class="s2">def </span><span class="s1">test_plot_no_numeric_data</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">([</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s4">&quot;c&quot;</span><span class="s3">])</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">TypeError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s4">&quot;no numeric data to plot&quot;</span><span class="s3">):</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">()</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;kind&quot;</span><span class="s3">, (</span><span class="s4">&quot;line&quot;</span><span class="s3">, </span><span class="s4">&quot;bar&quot;</span><span class="s3">, </span><span class="s4">&quot;barh&quot;</span><span class="s3">, </span><span class="s4">&quot;hist&quot;</span><span class="s3">, </span><span class="s4">&quot;kde&quot;</span><span class="s3">, </span><span class="s4">&quot;density&quot;</span><span class="s3">, </span><span class="s4">&quot;area&quot;</span><span class="s3">, </span><span class="s4">&quot;pie&quot;</span><span class="s3">)</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_group_subplot</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">):</span>
        <span class="s1">pytest</span><span class="s3">.</span><span class="s1">importorskip</span><span class="s3">(</span><span class="s4">&quot;scipy&quot;</span><span class="s3">)</span>
        <span class="s1">d </span><span class="s3">= {</span>
            <span class="s4">&quot;a&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">10</span><span class="s3">),</span>
            <span class="s4">&quot;b&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">10</span><span class="s3">) + </span><span class="s6">1</span><span class="s3">,</span>
            <span class="s4">&quot;c&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">10</span><span class="s3">) + </span><span class="s6">1</span><span class="s3">,</span>
            <span class="s4">&quot;d&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">10</span><span class="s3">),</span>
            <span class="s4">&quot;e&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">10</span><span class="s3">),</span>
        <span class="s3">}</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">d</span><span class="s3">)</span>

        <span class="s1">axes </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">subplots</span><span class="s3">=[(</span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s4">&quot;e&quot;</span><span class="s3">), (</span><span class="s4">&quot;c&quot;</span><span class="s3">, </span><span class="s4">&quot;d&quot;</span><span class="s3">)], </span><span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">) == </span><span class="s6">3  </span><span class="s5"># 2 groups + single column a</span>

        <span class="s1">expected_labels </span><span class="s3">= ([</span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s4">&quot;e&quot;</span><span class="s3">], [</span><span class="s4">&quot;c&quot;</span><span class="s3">, </span><span class="s4">&quot;d&quot;</span><span class="s3">], [</span><span class="s4">&quot;a&quot;</span><span class="s3">])</span>
        <span class="s2">for </span><span class="s1">ax</span><span class="s3">, </span><span class="s1">labels </span><span class="s2">in </span><span class="s1">zip</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">, </span><span class="s1">expected_labels</span><span class="s3">):</span>
            <span class="s2">if </span><span class="s1">kind </span><span class="s3">!= </span><span class="s4">&quot;pie&quot;</span><span class="s3">:</span>
                <span class="s1">_check_legend_labels</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">labels</span><span class="s3">=</span><span class="s1">labels</span><span class="s3">)</span>
            <span class="s2">if </span><span class="s1">kind </span><span class="s3">== </span><span class="s4">&quot;line&quot;</span><span class="s3">:</span>
                <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">) == </span><span class="s1">len</span><span class="s3">(</span><span class="s1">labels</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_group_subplot_series_notimplemented</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">ser </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">range</span><span class="s3">(</span><span class="s6">1</span><span class="s3">))</span>
        <span class="s1">msg </span><span class="s3">= </span><span class="s4">&quot;An iterable subplots for a Series&quot;</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">NotImplementedError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s1">ser</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">subplots</span><span class="s3">=[(</span><span class="s4">&quot;a&quot;</span><span class="s3">,)])</span>

    <span class="s2">def </span><span class="s1">test_group_subplot_multiindex_notimplemented</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">eye</span><span class="s3">(</span><span class="s6">2</span><span class="s3">), </span><span class="s1">columns</span><span class="s3">=</span><span class="s1">MultiIndex</span><span class="s3">.</span><span class="s1">from_tuples</span><span class="s3">([(</span><span class="s6">0</span><span class="s3">, </span><span class="s6">1</span><span class="s3">), (</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">)]))</span>
        <span class="s1">msg </span><span class="s3">= </span><span class="s4">&quot;An iterable subplots for a DataFrame with a MultiIndex&quot;</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">NotImplementedError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">subplots</span><span class="s3">=[(</span><span class="s6">0</span><span class="s3">, </span><span class="s6">1</span><span class="s3">)])</span>

    <span class="s2">def </span><span class="s1">test_group_subplot_nonunique_cols_notimplemented</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">eye</span><span class="s3">(</span><span class="s6">2</span><span class="s3">), </span><span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;a&quot;</span><span class="s3">])</span>
        <span class="s1">msg </span><span class="s3">= </span><span class="s4">&quot;An iterable subplots for a DataFrame with non-unique&quot;</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">NotImplementedError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">subplots</span><span class="s3">=[(</span><span class="s4">&quot;a&quot;</span><span class="s3">,)])</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;subplots, expected_msg&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s3">(</span><span class="s6">123</span><span class="s3">, </span><span class="s4">&quot;subplots should be a bool or an iterable&quot;</span><span class="s3">),</span>
            <span class="s3">(</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;each entry should be a list/tuple&quot;</span><span class="s3">),  </span><span class="s5"># iterable of non-iterable</span>
            <span class="s3">((</span><span class="s6">1</span><span class="s3">,), </span><span class="s4">&quot;each entry should be a list/tuple&quot;</span><span class="s3">),  </span><span class="s5"># iterable of non-iterable</span>
            <span class="s3">((</span><span class="s4">&quot;a&quot;</span><span class="s3">,), </span><span class="s4">&quot;each entry should be a list/tuple&quot;</span><span class="s3">),  </span><span class="s5"># iterable of strings</span>
        <span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_group_subplot_bad_input</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">subplots</span><span class="s3">, </span><span class="s1">expected_msg</span><span class="s3">):</span>
        <span class="s5"># Make sure error is raised when subplots is not a properly</span>
        <span class="s5"># formatted iterable. Only iterables of iterables are permitted, and</span>
        <span class="s5"># entries should not be strings.</span>
        <span class="s1">d </span><span class="s3">= {</span><span class="s4">&quot;a&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">10</span><span class="s3">), </span><span class="s4">&quot;b&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">10</span><span class="s3">)}</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">d</span><span class="s3">)</span>

        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">ValueError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">expected_msg</span><span class="s3">):</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">subplots</span><span class="s3">=</span><span class="s1">subplots</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_group_subplot_invalid_column_name</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">d </span><span class="s3">= {</span><span class="s4">&quot;a&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">10</span><span class="s3">), </span><span class="s4">&quot;b&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">10</span><span class="s3">)}</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">d</span><span class="s3">)</span>

        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">ValueError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s4">r&quot;Column label\(s\) \['bad_name'\]&quot;</span><span class="s3">):</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">subplots</span><span class="s3">=[(</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;bad_name&quot;</span><span class="s3">)])</span>

    <span class="s2">def </span><span class="s1">test_group_subplot_duplicated_column</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">d </span><span class="s3">= {</span><span class="s4">&quot;a&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">10</span><span class="s3">), </span><span class="s4">&quot;b&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">10</span><span class="s3">), </span><span class="s4">&quot;c&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">10</span><span class="s3">)}</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">d</span><span class="s3">)</span>

        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">ValueError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s4">&quot;should be in only one subplot&quot;</span><span class="s3">):</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">subplots</span><span class="s3">=[(</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">), (</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;c&quot;</span><span class="s3">)])</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;kind&quot;</span><span class="s3">, (</span><span class="s4">&quot;box&quot;</span><span class="s3">, </span><span class="s4">&quot;scatter&quot;</span><span class="s3">, </span><span class="s4">&quot;hexbin&quot;</span><span class="s3">))</span>
    <span class="s2">def </span><span class="s1">test_group_subplot_invalid_kind</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">):</span>
        <span class="s1">d </span><span class="s3">= {</span><span class="s4">&quot;a&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">10</span><span class="s3">), </span><span class="s4">&quot;b&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s6">10</span><span class="s3">)}</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">d</span><span class="s3">)</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span>
            <span class="s1">ValueError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s4">&quot;When subplots is an iterable, kind must be one of&quot;</span>
        <span class="s3">):</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">subplots</span><span class="s3">=[(</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">)], </span><span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;index_name, old_label, new_label&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s3">(</span><span class="s2">None</span><span class="s3">, </span><span class="s4">&quot;&quot;</span><span class="s3">, </span><span class="s4">&quot;new&quot;</span><span class="s3">),</span>
            <span class="s3">(</span><span class="s4">&quot;old&quot;</span><span class="s3">, </span><span class="s4">&quot;old&quot;</span><span class="s3">, </span><span class="s4">&quot;new&quot;</span><span class="s3">),</span>
            <span class="s3">(</span><span class="s2">None</span><span class="s3">, </span><span class="s4">&quot;&quot;</span><span class="s3">, </span><span class="s4">&quot;&quot;</span><span class="s3">),</span>
            <span class="s3">(</span><span class="s2">None</span><span class="s3">, </span><span class="s4">&quot;&quot;</span><span class="s3">, </span><span class="s6">1</span><span class="s3">),</span>
            <span class="s3">(</span><span class="s2">None</span><span class="s3">, </span><span class="s4">&quot;&quot;</span><span class="s3">, [</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">]),</span>
        <span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;kind&quot;</span><span class="s3">, [</span><span class="s4">&quot;line&quot;</span><span class="s3">, </span><span class="s4">&quot;area&quot;</span><span class="s3">, </span><span class="s4">&quot;bar&quot;</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_xlabel_ylabel_dataframe_single_plot</span><span class="s3">(</span>
        <span class="s1">self</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">, </span><span class="s1">index_name</span><span class="s3">, </span><span class="s1">old_label</span><span class="s3">, </span><span class="s1">new_label</span>
    <span class="s3">):</span>
        <span class="s5"># GH 9093</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">([[</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">], [</span><span class="s6">2</span><span class="s3">, </span><span class="s6">5</span><span class="s3">]], </span><span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;Type A&quot;</span><span class="s3">, </span><span class="s4">&quot;Type B&quot;</span><span class="s3">])</span>
        <span class="s1">df</span><span class="s3">.</span><span class="s1">index</span><span class="s3">.</span><span class="s1">name </span><span class="s3">= </span><span class="s1">index_name</span>

        <span class="s5"># default is the ylabel is not shown and xlabel is index name</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xlabel</span><span class="s3">() == </span><span class="s1">old_label</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_ylabel</span><span class="s3">() == </span><span class="s4">&quot;&quot;</span>

        <span class="s5"># old xlabel will be overridden and assigned ylabel will be used as ylabel</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">, </span><span class="s1">ylabel</span><span class="s3">=</span><span class="s1">new_label</span><span class="s3">, </span><span class="s1">xlabel</span><span class="s3">=</span><span class="s1">new_label</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_ylabel</span><span class="s3">() == </span><span class="s1">str</span><span class="s3">(</span><span class="s1">new_label</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xlabel</span><span class="s3">() == </span><span class="s1">str</span><span class="s3">(</span><span class="s1">new_label</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;xlabel, ylabel&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s3">(</span><span class="s2">None</span><span class="s3">, </span><span class="s2">None</span><span class="s3">),</span>
            <span class="s3">(</span><span class="s4">&quot;X Label&quot;</span><span class="s3">, </span><span class="s2">None</span><span class="s3">),</span>
            <span class="s3">(</span><span class="s2">None</span><span class="s3">, </span><span class="s4">&quot;Y Label&quot;</span><span class="s3">),</span>
            <span class="s3">(</span><span class="s4">&quot;X Label&quot;</span><span class="s3">, </span><span class="s4">&quot;Y Label&quot;</span><span class="s3">),</span>
        <span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;kind&quot;</span><span class="s3">, [</span><span class="s4">&quot;scatter&quot;</span><span class="s3">, </span><span class="s4">&quot;hexbin&quot;</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_xlabel_ylabel_dataframe_plane_plot</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">, </span><span class="s1">xlabel</span><span class="s3">, </span><span class="s1">ylabel</span><span class="s3">):</span>
        <span class="s5"># GH 37001</span>
        <span class="s1">xcol </span><span class="s3">= </span><span class="s4">&quot;Type A&quot;</span>
        <span class="s1">ycol </span><span class="s3">= </span><span class="s4">&quot;Type B&quot;</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">([[</span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">], [</span><span class="s6">2</span><span class="s3">, </span><span class="s6">5</span><span class="s3">]], </span><span class="s1">columns</span><span class="s3">=[</span><span class="s1">xcol</span><span class="s3">, </span><span class="s1">ycol</span><span class="s3">])</span>

        <span class="s5"># default is the labels are column names</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">, </span><span class="s1">x</span><span class="s3">=</span><span class="s1">xcol</span><span class="s3">, </span><span class="s1">y</span><span class="s3">=</span><span class="s1">ycol</span><span class="s3">, </span><span class="s1">xlabel</span><span class="s3">=</span><span class="s1">xlabel</span><span class="s3">, </span><span class="s1">ylabel</span><span class="s3">=</span><span class="s1">ylabel</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xlabel</span><span class="s3">() == (</span><span class="s1">xcol </span><span class="s2">if </span><span class="s1">xlabel </span><span class="s2">is None else </span><span class="s1">xlabel</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_ylabel</span><span class="s3">() == (</span><span class="s1">ycol </span><span class="s2">if </span><span class="s1">ylabel </span><span class="s2">is None else </span><span class="s1">ylabel</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;secondary_y&quot;</span><span class="s3">, (</span><span class="s2">False</span><span class="s3">, </span><span class="s2">True</span><span class="s3">))</span>
    <span class="s2">def </span><span class="s1">test_secondary_y</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">secondary_y</span><span class="s3">):</span>
        <span class="s1">ax_df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">([</span><span class="s6">0</span><span class="s3">]).</span><span class="s1">plot</span><span class="s3">(</span>
            <span class="s1">secondary_y</span><span class="s3">=</span><span class="s1">secondary_y</span><span class="s3">, </span><span class="s1">ylabel</span><span class="s3">=</span><span class="s4">&quot;Y&quot;</span><span class="s3">, </span><span class="s1">ylim</span><span class="s3">=(</span><span class="s6">0</span><span class="s3">, </span><span class="s6">100</span><span class="s3">), </span><span class="s1">yticks</span><span class="s3">=[</span><span class="s6">99</span><span class="s3">]</span>
        <span class="s3">)</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">ax_df</span><span class="s3">.</span><span class="s1">figure</span><span class="s3">.</span><span class="s1">axes</span><span class="s3">:</span>
            <span class="s2">if </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">yaxis</span><span class="s3">.</span><span class="s1">get_visible</span><span class="s3">():</span>
                <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_ylabel</span><span class="s3">() == </span><span class="s4">&quot;Y&quot;</span>
                <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_ylim</span><span class="s3">() == (</span><span class="s6">0</span><span class="s3">, </span><span class="s6">100</span><span class="s3">)</span>
                <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_yticks</span><span class="s3">()[</span><span class="s6">0</span><span class="s3">] == </span><span class="s6">99</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s2">def </span><span class="s1">test_plot_no_warning</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s5"># GH 55138</span>
        <span class="s5"># TODO(3.0): this can be removed once Period[B] deprecation is enforced</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">makeTimeDataFrame</span><span class="s3">()</span>
        <span class="s2">with </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_produces_warning</span><span class="s3">(</span><span class="s2">False</span><span class="s3">):</span>
            <span class="s1">_ </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">()</span>
            <span class="s1">_ </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">T</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">()</span>


<span class="s2">def </span><span class="s1">_generate_4_axes_via_gridspec</span><span class="s3">():</span>
    <span class="s2">import </span><span class="s1">matplotlib</span><span class="s3">.</span><span class="s1">pyplot </span><span class="s2">as </span><span class="s1">plt</span>

    <span class="s1">gs </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">gridspec</span><span class="s3">.</span><span class="s1">GridSpec</span><span class="s3">(</span><span class="s6">2</span><span class="s3">, </span><span class="s6">2</span><span class="s3">)</span>
    <span class="s1">ax_tl </span><span class="s3">= </span><span class="s1">plt</span><span class="s3">.</span><span class="s1">subplot</span><span class="s3">(</span><span class="s1">gs</span><span class="s3">[</span><span class="s6">0</span><span class="s3">, </span><span class="s6">0</span><span class="s3">])</span>
    <span class="s1">ax_ll </span><span class="s3">= </span><span class="s1">plt</span><span class="s3">.</span><span class="s1">subplot</span><span class="s3">(</span><span class="s1">gs</span><span class="s3">[</span><span class="s6">1</span><span class="s3">, </span><span class="s6">0</span><span class="s3">])</span>
    <span class="s1">ax_tr </span><span class="s3">= </span><span class="s1">plt</span><span class="s3">.</span><span class="s1">subplot</span><span class="s3">(</span><span class="s1">gs</span><span class="s3">[</span><span class="s6">0</span><span class="s3">, </span><span class="s6">1</span><span class="s3">])</span>
    <span class="s1">ax_lr </span><span class="s3">= </span><span class="s1">plt</span><span class="s3">.</span><span class="s1">subplot</span><span class="s3">(</span><span class="s1">gs</span><span class="s3">[</span><span class="s6">1</span><span class="s3">, </span><span class="s6">1</span><span class="s3">])</span>

    <span class="s2">return </span><span class="s1">gs</span><span class="s3">, [</span><span class="s1">ax_tl</span><span class="s3">, </span><span class="s1">ax_ll</span><span class="s3">, </span><span class="s1">ax_tr</span><span class="s3">, </span><span class="s1">ax_lr</span><span class="s3">]</span>
</pre>
</body>
</html>