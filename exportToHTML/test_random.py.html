<html>
<head>
<title>test_random.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cf8e6d;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #2aacb8;}
.s4 { color: #7a7e85;}
.s5 { color: #6aab73;}
.s6 { color: #a5c261;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_random.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">warnings</span>

<span class="s0">import </span><span class="s1">pytest</span>

<span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">from </span><span class="s1">numpy</span><span class="s2">.</span><span class="s1">testing </span><span class="s0">import </span><span class="s2">(</span>
        <span class="s1">assert_</span><span class="s2">, </span><span class="s1">assert_raises</span><span class="s2">, </span><span class="s1">assert_equal</span><span class="s2">, </span><span class="s1">assert_warns</span><span class="s2">,</span>
        <span class="s1">assert_no_warnings</span><span class="s2">, </span><span class="s1">assert_array_equal</span><span class="s2">, </span><span class="s1">assert_array_almost_equal</span><span class="s2">,</span>
        <span class="s1">suppress_warnings</span><span class="s2">, </span><span class="s1">IS_WASM</span>
        <span class="s2">)</span>
<span class="s0">from </span><span class="s1">numpy </span><span class="s0">import </span><span class="s1">random</span>
<span class="s0">import </span><span class="s1">sys</span>


<span class="s0">class </span><span class="s1">TestSeed</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">test_scalar</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">(</span><span class="s3">0</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">s</span><span class="s2">.</span><span class="s1">randint</span><span class="s2">(</span><span class="s3">1000</span><span class="s2">), </span><span class="s3">684</span><span class="s2">)</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">(</span><span class="s3">4294967295</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">s</span><span class="s2">.</span><span class="s1">randint</span><span class="s2">(</span><span class="s3">1000</span><span class="s2">), </span><span class="s3">419</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_array</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">(</span><span class="s1">range</span><span class="s2">(</span><span class="s3">10</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">s</span><span class="s2">.</span><span class="s1">randint</span><span class="s2">(</span><span class="s3">1000</span><span class="s2">), </span><span class="s3">468</span><span class="s2">)</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s3">10</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">s</span><span class="s2">.</span><span class="s1">randint</span><span class="s2">(</span><span class="s3">1000</span><span class="s2">), </span><span class="s3">468</span><span class="s2">)</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">([</span><span class="s3">0</span><span class="s2">])</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">s</span><span class="s2">.</span><span class="s1">randint</span><span class="s2">(</span><span class="s3">1000</span><span class="s2">), </span><span class="s3">973</span><span class="s2">)</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">([</span><span class="s3">4294967295</span><span class="s2">])</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">s</span><span class="s2">.</span><span class="s1">randint</span><span class="s2">(</span><span class="s3">1000</span><span class="s2">), </span><span class="s3">265</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_invalid_scalar</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4"># seed must be an unsigned 32 bit integer</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">, -</span><span class="s3">0.5</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">, -</span><span class="s3">1</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_invalid_array</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4"># seed must be an unsigned 32 bit integer</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">, [-</span><span class="s3">0.5</span><span class="s2">])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">, [-</span><span class="s3">1</span><span class="s2">])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">, [</span><span class="s3">4294967296</span><span class="s2">])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">, [</span><span class="s3">1</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s3">4294967296</span><span class="s2">])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">, [</span><span class="s3">1</span><span class="s2">, -</span><span class="s3">2</span><span class="s2">, </span><span class="s3">4294967296</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_invalid_array_shape</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4"># gh-9832</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">,</span>
                      <span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">))</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">, [[</span><span class="s3">1</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s3">3</span><span class="s2">]])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">, [[</span><span class="s3">1</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s3">3</span><span class="s2">],</span>
                                                          <span class="s2">[</span><span class="s3">4</span><span class="s2">, </span><span class="s3">5</span><span class="s2">, </span><span class="s3">6</span><span class="s2">]])</span>


<span class="s0">class </span><span class="s1">TestBinomial</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">test_n_zero</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4"># Tests the corner case of n == 0 for the binomial distribution.</span>
        <span class="s4"># binomial(0, p) should be zero for any p in [0, 1].</span>
        <span class="s4"># This test addresses issue #3480.</span>
        <span class="s1">zeros </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">zeros</span><span class="s2">(</span><span class="s3">2</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s5">'int'</span><span class="s2">)</span>
        <span class="s0">for </span><span class="s1">p </span><span class="s0">in </span><span class="s2">[</span><span class="s3">0</span><span class="s2">, </span><span class="s3">.5</span><span class="s2">, </span><span class="s3">1</span><span class="s2">]:</span>
            <span class="s1">assert_</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">binomial</span><span class="s2">(</span><span class="s3">0</span><span class="s2">, </span><span class="s1">p</span><span class="s2">) == </span><span class="s3">0</span><span class="s2">)</span>
            <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">binomial</span><span class="s2">(</span><span class="s1">zeros</span><span class="s2">, </span><span class="s1">p</span><span class="s2">), </span><span class="s1">zeros</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_p_is_nan</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4"># Issue #4571.</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">binomial</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestMultinomial</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">test_basic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s3">100</span><span class="s2">, [</span><span class="s3">0.2</span><span class="s2">, </span><span class="s3">0.8</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_zero_probability</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s3">100</span><span class="s2">, [</span><span class="s3">0.2</span><span class="s2">, </span><span class="s3">0.8</span><span class="s2">, </span><span class="s3">0.0</span><span class="s2">, </span><span class="s3">0.0</span><span class="s2">, </span><span class="s3">0.0</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_int_negative_interval</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_</span><span class="s2">(-</span><span class="s3">5 </span><span class="s2">&lt;= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">randint</span><span class="s2">(-</span><span class="s3">5</span><span class="s2">, -</span><span class="s3">1</span><span class="s2">) &lt; -</span><span class="s3">1</span><span class="s2">)</span>
        <span class="s1">x </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">randint</span><span class="s2">(-</span><span class="s3">5</span><span class="s2">, -</span><span class="s3">1</span><span class="s2">, </span><span class="s3">5</span><span class="s2">)</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">all</span><span class="s2">(-</span><span class="s3">5 </span><span class="s2">&lt;= </span><span class="s1">x</span><span class="s2">))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">all</span><span class="s2">(</span><span class="s1">x </span><span class="s2">&lt; -</span><span class="s3">1</span><span class="s2">))</span>

    <span class="s0">def </span><span class="s1">test_size</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4"># gh-3173</span>
        <span class="s1">p </span><span class="s2">= [</span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">]</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s1">p</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint32</span><span class="s2">(</span><span class="s3">1</span><span class="s2">)).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s3">1</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s1">p</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint32</span><span class="s2">(</span><span class="s3">1</span><span class="s2">)).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s3">1</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s1">p</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint32</span><span class="s2">(</span><span class="s3">1</span><span class="s2">)).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s3">1</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s1">p</span><span class="s2">, [</span><span class="s3">2</span><span class="s2">, </span><span class="s3">2</span><span class="s2">]).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s3">2</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s1">p</span><span class="s2">, (</span><span class="s3">2</span><span class="s2">, </span><span class="s3">2</span><span class="s2">)).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s3">2</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s1">p</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">((</span><span class="s3">2</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))).</span><span class="s1">shape</span><span class="s2">,</span>
                     <span class="s2">(</span><span class="s3">2</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>

        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, </span><span class="s1">p</span><span class="s2">,</span>
                      <span class="s1">float</span><span class="s2">(</span><span class="s3">1</span><span class="s2">))</span>

    <span class="s0">def </span><span class="s1">test_multidimensional_pvals</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">, </span><span class="s3">10</span><span class="s2">, [[</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">]])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">, </span><span class="s3">10</span><span class="s2">, [[</span><span class="s3">0</span><span class="s2">], [</span><span class="s3">1</span><span class="s2">]])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">, </span><span class="s3">10</span><span class="s2">, [[[</span><span class="s3">0</span><span class="s2">], [</span><span class="s3">1</span><span class="s2">]], [[</span><span class="s3">1</span><span class="s2">], [</span><span class="s3">0</span><span class="s2">]]])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">, </span><span class="s3">10</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">], [</span><span class="s3">1</span><span class="s2">, </span><span class="s3">0</span><span class="s2">]]))</span>


<span class="s0">class </span><span class="s1">TestSetState</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">setup_method</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">seed </span><span class="s2">= </span><span class="s3">1234567890</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">prng </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">state </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">prng</span><span class="s2">.</span><span class="s1">get_state</span><span class="s2">()</span>

    <span class="s0">def </span><span class="s1">test_basic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">old </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">prng</span><span class="s2">.</span><span class="s1">tomaxint</span><span class="s2">(</span><span class="s3">16</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">prng</span><span class="s2">.</span><span class="s1">set_state</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">state</span><span class="s2">)</span>
        <span class="s1">new </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">prng</span><span class="s2">.</span><span class="s1">tomaxint</span><span class="s2">(</span><span class="s3">16</span><span class="s2">)</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">all</span><span class="s2">(</span><span class="s1">old </span><span class="s2">== </span><span class="s1">new</span><span class="s2">))</span>

    <span class="s0">def </span><span class="s1">test_gaussian_reset</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4"># Make sure the cached every-other-Gaussian is reset.</span>
        <span class="s1">old </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">prng</span><span class="s2">.</span><span class="s1">standard_normal</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=</span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">prng</span><span class="s2">.</span><span class="s1">set_state</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">state</span><span class="s2">)</span>
        <span class="s1">new </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">prng</span><span class="s2">.</span><span class="s1">standard_normal</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=</span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">all</span><span class="s2">(</span><span class="s1">old </span><span class="s2">== </span><span class="s1">new</span><span class="s2">))</span>

    <span class="s0">def </span><span class="s1">test_gaussian_reset_in_media_res</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4"># When the state is saved with a cached Gaussian, make sure the</span>
        <span class="s4"># cached Gaussian is restored.</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">prng</span><span class="s2">.</span><span class="s1">standard_normal</span><span class="s2">()</span>
        <span class="s1">state </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">prng</span><span class="s2">.</span><span class="s1">get_state</span><span class="s2">()</span>
        <span class="s1">old </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">prng</span><span class="s2">.</span><span class="s1">standard_normal</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=</span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">prng</span><span class="s2">.</span><span class="s1">set_state</span><span class="s2">(</span><span class="s1">state</span><span class="s2">)</span>
        <span class="s1">new </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">prng</span><span class="s2">.</span><span class="s1">standard_normal</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=</span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">all</span><span class="s2">(</span><span class="s1">old </span><span class="s2">== </span><span class="s1">new</span><span class="s2">))</span>

    <span class="s0">def </span><span class="s1">test_backwards_compatibility</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4"># Make sure we can accept old state tuples that do not have the</span>
        <span class="s4"># cached Gaussian value.</span>
        <span class="s1">old_state </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">state</span><span class="s2">[:-</span><span class="s3">2</span><span class="s2">]</span>
        <span class="s1">x1 </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">prng</span><span class="s2">.</span><span class="s1">standard_normal</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=</span><span class="s3">16</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">prng</span><span class="s2">.</span><span class="s1">set_state</span><span class="s2">(</span><span class="s1">old_state</span><span class="s2">)</span>
        <span class="s1">x2 </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">prng</span><span class="s2">.</span><span class="s1">standard_normal</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=</span><span class="s3">16</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">prng</span><span class="s2">.</span><span class="s1">set_state</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">state</span><span class="s2">)</span>
        <span class="s1">x3 </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">prng</span><span class="s2">.</span><span class="s1">standard_normal</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=</span><span class="s3">16</span><span class="s2">)</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">all</span><span class="s2">(</span><span class="s1">x1 </span><span class="s2">== </span><span class="s1">x2</span><span class="s2">))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">all</span><span class="s2">(</span><span class="s1">x1 </span><span class="s2">== </span><span class="s1">x3</span><span class="s2">))</span>

    <span class="s0">def </span><span class="s1">test_negative_binomial</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4"># Ensure that the negative binomial results take floating point</span>
        <span class="s4"># arguments without truncation.</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">prng</span><span class="s2">.</span><span class="s1">negative_binomial</span><span class="s2">(</span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestRandint</span><span class="s2">:</span>

    <span class="s1">rfunc </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">randint</span>

    <span class="s4"># valid integer/boolean types</span>
    <span class="s1">itype </span><span class="s2">= [</span><span class="s1">np</span><span class="s2">.</span><span class="s1">bool_</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">int8</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint8</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">int16</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint16</span><span class="s2">,</span>
             <span class="s1">np</span><span class="s2">.</span><span class="s1">int32</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint32</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint64</span><span class="s2">]</span>

    <span class="s0">def </span><span class="s1">test_unsupported_type</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">float</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_bounds_checking</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">itype</span><span class="s2">:</span>
            <span class="s1">lbnd </span><span class="s2">= </span><span class="s3">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">np</span><span class="s2">.</span><span class="s1">bool_ </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">min</span>
            <span class="s1">ubnd </span><span class="s2">= </span><span class="s3">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">np</span><span class="s2">.</span><span class="s1">bool_ </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">max </span><span class="s2">+ </span><span class="s3">1</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">, </span><span class="s1">lbnd </span><span class="s2">- </span><span class="s3">1</span><span class="s2">, </span><span class="s1">ubnd</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">, </span><span class="s1">lbnd</span><span class="s2">, </span><span class="s1">ubnd </span><span class="s2">+ </span><span class="s3">1</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">, </span><span class="s1">ubnd</span><span class="s2">, </span><span class="s1">lbnd</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, </span><span class="s3">0</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_rng_zero_and_extremes</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">itype</span><span class="s2">:</span>
            <span class="s1">lbnd </span><span class="s2">= </span><span class="s3">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">np</span><span class="s2">.</span><span class="s1">bool_ </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">min</span>
            <span class="s1">ubnd </span><span class="s2">= </span><span class="s3">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">np</span><span class="s2">.</span><span class="s1">bool_ </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">max </span><span class="s2">+ </span><span class="s3">1</span>

            <span class="s1">tgt </span><span class="s2">= </span><span class="s1">ubnd </span><span class="s2">- </span><span class="s3">1</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span><span class="s1">tgt</span><span class="s2">, </span><span class="s1">tgt </span><span class="s2">+ </span><span class="s3">1</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s3">1000</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">), </span><span class="s1">tgt</span><span class="s2">)</span>

            <span class="s1">tgt </span><span class="s2">= </span><span class="s1">lbnd</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span><span class="s1">tgt</span><span class="s2">, </span><span class="s1">tgt </span><span class="s2">+ </span><span class="s3">1</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s3">1000</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">), </span><span class="s1">tgt</span><span class="s2">)</span>

            <span class="s1">tgt </span><span class="s2">= (</span><span class="s1">lbnd </span><span class="s2">+ </span><span class="s1">ubnd</span><span class="s2">)//</span><span class="s3">2</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span><span class="s1">tgt</span><span class="s2">, </span><span class="s1">tgt </span><span class="s2">+ </span><span class="s3">1</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s3">1000</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">), </span><span class="s1">tgt</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_full_range</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4"># Test for ticket #1690</span>

        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">itype</span><span class="s2">:</span>
            <span class="s1">lbnd </span><span class="s2">= </span><span class="s3">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">np</span><span class="s2">.</span><span class="s1">bool_ </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">min</span>
            <span class="s1">ubnd </span><span class="s2">= </span><span class="s3">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">np</span><span class="s2">.</span><span class="s1">bool_ </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">max </span><span class="s2">+ </span><span class="s3">1</span>

            <span class="s0">try</span><span class="s2">:</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span><span class="s1">lbnd</span><span class="s2">, </span><span class="s1">ubnd</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s0">except </span><span class="s1">Exception </span><span class="s0">as </span><span class="s1">e</span><span class="s2">:</span>
                <span class="s0">raise </span><span class="s1">AssertionError</span><span class="s2">(</span><span class="s5">&quot;No error should have been raised, &quot;</span>
                                     <span class="s5">&quot;but one was with the following &quot;</span>
                                     <span class="s5">&quot;message:</span><span class="s0">\n\n</span><span class="s5">%s&quot; </span><span class="s2">% </span><span class="s1">str</span><span class="s2">(</span><span class="s1">e</span><span class="s2">))</span>

    <span class="s0">def </span><span class="s1">test_in_bounds_fuzz</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4"># Don't use fixed seed</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">()</span>

        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">itype</span><span class="s2">[</span><span class="s3">1</span><span class="s2">:]:</span>
            <span class="s0">for </span><span class="s1">ubnd </span><span class="s0">in </span><span class="s2">[</span><span class="s3">4</span><span class="s2">, </span><span class="s3">8</span><span class="s2">, </span><span class="s3">16</span><span class="s2">]:</span>
                <span class="s1">vals </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span><span class="s3">2</span><span class="s2">, </span><span class="s1">ubnd</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s3">2</span><span class="s2">**</span><span class="s3">16</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
                <span class="s1">assert_</span><span class="s2">(</span><span class="s1">vals</span><span class="s2">.</span><span class="s1">max</span><span class="s2">() &lt; </span><span class="s1">ubnd</span><span class="s2">)</span>
                <span class="s1">assert_</span><span class="s2">(</span><span class="s1">vals</span><span class="s2">.</span><span class="s1">min</span><span class="s2">() &gt;= </span><span class="s3">2</span><span class="s2">)</span>

        <span class="s1">vals </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span><span class="s3">0</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s3">2</span><span class="s2">**</span><span class="s3">16</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">bool_</span><span class="s2">)</span>

        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">vals</span><span class="s2">.</span><span class="s1">max</span><span class="s2">() &lt; </span><span class="s3">2</span><span class="s2">)</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">vals</span><span class="s2">.</span><span class="s1">min</span><span class="s2">() &gt;= </span><span class="s3">0</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_repeatability</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">import </span><span class="s1">hashlib</span>
        <span class="s4"># We use a sha256 hash of generated sequences of 1000 samples</span>
        <span class="s4"># in the range [0, 6) for all but bool, where the range</span>
        <span class="s4"># is [0, 2). Hashes are for little endian numbers.</span>
        <span class="s1">tgt </span><span class="s2">= {</span><span class="s5">'bool'</span><span class="s2">: </span><span class="s5">'509aea74d792fb931784c4b0135392c65aec64beee12b0cc167548a2c3d31e71'</span><span class="s2">,</span>
               <span class="s5">'int16'</span><span class="s2">: </span><span class="s5">'7b07f1a920e46f6d0fe02314155a2330bcfd7635e708da50e536c5ebb631a7d4'</span><span class="s2">,</span>
               <span class="s5">'int32'</span><span class="s2">: </span><span class="s5">'e577bfed6c935de944424667e3da285012e741892dcb7051a8f1ce68ab05c92f'</span><span class="s2">,</span>
               <span class="s5">'int64'</span><span class="s2">: </span><span class="s5">'0fbead0b06759df2cfb55e43148822d4a1ff953c7eb19a5b08445a63bb64fa9e'</span><span class="s2">,</span>
               <span class="s5">'int8'</span><span class="s2">: </span><span class="s5">'001aac3a5acb935a9b186cbe14a1ca064b8bb2dd0b045d48abeacf74d0203404'</span><span class="s2">,</span>
               <span class="s5">'uint16'</span><span class="s2">: </span><span class="s5">'7b07f1a920e46f6d0fe02314155a2330bcfd7635e708da50e536c5ebb631a7d4'</span><span class="s2">,</span>
               <span class="s5">'uint32'</span><span class="s2">: </span><span class="s5">'e577bfed6c935de944424667e3da285012e741892dcb7051a8f1ce68ab05c92f'</span><span class="s2">,</span>
               <span class="s5">'uint64'</span><span class="s2">: </span><span class="s5">'0fbead0b06759df2cfb55e43148822d4a1ff953c7eb19a5b08445a63bb64fa9e'</span><span class="s2">,</span>
               <span class="s5">'uint8'</span><span class="s2">: </span><span class="s5">'001aac3a5acb935a9b186cbe14a1ca064b8bb2dd0b045d48abeacf74d0203404'</span><span class="s2">}</span>

        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">itype</span><span class="s2">[</span><span class="s3">1</span><span class="s2">:]:</span>
            <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s3">1234</span><span class="s2">)</span>

            <span class="s4"># view as little endian for hash</span>
            <span class="s0">if </span><span class="s1">sys</span><span class="s2">.</span><span class="s1">byteorder </span><span class="s2">== </span><span class="s5">'little'</span><span class="s2">:</span>
                <span class="s1">val </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span><span class="s3">0</span><span class="s2">, </span><span class="s3">6</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s3">1000</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s0">else</span><span class="s2">:</span>
                <span class="s1">val </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span><span class="s3">0</span><span class="s2">, </span><span class="s3">6</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s3">1000</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">byteswap</span><span class="s2">()</span>

            <span class="s1">res </span><span class="s2">= </span><span class="s1">hashlib</span><span class="s2">.</span><span class="s1">sha256</span><span class="s2">(</span><span class="s1">val</span><span class="s2">.</span><span class="s1">view</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int8</span><span class="s2">)).</span><span class="s1">hexdigest</span><span class="s2">()</span>
            <span class="s1">assert_</span><span class="s2">(</span><span class="s1">tgt</span><span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">dtype</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">name</span><span class="s2">] == </span><span class="s1">res</span><span class="s2">)</span>

        <span class="s4"># bools do not depend on endianness</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s3">1234</span><span class="s2">)</span>
        <span class="s1">val </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span><span class="s3">0</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s3">1000</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">bool</span><span class="s2">).</span><span class="s1">view</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int8</span><span class="s2">)</span>
        <span class="s1">res </span><span class="s2">= </span><span class="s1">hashlib</span><span class="s2">.</span><span class="s1">sha256</span><span class="s2">(</span><span class="s1">val</span><span class="s2">).</span><span class="s1">hexdigest</span><span class="s2">()</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">tgt</span><span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">dtype</span><span class="s2">(</span><span class="s1">bool</span><span class="s2">).</span><span class="s1">name</span><span class="s2">] == </span><span class="s1">res</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_int64_uint64_corner_case</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4"># When stored in Numpy arrays, `lbnd` is casted</span>
        <span class="s4"># as np.int64, and `ubnd` is casted as np.uint64.</span>
        <span class="s4"># Checking whether `lbnd` &gt;= `ubnd` used to be</span>
        <span class="s4"># done solely via direct comparison, which is incorrect</span>
        <span class="s4"># because when Numpy tries to compare both numbers,</span>
        <span class="s4"># it casts both to np.float64 because there is</span>
        <span class="s4"># no integer superset of np.int64 and np.uint64. However,</span>
        <span class="s4"># `ubnd` is too large to be represented in np.float64,</span>
        <span class="s4"># causing it be round down to np.iinfo(np.int64).max,</span>
        <span class="s4"># leading to a ValueError because `lbnd` now equals</span>
        <span class="s4"># the new `ubnd`.</span>

        <span class="s1">dt </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span>
        <span class="s1">tgt </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">).</span><span class="s1">max</span>
        <span class="s1">lbnd </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">).</span><span class="s1">max</span><span class="s2">)</span>
        <span class="s1">ubnd </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint64</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">).</span><span class="s1">max </span><span class="s2">+ </span><span class="s3">1</span><span class="s2">)</span>

        <span class="s4"># None of these function calls should</span>
        <span class="s4"># generate a ValueError now.</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">randint</span><span class="s2">(</span><span class="s1">lbnd</span><span class="s2">, </span><span class="s1">ubnd</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">tgt</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_respect_dtype_singleton</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4"># See gh-7203</span>
        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">itype</span><span class="s2">:</span>
            <span class="s1">lbnd </span><span class="s2">= </span><span class="s3">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">np</span><span class="s2">.</span><span class="s1">bool_ </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">min</span>
            <span class="s1">ubnd </span><span class="s2">= </span><span class="s3">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">np</span><span class="s2">.</span><span class="s1">bool_ </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">max </span><span class="s2">+ </span><span class="s3">1</span>

            <span class="s1">sample </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span><span class="s1">lbnd</span><span class="s2">, </span><span class="s1">ubnd</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">sample</span><span class="s2">.</span><span class="s1">dtype</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">dtype</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">))</span>

        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s2">(</span><span class="s1">bool</span><span class="s2">, </span><span class="s1">int</span><span class="s2">):</span>
            <span class="s1">lbnd </span><span class="s2">= </span><span class="s3">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">min</span>
            <span class="s1">ubnd </span><span class="s2">= </span><span class="s3">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">max </span><span class="s2">+ </span><span class="s3">1</span>

            <span class="s4"># gh-7284: Ensure that we get Python data types</span>
            <span class="s1">sample </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span><span class="s1">lbnd</span><span class="s2">, </span><span class="s1">ubnd</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s1">assert_</span><span class="s2">(</span><span class="s0">not </span><span class="s1">hasattr</span><span class="s2">(</span><span class="s1">sample</span><span class="s2">, </span><span class="s5">'dtype'</span><span class="s2">))</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">type</span><span class="s2">(</span><span class="s1">sample</span><span class="s2">), </span><span class="s1">dt</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestRandomDist</span><span class="s2">:</span>
    <span class="s4"># Make sure the random distribution returns the correct value for a</span>
    <span class="s4"># given seed</span>

    <span class="s0">def </span><span class="s1">setup_method</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">seed </span><span class="s2">= </span><span class="s3">1234567890</span>

    <span class="s0">def </span><span class="s1">test_rand</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">rand</span><span class="s2">(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">0.61879477158567997</span><span class="s2">, </span><span class="s3">0.59162362775974664</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">0.88868358904449662</span><span class="s2">, </span><span class="s3">0.89165480011560816</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">0.4575674820298663</span><span class="s2">, </span><span class="s3">0.7781880808593471</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_randn</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">randn</span><span class="s2">(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">1.34016345771863121</span><span class="s2">, </span><span class="s3">1.73759122771936081</span><span class="s2">],</span>
                           <span class="s2">[</span><span class="s3">1.498988344300628</span><span class="s2">, -</span><span class="s3">0.2286433324536169</span><span class="s2">],</span>
                           <span class="s2">[</span><span class="s3">2.031033998682787</span><span class="s2">, </span><span class="s3">2.17032494605655257</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_randint</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">randint</span><span class="s2">(-</span><span class="s3">99</span><span class="s2">, </span><span class="s3">99</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">31</span><span class="s2">, </span><span class="s3">3</span><span class="s2">],</span>
                            <span class="s2">[-</span><span class="s3">52</span><span class="s2">, </span><span class="s3">41</span><span class="s2">],</span>
                            <span class="s2">[-</span><span class="s3">48</span><span class="s2">, -</span><span class="s3">66</span><span class="s2">]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_random_integers</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s0">with </span><span class="s1">suppress_warnings</span><span class="s2">() </span><span class="s0">as </span><span class="s1">sup</span><span class="s2">:</span>
            <span class="s1">w </span><span class="s2">= </span><span class="s1">sup</span><span class="s2">.</span><span class="s1">record</span><span class="s2">(</span><span class="s1">DeprecationWarning</span><span class="s2">)</span>
            <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">random_integers</span><span class="s2">(-</span><span class="s3">99</span><span class="s2">, </span><span class="s3">99</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
            <span class="s1">assert_</span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">w</span><span class="s2">) == </span><span class="s3">1</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">31</span><span class="s2">, </span><span class="s3">3</span><span class="s2">],</span>
                            <span class="s2">[-</span><span class="s3">52</span><span class="s2">, </span><span class="s3">41</span><span class="s2">],</span>
                            <span class="s2">[-</span><span class="s3">48</span><span class="s2">, -</span><span class="s3">66</span><span class="s2">]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_random_integers_max_int</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4"># Tests whether random_integers can generate the</span>
        <span class="s4"># maximum allowed Python int that can be converted</span>
        <span class="s4"># into a C long. Previous implementations of this</span>
        <span class="s4"># method have thrown an OverflowError when attempting</span>
        <span class="s4"># to generate this integer.</span>
        <span class="s0">with </span><span class="s1">suppress_warnings</span><span class="s2">() </span><span class="s0">as </span><span class="s1">sup</span><span class="s2">:</span>
            <span class="s1">w </span><span class="s2">= </span><span class="s1">sup</span><span class="s2">.</span><span class="s1">record</span><span class="s2">(</span><span class="s1">DeprecationWarning</span><span class="s2">)</span>
            <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">random_integers</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s5">'l'</span><span class="s2">).</span><span class="s1">max</span><span class="s2">,</span>
                                               <span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s5">'l'</span><span class="s2">).</span><span class="s1">max</span><span class="s2">)</span>
            <span class="s1">assert_</span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">w</span><span class="s2">) == </span><span class="s3">1</span><span class="s2">)</span>

        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s5">'l'</span><span class="s2">).</span><span class="s1">max</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_random_integers_deprecated</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">with </span><span class="s1">warnings</span><span class="s2">.</span><span class="s1">catch_warnings</span><span class="s2">():</span>
            <span class="s1">warnings</span><span class="s2">.</span><span class="s1">simplefilter</span><span class="s2">(</span><span class="s5">&quot;error&quot;</span><span class="s2">, </span><span class="s1">DeprecationWarning</span><span class="s2">)</span>

            <span class="s4"># DeprecationWarning raised with high == None</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">DeprecationWarning</span><span class="s2">,</span>
                          <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">random_integers</span><span class="s2">,</span>
                          <span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s5">'l'</span><span class="s2">).</span><span class="s1">max</span><span class="s2">)</span>

            <span class="s4"># DeprecationWarning raised with high != None</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">DeprecationWarning</span><span class="s2">,</span>
                          <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">random_integers</span><span class="s2">,</span>
                          <span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s5">'l'</span><span class="s2">).</span><span class="s1">max</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s5">'l'</span><span class="s2">).</span><span class="s1">max</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_random</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">random</span><span class="s2">((</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">0.61879477158567997</span><span class="s2">, </span><span class="s3">0.59162362775974664</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">0.88868358904449662</span><span class="s2">, </span><span class="s3">0.89165480011560816</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">0.4575674820298663</span><span class="s2">, </span><span class="s3">0.7781880808593471</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_choice_uniform_replace</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s3">4</span><span class="s2">, </span><span class="s3">4</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">2</span><span class="s2">, </span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s3">3</span><span class="s2">])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_choice_nonuniform_replace</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s3">4</span><span class="s2">, </span><span class="s3">4</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=[</span><span class="s3">0.4</span><span class="s2">, </span><span class="s3">0.4</span><span class="s2">, </span><span class="s3">0.1</span><span class="s2">, </span><span class="s3">0.1</span><span class="s2">])</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">1</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s3">2</span><span class="s2">])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_choice_uniform_noreplace</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s3">4</span><span class="s2">, </span><span class="s3">3</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, </span><span class="s3">3</span><span class="s2">])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_choice_nonuniform_noreplace</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s3">4</span><span class="s2">, </span><span class="s3">3</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">,</span>
                                  <span class="s1">p</span><span class="s2">=[</span><span class="s3">0.1</span><span class="s2">, </span><span class="s3">0.3</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.1</span><span class="s2">])</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">2</span><span class="s2">, </span><span class="s3">3</span><span class="s2">, </span><span class="s3">1</span><span class="s2">])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_choice_noninteger</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">([</span><span class="s5">'a'</span><span class="s2">, </span><span class="s5">'b'</span><span class="s2">, </span><span class="s5">'c'</span><span class="s2">, </span><span class="s5">'d'</span><span class="s2">], </span><span class="s3">4</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s5">'c'</span><span class="s2">, </span><span class="s5">'d'</span><span class="s2">, </span><span class="s5">'c'</span><span class="s2">, </span><span class="s5">'d'</span><span class="s2">])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_choice_exceptions</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">sample </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, -</span><span class="s3">1</span><span class="s2">, </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, </span><span class="s3">3.</span><span class="s2">, </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, [[</span><span class="s3">1</span><span class="s2">, </span><span class="s3">2</span><span class="s2">], [</span><span class="s3">3</span><span class="s2">, </span><span class="s3">4</span><span class="s2">]], </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, [], </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, [</span><span class="s3">1</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s3">3</span><span class="s2">, </span><span class="s3">4</span><span class="s2">], </span><span class="s3">3</span><span class="s2">,</span>
                      <span class="s1">p</span><span class="s2">=[[</span><span class="s3">0.25</span><span class="s2">, </span><span class="s3">0.25</span><span class="s2">], [</span><span class="s3">0.25</span><span class="s2">, </span><span class="s3">0.25</span><span class="s2">]])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, [</span><span class="s3">1</span><span class="s2">, </span><span class="s3">2</span><span class="s2">], </span><span class="s3">3</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=[</span><span class="s3">0.4</span><span class="s2">, </span><span class="s3">0.4</span><span class="s2">, </span><span class="s3">0.2</span><span class="s2">])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, [</span><span class="s3">1</span><span class="s2">, </span><span class="s3">2</span><span class="s2">], </span><span class="s3">3</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=[</span><span class="s3">1.1</span><span class="s2">, -</span><span class="s3">0.1</span><span class="s2">])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, [</span><span class="s3">1</span><span class="s2">, </span><span class="s3">2</span><span class="s2">], </span><span class="s3">3</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=[</span><span class="s3">0.4</span><span class="s2">, </span><span class="s3">0.4</span><span class="s2">])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, [</span><span class="s3">1</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s3">3</span><span class="s2">], </span><span class="s3">4</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s4"># gh-13087</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, [</span><span class="s3">1</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s3">3</span><span class="s2">], -</span><span class="s3">2</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, [</span><span class="s3">1</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s3">3</span><span class="s2">], (-</span><span class="s3">1</span><span class="s2">,), </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, [</span><span class="s3">1</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s3">3</span><span class="s2">], (-</span><span class="s3">1</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, [</span><span class="s3">1</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s3">3</span><span class="s2">], </span><span class="s3">2</span><span class="s2">,</span>
                      <span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=[</span><span class="s3">1</span><span class="s2">, </span><span class="s3">0</span><span class="s2">, </span><span class="s3">0</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_choice_return_shape</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">p </span><span class="s2">= [</span><span class="s3">0.1</span><span class="s2">, </span><span class="s3">0.9</span><span class="s2">]</span>
        <span class="s4"># Check scalar</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">isscalar</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s3">2</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">isscalar</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s3">2</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">isscalar</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s3">2</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=</span><span class="s1">p</span><span class="s2">)))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">isscalar</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s3">2</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=</span><span class="s1">p</span><span class="s2">)))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">isscalar</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">([</span><span class="s3">1</span><span class="s2">, </span><span class="s3">2</span><span class="s2">], </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">([</span><span class="s0">None</span><span class="s2">], </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">) </span><span class="s0">is None</span><span class="s2">)</span>
        <span class="s1">a </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">1</span><span class="s2">, </span><span class="s3">2</span><span class="s2">])</span>
        <span class="s1">arr </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">empty</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">)</span>
        <span class="s1">arr</span><span class="s2">[</span><span class="s3">0</span><span class="s2">] = </span><span class="s1">a</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s1">arr</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">) </span><span class="s0">is </span><span class="s1">a</span><span class="s2">)</span>

        <span class="s4"># Check 0-d array</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">tuple</span><span class="s2">()</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s0">not </span><span class="s1">np</span><span class="s2">.</span><span class="s1">isscalar</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s3">2</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s0">not </span><span class="s1">np</span><span class="s2">.</span><span class="s1">isscalar</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s3">2</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s0">not </span><span class="s1">np</span><span class="s2">.</span><span class="s1">isscalar</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s3">2</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=</span><span class="s1">p</span><span class="s2">)))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s0">not </span><span class="s1">np</span><span class="s2">.</span><span class="s1">isscalar</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s3">2</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=</span><span class="s1">p</span><span class="s2">)))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s0">not </span><span class="s1">np</span><span class="s2">.</span><span class="s1">isscalar</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">([</span><span class="s3">1</span><span class="s2">, </span><span class="s3">2</span><span class="s2">], </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">([</span><span class="s0">None</span><span class="s2">], </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">).</span><span class="s1">ndim </span><span class="s2">== </span><span class="s3">0</span><span class="s2">)</span>
        <span class="s1">a </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">1</span><span class="s2">, </span><span class="s3">2</span><span class="s2">])</span>
        <span class="s1">arr </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">empty</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">)</span>
        <span class="s1">arr</span><span class="s2">[</span><span class="s3">0</span><span class="s2">] = </span><span class="s1">a</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s1">arr</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">).</span><span class="s1">item</span><span class="s2">() </span><span class="s0">is </span><span class="s1">a</span><span class="s2">)</span>

        <span class="s4"># Check multi dimensional array</span>
        <span class="s1">s </span><span class="s2">= (</span><span class="s3">2</span><span class="s2">, </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">p </span><span class="s2">= [</span><span class="s3">0.1</span><span class="s2">, </span><span class="s3">0.1</span><span class="s2">, </span><span class="s3">0.1</span><span class="s2">, </span><span class="s3">0.1</span><span class="s2">, </span><span class="s3">0.4</span><span class="s2">, </span><span class="s3">0.2</span><span class="s2">]</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s3">6</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">).</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">s</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s3">6</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">).</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">s</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s3">6</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=</span><span class="s1">p</span><span class="s2">).</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">s</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s3">6</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=</span><span class="s1">p</span><span class="s2">).</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">s</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s3">6</span><span class="s2">), </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">).</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">s</span><span class="s2">)</span>

        <span class="s4"># Check zero-size</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">randint</span><span class="s2">(</span><span class="s3">0</span><span class="s2">, </span><span class="s3">0</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">0</span><span class="s2">, </span><span class="s3">4</span><span class="s2">)).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s3">3</span><span class="s2">, </span><span class="s3">0</span><span class="s2">, </span><span class="s3">4</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">randint</span><span class="s2">(</span><span class="s3">0</span><span class="s2">, -</span><span class="s3">10</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s3">0</span><span class="s2">).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">,))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">randint</span><span class="s2">(</span><span class="s3">10</span><span class="s2">, </span><span class="s3">10</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s3">0</span><span class="s2">).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">,))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s3">0</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s3">0</span><span class="s2">).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">,))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">([], </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">0</span><span class="s2">,)).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">,))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">([</span><span class="s5">'a'</span><span class="s2">, </span><span class="s5">'b'</span><span class="s2">], </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">0</span><span class="s2">, </span><span class="s3">4</span><span class="s2">)).</span><span class="s1">shape</span><span class="s2">,</span>
                     <span class="s2">(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">0</span><span class="s2">, </span><span class="s3">4</span><span class="s2">))</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">, [], </span><span class="s3">10</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_choice_nan_probabilities</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">a </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">42</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, </span><span class="s3">2</span><span class="s2">])</span>
        <span class="s1">p </span><span class="s2">= [</span><span class="s0">None</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, </span><span class="s0">None</span><span class="s2">]</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">, </span><span class="s1">a</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=</span><span class="s1">p</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_bytes</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">bytes</span><span class="s2">(</span><span class="s3">10</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s6">b'</span><span class="s0">\x82</span><span class="s6">Ui</span><span class="s0">\x9e\xff\x97</span><span class="s6">+Wf</span><span class="s0">\xa5</span><span class="s6">'</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_shuffle</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4"># Test lists, arrays (of various dtypes), and multidimensional versions</span>
        <span class="s4"># of both, c-contiguous or not:</span>
        <span class="s0">for </span><span class="s1">conv </span><span class="s0">in </span><span class="s2">[</span><span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([]),</span>
                     <span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">x</span><span class="s2">,</span>
                     <span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">(</span><span class="s1">x</span><span class="s2">).</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int8</span><span class="s2">),</span>
                     <span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">(</span><span class="s1">x</span><span class="s2">).</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">float32</span><span class="s2">),</span>
                     <span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">(</span><span class="s1">x</span><span class="s2">).</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">complex64</span><span class="s2">),</span>
                     <span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">(</span><span class="s1">x</span><span class="s2">).</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">object</span><span class="s2">),</span>
                     <span class="s0">lambda </span><span class="s1">x</span><span class="s2">: [(</span><span class="s1">i</span><span class="s2">, </span><span class="s1">i</span><span class="s2">) </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">x</span><span class="s2">],</span>
                     <span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">([[</span><span class="s1">i</span><span class="s2">, </span><span class="s1">i</span><span class="s2">] </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">x</span><span class="s2">]),</span>
                     <span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">vstack</span><span class="s2">([</span><span class="s1">x</span><span class="s2">, </span><span class="s1">x</span><span class="s2">]).</span><span class="s1">T</span><span class="s2">,</span>
                     <span class="s4"># gh-11442</span>
                     <span class="s0">lambda </span><span class="s1">x</span><span class="s2">: (</span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">([(</span><span class="s1">i</span><span class="s2">, </span><span class="s1">i</span><span class="s2">) </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">x</span><span class="s2">],</span>
                                           <span class="s2">[(</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s1">int</span><span class="s2">), (</span><span class="s5">&quot;b&quot;</span><span class="s2">, </span><span class="s1">int</span><span class="s2">)])</span>
                                <span class="s2">.</span><span class="s1">view</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">recarray</span><span class="s2">)),</span>
                     <span class="s4"># gh-4270</span>
                     <span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">([(</span><span class="s1">i</span><span class="s2">, </span><span class="s1">i</span><span class="s2">) </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">x</span><span class="s2">],</span>
                                          <span class="s2">[(</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s1">object</span><span class="s2">), (</span><span class="s5">&quot;b&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">int32</span><span class="s2">)])]:</span>
            <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
            <span class="s1">alist </span><span class="s2">= </span><span class="s1">conv</span><span class="s2">([</span><span class="s3">1</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s3">3</span><span class="s2">, </span><span class="s3">4</span><span class="s2">, </span><span class="s3">5</span><span class="s2">, </span><span class="s3">6</span><span class="s2">, </span><span class="s3">7</span><span class="s2">, </span><span class="s3">8</span><span class="s2">, </span><span class="s3">9</span><span class="s2">, </span><span class="s3">0</span><span class="s2">])</span>
            <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">shuffle</span><span class="s2">(</span><span class="s1">alist</span><span class="s2">)</span>
            <span class="s1">actual </span><span class="s2">= </span><span class="s1">alist</span>
            <span class="s1">desired </span><span class="s2">= </span><span class="s1">conv</span><span class="s2">([</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, </span><span class="s3">9</span><span class="s2">, </span><span class="s3">6</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s3">4</span><span class="s2">, </span><span class="s3">5</span><span class="s2">, </span><span class="s3">8</span><span class="s2">, </span><span class="s3">7</span><span class="s2">, </span><span class="s3">3</span><span class="s2">])</span>
            <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_shuffle_masked</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4"># gh-3263</span>
        <span class="s1">a </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">ma</span><span class="s2">.</span><span class="s1">masked_values</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">reshape</span><span class="s2">(</span><span class="s1">range</span><span class="s2">(</span><span class="s3">20</span><span class="s2">), (</span><span class="s3">5</span><span class="s2">, </span><span class="s3">4</span><span class="s2">)) % </span><span class="s3">3 </span><span class="s2">- </span><span class="s3">1</span><span class="s2">, -</span><span class="s3">1</span><span class="s2">)</span>
        <span class="s1">b </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">ma</span><span class="s2">.</span><span class="s1">masked_values</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s3">20</span><span class="s2">) % </span><span class="s3">3 </span><span class="s2">- </span><span class="s3">1</span><span class="s2">, -</span><span class="s3">1</span><span class="s2">)</span>
        <span class="s1">a_orig </span><span class="s2">= </span><span class="s1">a</span><span class="s2">.</span><span class="s1">copy</span><span class="s2">()</span>
        <span class="s1">b_orig </span><span class="s2">= </span><span class="s1">b</span><span class="s2">.</span><span class="s1">copy</span><span class="s2">()</span>
        <span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">range</span><span class="s2">(</span><span class="s3">50</span><span class="s2">):</span>
            <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">shuffle</span><span class="s2">(</span><span class="s1">a</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span>
                <span class="s1">sorted</span><span class="s2">(</span><span class="s1">a</span><span class="s2">.</span><span class="s1">data</span><span class="s2">[~</span><span class="s1">a</span><span class="s2">.</span><span class="s1">mask</span><span class="s2">]), </span><span class="s1">sorted</span><span class="s2">(</span><span class="s1">a_orig</span><span class="s2">.</span><span class="s1">data</span><span class="s2">[~</span><span class="s1">a_orig</span><span class="s2">.</span><span class="s1">mask</span><span class="s2">]))</span>
            <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">shuffle</span><span class="s2">(</span><span class="s1">b</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span>
                <span class="s1">sorted</span><span class="s2">(</span><span class="s1">b</span><span class="s2">.</span><span class="s1">data</span><span class="s2">[~</span><span class="s1">b</span><span class="s2">.</span><span class="s1">mask</span><span class="s2">]), </span><span class="s1">sorted</span><span class="s2">(</span><span class="s1">b_orig</span><span class="s2">.</span><span class="s1">data</span><span class="s2">[~</span><span class="s1">b_orig</span><span class="s2">.</span><span class="s1">mask</span><span class="s2">]))</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;random&quot;</span><span class="s2">,</span>
            <span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">(), </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">default_rng</span><span class="s2">()])</span>
    <span class="s0">def </span><span class="s1">test_shuffle_untyped_warning</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">random</span><span class="s2">):</span>
        <span class="s4"># Create a dict works like a sequence but isn't one</span>
        <span class="s1">values </span><span class="s2">= {</span><span class="s3">0</span><span class="s2">: </span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">: </span><span class="s3">1</span><span class="s2">, </span><span class="s3">2</span><span class="s2">: </span><span class="s3">2</span><span class="s2">, </span><span class="s3">3</span><span class="s2">: </span><span class="s3">3</span><span class="s2">, </span><span class="s3">4</span><span class="s2">: </span><span class="s3">4</span><span class="s2">, </span><span class="s3">5</span><span class="s2">: </span><span class="s3">5</span><span class="s2">, </span><span class="s3">6</span><span class="s2">: </span><span class="s3">6</span><span class="s2">}</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">warns</span><span class="s2">(</span><span class="s1">UserWarning</span><span class="s2">,</span>
                <span class="s1">match</span><span class="s2">=</span><span class="s5">&quot;you are shuffling a 'dict' object&quot;</span><span class="s2">) </span><span class="s0">as </span><span class="s1">rec</span><span class="s2">:</span>
            <span class="s1">random</span><span class="s2">.</span><span class="s1">shuffle</span><span class="s2">(</span><span class="s1">values</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s5">&quot;test_random&quot; </span><span class="s0">in </span><span class="s1">rec</span><span class="s2">[</span><span class="s3">0</span><span class="s2">].</span><span class="s1">filename</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;random&quot;</span><span class="s2">,</span>
        <span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">(), </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">default_rng</span><span class="s2">()])</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;use_array_like&quot;</span><span class="s2">, [</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_shuffle_no_object_unpacking</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">random</span><span class="s2">, </span><span class="s1">use_array_like</span><span class="s2">):</span>
        <span class="s0">class </span><span class="s1">MyArr</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">ndarray</span><span class="s2">):</span>
            <span class="s0">pass</span>

        <span class="s1">items </span><span class="s2">= [</span>
            <span class="s0">None</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">3</span><span class="s2">]), </span><span class="s1">np</span><span class="s2">.</span><span class="s1">float64</span><span class="s2">(</span><span class="s3">3</span><span class="s2">), </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">(</span><span class="s3">10</span><span class="s2">), </span><span class="s1">np</span><span class="s2">.</span><span class="s1">float64</span><span class="s2">(</span><span class="s3">7</span><span class="s2">)</span>
        <span class="s2">]</span>
        <span class="s1">arr </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">(</span><span class="s1">items</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">)</span>
        <span class="s1">item_ids </span><span class="s2">= {</span><span class="s1">id</span><span class="s2">(</span><span class="s1">i</span><span class="s2">) </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">items</span><span class="s2">}</span>
        <span class="s0">if </span><span class="s1">use_array_like</span><span class="s2">:</span>
            <span class="s1">arr </span><span class="s2">= </span><span class="s1">arr</span><span class="s2">.</span><span class="s1">view</span><span class="s2">(</span><span class="s1">MyArr</span><span class="s2">)</span>

        <span class="s4"># The array was created fine, and did not modify any objects:</span>
        <span class="s0">assert </span><span class="s1">all</span><span class="s2">(</span><span class="s1">id</span><span class="s2">(</span><span class="s1">i</span><span class="s2">) </span><span class="s0">in </span><span class="s1">item_ids </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">arr</span><span class="s2">)</span>

        <span class="s0">if </span><span class="s1">use_array_like </span><span class="s0">and not </span><span class="s1">isinstance</span><span class="s2">(</span><span class="s1">random</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">Generator</span><span class="s2">):</span>
            <span class="s4"># The old API gives incorrect results, but warns about it.</span>
            <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">warns</span><span class="s2">(</span><span class="s1">UserWarning</span><span class="s2">,</span>
                    <span class="s1">match</span><span class="s2">=</span><span class="s5">&quot;Shuffling a one dimensional array.*&quot;</span><span class="s2">):</span>
                <span class="s1">random</span><span class="s2">.</span><span class="s1">shuffle</span><span class="s2">(</span><span class="s1">arr</span><span class="s2">)</span>
        <span class="s0">else</span><span class="s2">:</span>
            <span class="s1">random</span><span class="s2">.</span><span class="s1">shuffle</span><span class="s2">(</span><span class="s1">arr</span><span class="s2">)</span>
            <span class="s0">assert </span><span class="s1">all</span><span class="s2">(</span><span class="s1">id</span><span class="s2">(</span><span class="s1">i</span><span class="s2">) </span><span class="s0">in </span><span class="s1">item_ids </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">arr</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_shuffle_memoryview</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4"># gh-18273</span>
        <span class="s4"># allow graceful handling of memoryviews</span>
        <span class="s4"># (treat the same as arrays)</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">a </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s3">5</span><span class="s2">).</span><span class="s1">data</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">shuffle</span><span class="s2">(</span><span class="s1">a</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">(</span><span class="s1">a</span><span class="s2">), [</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, </span><span class="s3">4</span><span class="s2">, </span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">])</span>
        <span class="s1">rng </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">rng</span><span class="s2">.</span><span class="s1">shuffle</span><span class="s2">(</span><span class="s1">a</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">(</span><span class="s1">a</span><span class="s2">), [</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s3">3</span><span class="s2">, </span><span class="s3">4</span><span class="s2">])</span>
        <span class="s1">rng </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">default_rng</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">rng</span><span class="s2">.</span><span class="s1">shuffle</span><span class="s2">(</span><span class="s1">a</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">(</span><span class="s1">a</span><span class="s2">), [</span><span class="s3">4</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, </span><span class="s3">0</span><span class="s2">, </span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_shuffle_not_writeable</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">a </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">zeros</span><span class="s2">(</span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">a</span><span class="s2">.</span><span class="s1">flags</span><span class="s2">.</span><span class="s1">writeable </span><span class="s2">= </span><span class="s0">False</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s5">'read-only'</span><span class="s2">):</span>
            <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">shuffle</span><span class="s2">(</span><span class="s1">a</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_beta</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">beta</span><span class="s2">(</span><span class="s3">.1</span><span class="s2">, </span><span class="s3">.9</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">(</span>
                <span class="s2">[[</span><span class="s3">1.45341850513746058e-02</span><span class="s2">, </span><span class="s3">5.31297615662868145e-04</span><span class="s2">],</span>
                 <span class="s2">[</span><span class="s3">1.85366619058432324e-06</span><span class="s2">, </span><span class="s3">4.19214516800110563e-03</span><span class="s2">],</span>
                 <span class="s2">[</span><span class="s3">1.58405155108498093e-04</span><span class="s2">, </span><span class="s3">1.26252891949397652e-04</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_binomial</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">binomial</span><span class="s2">(</span><span class="s3">100</span><span class="s2">, </span><span class="s3">.456</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">37</span><span class="s2">, </span><span class="s3">43</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">42</span><span class="s2">, </span><span class="s3">48</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">46</span><span class="s2">, </span><span class="s3">45</span><span class="s2">]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_chisquare</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">chisquare</span><span class="s2">(</span><span class="s3">50</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">63.87858175501090585</span><span class="s2">, </span><span class="s3">68.68407748911370447</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">65.77116116901505904</span><span class="s2">, </span><span class="s3">47.09686762438974483</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">72.3828403199695174</span><span class="s2">, </span><span class="s3">74.18408615260374006</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">13</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_dirichlet</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">alpha </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">51.72840233779265162</span><span class="s2">, </span><span class="s3">39.74494232180943953</span><span class="s2">])</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">mtrand</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">(</span><span class="s1">alpha</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[[</span><span class="s3">0.54539444573611562</span><span class="s2">, </span><span class="s3">0.45460555426388438</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s3">0.62345816822039413</span><span class="s2">, </span><span class="s3">0.37654183177960598</span><span class="s2">]],</span>
                            <span class="s2">[[</span><span class="s3">0.55206000085785778</span><span class="s2">, </span><span class="s3">0.44793999914214233</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s3">0.58964023305154301</span><span class="s2">, </span><span class="s3">0.41035976694845688</span><span class="s2">]],</span>
                            <span class="s2">[[</span><span class="s3">0.59266909280647828</span><span class="s2">, </span><span class="s3">0.40733090719352177</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s3">0.56974431743975207</span><span class="s2">, </span><span class="s3">0.43025568256024799</span><span class="s2">]]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_dirichlet_size</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4"># gh-3173</span>
        <span class="s1">p </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">51.72840233779265162</span><span class="s2">, </span><span class="s3">39.74494232180943953</span><span class="s2">])</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">(</span><span class="s1">p</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint32</span><span class="s2">(</span><span class="s3">1</span><span class="s2">)).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s3">1</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">(</span><span class="s1">p</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint32</span><span class="s2">(</span><span class="s3">1</span><span class="s2">)).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s3">1</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">(</span><span class="s1">p</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint32</span><span class="s2">(</span><span class="s3">1</span><span class="s2">)).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s3">1</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">(</span><span class="s1">p</span><span class="s2">, [</span><span class="s3">2</span><span class="s2">, </span><span class="s3">2</span><span class="s2">]).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s3">2</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">(</span><span class="s1">p</span><span class="s2">, (</span><span class="s3">2</span><span class="s2">, </span><span class="s3">2</span><span class="s2">)).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s3">2</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">(</span><span class="s1">p</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">((</span><span class="s3">2</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s3">2</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>

        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">, </span><span class="s1">p</span><span class="s2">, </span><span class="s1">float</span><span class="s2">(</span><span class="s3">1</span><span class="s2">))</span>

    <span class="s0">def </span><span class="s1">test_dirichlet_bad_alpha</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4"># gh-2089</span>
        <span class="s1">alpha </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">5.4e-01</span><span class="s2">, -</span><span class="s3">1.0e-16</span><span class="s2">])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">mtrand</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">, </span><span class="s1">alpha</span><span class="s2">)</span>

        <span class="s4"># gh-15876</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">, [[</span><span class="s3">5</span><span class="s2">, </span><span class="s3">1</span><span class="s2">]])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">, [[</span><span class="s3">5</span><span class="s2">], [</span><span class="s3">1</span><span class="s2">]])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">, [[[</span><span class="s3">5</span><span class="s2">], [</span><span class="s3">1</span><span class="s2">]], [[</span><span class="s3">1</span><span class="s2">], [</span><span class="s3">5</span><span class="s2">]]])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">5</span><span class="s2">, </span><span class="s3">1</span><span class="s2">], [</span><span class="s3">1</span><span class="s2">, </span><span class="s3">5</span><span class="s2">]]))</span>

    <span class="s0">def </span><span class="s1">test_exponential</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">exponential</span><span class="s2">(</span><span class="s3">1.1234</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">1.08342649775011624</span><span class="s2">, </span><span class="s3">1.00607889924557314</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">2.46628830085216721</span><span class="s2">, </span><span class="s3">2.49668106809923884</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">0.68717433461363442</span><span class="s2">, </span><span class="s3">1.69175666993575979</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_exponential_0</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">exponential</span><span class="s2">(</span><span class="s1">scale</span><span class="s2">=</span><span class="s3">0</span><span class="s2">), </span><span class="s3">0</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">exponential</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=-</span><span class="s3">0.</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_f</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">f</span><span class="s2">(</span><span class="s3">12</span><span class="s2">, </span><span class="s3">77</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">1.21975394418575878</span><span class="s2">, </span><span class="s3">1.75135759791559775</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">1.44803115017146489</span><span class="s2">, </span><span class="s3">1.22108959480396262</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">1.02176975757740629</span><span class="s2">, </span><span class="s3">1.34431827623300415</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_gamma</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">gamma</span><span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s3">3</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">24.60509188649287182</span><span class="s2">, </span><span class="s3">28.54993563207210627</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">26.13476110204064184</span><span class="s2">, </span><span class="s3">12.56988482927716078</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">31.71863275789960568</span><span class="s2">, </span><span class="s3">33.30143302795922011</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_gamma_0</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">gamma</span><span class="s2">(</span><span class="s1">shape</span><span class="s2">=</span><span class="s3">0</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=</span><span class="s3">0</span><span class="s2">), </span><span class="s3">0</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">gamma</span><span class="s2">, </span><span class="s1">shape</span><span class="s2">=-</span><span class="s3">0.</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=-</span><span class="s3">0.</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_geometric</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">geometric</span><span class="s2">(</span><span class="s3">.123456789</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">8</span><span class="s2">, </span><span class="s3">7</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">17</span><span class="s2">, </span><span class="s3">17</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">5</span><span class="s2">, </span><span class="s3">12</span><span class="s2">]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_gumbel</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">gumbel</span><span class="s2">(</span><span class="s1">loc</span><span class="s2">=</span><span class="s3">.123456789</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=</span><span class="s3">2.0</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">0.19591898743416816</span><span class="s2">, </span><span class="s3">0.34405539668096674</span><span class="s2">],</span>
                            <span class="s2">[-</span><span class="s3">1.4492522252274278</span><span class="s2">, -</span><span class="s3">1.47374816298446865</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">1.10651090478803416</span><span class="s2">, -</span><span class="s3">0.69535848626236174</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_gumbel_0</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">gumbel</span><span class="s2">(</span><span class="s1">scale</span><span class="s2">=</span><span class="s3">0</span><span class="s2">), </span><span class="s3">0</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">gumbel</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=-</span><span class="s3">0.</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_hypergeometric</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">hypergeometric</span><span class="s2">(</span><span class="s3">10</span><span class="s2">, </span><span class="s3">5</span><span class="s2">, </span><span class="s3">14</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">10</span><span class="s2">, </span><span class="s3">10</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">10</span><span class="s2">, </span><span class="s3">10</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">9</span><span class="s2">, </span><span class="s3">9</span><span class="s2">]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

        <span class="s4"># Test nbad = 0</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">hypergeometric</span><span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s3">0</span><span class="s2">, </span><span class="s3">3</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s3">4</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">3</span><span class="s2">, </span><span class="s3">3</span><span class="s2">, </span><span class="s3">3</span><span class="s2">, </span><span class="s3">3</span><span class="s2">])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">hypergeometric</span><span class="s2">(</span><span class="s3">15</span><span class="s2">, </span><span class="s3">0</span><span class="s2">, </span><span class="s3">12</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s3">4</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">12</span><span class="s2">, </span><span class="s3">12</span><span class="s2">, </span><span class="s3">12</span><span class="s2">, </span><span class="s3">12</span><span class="s2">])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

        <span class="s4"># Test ngood = 0</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">hypergeometric</span><span class="s2">(</span><span class="s3">0</span><span class="s2">, </span><span class="s3">5</span><span class="s2">, </span><span class="s3">3</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s3">4</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">0</span><span class="s2">, </span><span class="s3">0</span><span class="s2">, </span><span class="s3">0</span><span class="s2">, </span><span class="s3">0</span><span class="s2">])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">hypergeometric</span><span class="s2">(</span><span class="s3">0</span><span class="s2">, </span><span class="s3">15</span><span class="s2">, </span><span class="s3">12</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s3">4</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">0</span><span class="s2">, </span><span class="s3">0</span><span class="s2">, </span><span class="s3">0</span><span class="s2">, </span><span class="s3">0</span><span class="s2">])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_laplace</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">laplace</span><span class="s2">(</span><span class="s1">loc</span><span class="s2">=</span><span class="s3">.123456789</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=</span><span class="s3">2.0</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">0.66599721112760157</span><span class="s2">, </span><span class="s3">0.52829452552221945</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">3.12791959514407125</span><span class="s2">, </span><span class="s3">3.18202813572992005</span><span class="s2">],</span>
                            <span class="s2">[-</span><span class="s3">0.05391065675859356</span><span class="s2">, </span><span class="s3">1.74901336242837324</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_laplace_0</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">laplace</span><span class="s2">(</span><span class="s1">scale</span><span class="s2">=</span><span class="s3">0</span><span class="s2">), </span><span class="s3">0</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">laplace</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=-</span><span class="s3">0.</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_logistic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">logistic</span><span class="s2">(</span><span class="s1">loc</span><span class="s2">=</span><span class="s3">.123456789</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=</span><span class="s3">2.0</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">1.09232835305011444</span><span class="s2">, </span><span class="s3">0.8648196662399954</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">4.27818590694950185</span><span class="s2">, </span><span class="s3">4.33897006346929714</span><span class="s2">],</span>
                            <span class="s2">[-</span><span class="s3">0.21682183359214885</span><span class="s2">, </span><span class="s3">2.63373365386060332</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_lognormal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">lognormal</span><span class="s2">(</span><span class="s1">mean</span><span class="s2">=</span><span class="s3">.123456789</span><span class="s2">, </span><span class="s1">sigma</span><span class="s2">=</span><span class="s3">2.0</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">16.50698631688883822</span><span class="s2">, </span><span class="s3">36.54846706092654784</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">22.67886599981281748</span><span class="s2">, </span><span class="s3">0.71617561058995771</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">65.72798501792723869</span><span class="s2">, </span><span class="s3">86.84341601437161273</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">13</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_lognormal_0</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">lognormal</span><span class="s2">(</span><span class="s1">sigma</span><span class="s2">=</span><span class="s3">0</span><span class="s2">), </span><span class="s3">1</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">lognormal</span><span class="s2">, </span><span class="s1">sigma</span><span class="s2">=-</span><span class="s3">0.</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_logseries</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">logseries</span><span class="s2">(</span><span class="s1">p</span><span class="s2">=</span><span class="s3">.923456789</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">2</span><span class="s2">, </span><span class="s3">2</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">6</span><span class="s2">, </span><span class="s3">17</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">3</span><span class="s2">, </span><span class="s3">6</span><span class="s2">]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_multinomial</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s3">20</span><span class="s2">, [</span><span class="s3">1</span><span class="s2">/</span><span class="s3">6.</span><span class="s2">]*</span><span class="s3">6</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[[</span><span class="s3">4</span><span class="s2">, </span><span class="s3">3</span><span class="s2">, </span><span class="s3">5</span><span class="s2">, </span><span class="s3">4</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s3">2</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s3">5</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s3">8</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s3">1</span><span class="s2">]],</span>
                            <span class="s2">[[</span><span class="s3">3</span><span class="s2">, </span><span class="s3">4</span><span class="s2">, </span><span class="s3">3</span><span class="s2">, </span><span class="s3">6</span><span class="s2">, </span><span class="s3">0</span><span class="s2">, </span><span class="s3">4</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s3">2</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, </span><span class="s3">4</span><span class="s2">, </span><span class="s3">3</span><span class="s2">, </span><span class="s3">6</span><span class="s2">, </span><span class="s3">4</span><span class="s2">]],</span>
                            <span class="s2">[[</span><span class="s3">4</span><span class="s2">, </span><span class="s3">4</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s3">5</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s3">3</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s3">4</span><span class="s2">, </span><span class="s3">3</span><span class="s2">, </span><span class="s3">4</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s3">3</span><span class="s2">, </span><span class="s3">4</span><span class="s2">]]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_multivariate_normal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">mean </span><span class="s2">= (</span><span class="s3">.123456789</span><span class="s2">, </span><span class="s3">10</span><span class="s2">)</span>
        <span class="s1">cov </span><span class="s2">= [[</span><span class="s3">1</span><span class="s2">, </span><span class="s3">0</span><span class="s2">], [</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">]]</span>
        <span class="s1">size </span><span class="s2">= (</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_normal</span><span class="s2">(</span><span class="s1">mean</span><span class="s2">, </span><span class="s1">cov</span><span class="s2">, </span><span class="s1">size</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[[</span><span class="s3">1.463620246718631</span><span class="s2">, </span><span class="s3">11.73759122771936</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s3">1.622445133300628</span><span class="s2">, </span><span class="s3">9.771356667546383</span><span class="s2">]],</span>
                            <span class="s2">[[</span><span class="s3">2.154490787682787</span><span class="s2">, </span><span class="s3">12.170324946056553</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s3">1.719909438201865</span><span class="s2">, </span><span class="s3">9.230548443648306</span><span class="s2">]],</span>
                            <span class="s2">[[</span><span class="s3">0.689515026297799</span><span class="s2">, </span><span class="s3">9.880729819607714</span><span class="s2">],</span>
                             <span class="s2">[-</span><span class="s3">0.023054015651998</span><span class="s2">, </span><span class="s3">9.201096623542879</span><span class="s2">]]])</span>

        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">15</span><span class="s2">)</span>

        <span class="s4"># Check for default size, was raising deprecation warning</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_normal</span><span class="s2">(</span><span class="s1">mean</span><span class="s2">, </span><span class="s1">cov</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">0.895289569463708</span><span class="s2">, </span><span class="s3">9.17180864067987</span><span class="s2">])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">15</span><span class="s2">)</span>

        <span class="s4"># Check that non positive-semidefinite covariance warns with</span>
        <span class="s4"># RuntimeWarning</span>
        <span class="s1">mean </span><span class="s2">= [</span><span class="s3">0</span><span class="s2">, </span><span class="s3">0</span><span class="s2">]</span>
        <span class="s1">cov </span><span class="s2">= [[</span><span class="s3">1</span><span class="s2">, </span><span class="s3">2</span><span class="s2">], [</span><span class="s3">2</span><span class="s2">, </span><span class="s3">1</span><span class="s2">]]</span>
        <span class="s1">assert_warns</span><span class="s2">(</span><span class="s1">RuntimeWarning</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_normal</span><span class="s2">, </span><span class="s1">mean</span><span class="s2">, </span><span class="s1">cov</span><span class="s2">)</span>

        <span class="s4"># and that it doesn't warn with RuntimeWarning check_valid='ignore'</span>
        <span class="s1">assert_no_warnings</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_normal</span><span class="s2">, </span><span class="s1">mean</span><span class="s2">, </span><span class="s1">cov</span><span class="s2">,</span>
                           <span class="s1">check_valid</span><span class="s2">=</span><span class="s5">'ignore'</span><span class="s2">)</span>

        <span class="s4"># and that it raises with RuntimeWarning check_valid='raises'</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_normal</span><span class="s2">, </span><span class="s1">mean</span><span class="s2">, </span><span class="s1">cov</span><span class="s2">,</span>
                      <span class="s1">check_valid</span><span class="s2">=</span><span class="s5">'raise'</span><span class="s2">)</span>

        <span class="s1">cov </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">1</span><span class="s2">, </span><span class="s3">0.1</span><span class="s2">], [</span><span class="s3">0.1</span><span class="s2">, </span><span class="s3">1</span><span class="s2">]], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">float32</span><span class="s2">)</span>
        <span class="s0">with </span><span class="s1">suppress_warnings</span><span class="s2">() </span><span class="s0">as </span><span class="s1">sup</span><span class="s2">:</span>
            <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_normal</span><span class="s2">(</span><span class="s1">mean</span><span class="s2">, </span><span class="s1">cov</span><span class="s2">)</span>
            <span class="s1">w </span><span class="s2">= </span><span class="s1">sup</span><span class="s2">.</span><span class="s1">record</span><span class="s2">(</span><span class="s1">RuntimeWarning</span><span class="s2">)</span>
            <span class="s0">assert </span><span class="s1">len</span><span class="s2">(</span><span class="s1">w</span><span class="s2">) == </span><span class="s3">0</span>

    <span class="s0">def </span><span class="s1">test_negative_binomial</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">negative_binomial</span><span class="s2">(</span><span class="s1">n</span><span class="s2">=</span><span class="s3">100</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=</span><span class="s3">.12345</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">848</span><span class="s2">, </span><span class="s3">841</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">892</span><span class="s2">, </span><span class="s3">611</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">779</span><span class="s2">, </span><span class="s3">647</span><span class="s2">]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_noncentral_chisquare</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">noncentral_chisquare</span><span class="s2">(</span><span class="s1">df</span><span class="s2">=</span><span class="s3">5</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">=</span><span class="s3">5</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">23.91905354498517511</span><span class="s2">, </span><span class="s3">13.35324692733826346</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">31.22452661329736401</span><span class="s2">, </span><span class="s3">16.60047399466177254</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">5.03461598262724586</span><span class="s2">, </span><span class="s3">17.94973089023519464</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>

        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">noncentral_chisquare</span><span class="s2">(</span><span class="s1">df</span><span class="s2">=</span><span class="s3">.5</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">=</span><span class="s3">.2</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">1.47145377828516666</span><span class="s2">,  </span><span class="s3">0.15052899268012659</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">0.00943803056963588</span><span class="s2">,  </span><span class="s3">1.02647251615666169</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">0.332334982684171</span><span class="s2">,  </span><span class="s3">0.15451287602753125</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>

        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">noncentral_chisquare</span><span class="s2">(</span><span class="s1">df</span><span class="s2">=</span><span class="s3">5</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">=</span><span class="s3">0</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">9.597154162763948</span><span class="s2">, </span><span class="s3">11.725484450296079</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">10.413711048138335</span><span class="s2">, </span><span class="s3">3.694475922923986</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">13.484222138963087</span><span class="s2">, </span><span class="s3">14.377255424602957</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_noncentral_f</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">noncentral_f</span><span class="s2">(</span><span class="s1">dfnum</span><span class="s2">=</span><span class="s3">5</span><span class="s2">, </span><span class="s1">dfden</span><span class="s2">=</span><span class="s3">2</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">=</span><span class="s3">1</span><span class="s2">,</span>
                                        <span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">1.40598099674926669</span><span class="s2">, </span><span class="s3">0.34207973179285761</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">3.57715069265772545</span><span class="s2">, </span><span class="s3">7.92632662577829805</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">0.43741599463544162</span><span class="s2">, </span><span class="s3">1.1774208752428319</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_normal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">normal</span><span class="s2">(</span><span class="s1">loc</span><span class="s2">=</span><span class="s3">.123456789</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=</span><span class="s3">2.0</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">2.80378370443726244</span><span class="s2">, </span><span class="s3">3.59863924443872163</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">3.121433477601256</span><span class="s2">, -</span><span class="s3">0.33382987590723379</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">4.18552478636557357</span><span class="s2">, </span><span class="s3">4.46410668111310471</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_normal_0</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">normal</span><span class="s2">(</span><span class="s1">scale</span><span class="s2">=</span><span class="s3">0</span><span class="s2">), </span><span class="s3">0</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">normal</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=-</span><span class="s3">0.</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_pareto</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">pareto</span><span class="s2">(</span><span class="s1">a</span><span class="s2">=</span><span class="s3">.123456789</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">(</span>
                <span class="s2">[[</span><span class="s3">2.46852460439034849e+03</span><span class="s2">, </span><span class="s3">1.41286880810518346e+03</span><span class="s2">],</span>
                 <span class="s2">[</span><span class="s3">5.28287797029485181e+07</span><span class="s2">, </span><span class="s3">6.57720981047328785e+07</span><span class="s2">],</span>
                 <span class="s2">[</span><span class="s3">1.40840323350391515e+02</span><span class="s2">, </span><span class="s3">1.98390255135251704e+05</span><span class="s2">]])</span>
        <span class="s4"># For some reason on 32-bit x86 Ubuntu 12.10 the [1, 0] entry in this</span>
        <span class="s4"># matrix differs by 24 nulps. Discussion:</span>
        <span class="s4">#   https://mail.python.org/pipermail/numpy-discussion/2012-September/063801.html</span>
        <span class="s4"># Consensus is that this is probably some gcc quirk that affects</span>
        <span class="s4"># rounding but not in any important way, so we just use a looser</span>
        <span class="s4"># tolerance on this test:</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">testing</span><span class="s2">.</span><span class="s1">assert_array_almost_equal_nulp</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">nulp</span><span class="s2">=</span><span class="s3">30</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_poisson</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">poisson</span><span class="s2">(</span><span class="s1">lam</span><span class="s2">=</span><span class="s3">.123456789</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">0</span><span class="s2">, </span><span class="s3">0</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">1</span><span class="s2">, </span><span class="s3">0</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">0</span><span class="s2">, </span><span class="s3">0</span><span class="s2">]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_poisson_exceptions</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">lambig </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s5">'l'</span><span class="s2">).</span><span class="s1">max</span>
        <span class="s1">lamneg </span><span class="s2">= -</span><span class="s3">1</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">poisson</span><span class="s2">, </span><span class="s1">lamneg</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">poisson</span><span class="s2">, [</span><span class="s1">lamneg</span><span class="s2">]*</span><span class="s3">10</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">poisson</span><span class="s2">, </span><span class="s1">lambig</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">poisson</span><span class="s2">, [</span><span class="s1">lambig</span><span class="s2">]*</span><span class="s3">10</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_power</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">power</span><span class="s2">(</span><span class="s1">a</span><span class="s2">=</span><span class="s3">.123456789</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">0.02048932883240791</span><span class="s2">, </span><span class="s3">0.01424192241128213</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">0.38446073748535298</span><span class="s2">, </span><span class="s3">0.39499689943484395</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">0.00177699707563439</span><span class="s2">, </span><span class="s3">0.13115505880863756</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_rayleigh</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">rayleigh</span><span class="s2">(</span><span class="s1">scale</span><span class="s2">=</span><span class="s3">10</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">13.8882496494248393</span><span class="s2">, </span><span class="s3">13.383318339044731</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">20.95413364294492098</span><span class="s2">, </span><span class="s3">21.08285015800712614</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">11.06066537006854311</span><span class="s2">, </span><span class="s3">17.35468505778271009</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_rayleigh_0</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">rayleigh</span><span class="s2">(</span><span class="s1">scale</span><span class="s2">=</span><span class="s3">0</span><span class="s2">), </span><span class="s3">0</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">rayleigh</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=-</span><span class="s3">0.</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_standard_cauchy</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_cauchy</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">0.77127660196445336</span><span class="s2">, -</span><span class="s3">6.55601161955910605</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">0.93582023391158309</span><span class="s2">, -</span><span class="s3">2.07479293013759447</span><span class="s2">],</span>
                            <span class="s2">[-</span><span class="s3">4.74601644297011926</span><span class="s2">, </span><span class="s3">0.18338989290760804</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_standard_exponential</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_exponential</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">0.96441739162374596</span><span class="s2">, </span><span class="s3">0.89556604882105506</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">2.1953785836319808</span><span class="s2">, </span><span class="s3">2.22243285392490542</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">0.6116915921431676</span><span class="s2">, </span><span class="s3">1.50592546727413201</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_standard_gamma</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_gamma</span><span class="s2">(</span><span class="s1">shape</span><span class="s2">=</span><span class="s3">3</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">5.50841531318455058</span><span class="s2">, </span><span class="s3">6.62953470301903103</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">5.93988484943779227</span><span class="s2">, </span><span class="s3">2.31044849402133989</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">7.54838614231317084</span><span class="s2">, </span><span class="s3">8.012756093271868</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_standard_gamma_0</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_gamma</span><span class="s2">(</span><span class="s1">shape</span><span class="s2">=</span><span class="s3">0</span><span class="s2">), </span><span class="s3">0</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_gamma</span><span class="s2">, </span><span class="s1">shape</span><span class="s2">=-</span><span class="s3">0.</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_standard_normal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_normal</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">1.34016345771863121</span><span class="s2">, </span><span class="s3">1.73759122771936081</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">1.498988344300628</span><span class="s2">, -</span><span class="s3">0.2286433324536169</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">2.031033998682787</span><span class="s2">, </span><span class="s3">2.17032494605655257</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_standard_t</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_t</span><span class="s2">(</span><span class="s1">df</span><span class="s2">=</span><span class="s3">10</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">0.97140611862659965</span><span class="s2">, -</span><span class="s3">0.08830486548450577</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">1.36311143689505321</span><span class="s2">, -</span><span class="s3">0.55317463909867071</span><span class="s2">],</span>
                            <span class="s2">[-</span><span class="s3">0.18473749069684214</span><span class="s2">, </span><span class="s3">0.61181537341755321</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_triangular</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">triangular</span><span class="s2">(</span><span class="s1">left</span><span class="s2">=</span><span class="s3">5.12</span><span class="s2">, </span><span class="s1">mode</span><span class="s2">=</span><span class="s3">10.23</span><span class="s2">, </span><span class="s1">right</span><span class="s2">=</span><span class="s3">20.34</span><span class="s2">,</span>
                                      <span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">12.68117178949215784</span><span class="s2">, </span><span class="s3">12.4129206149193152</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">16.20131377335158263</span><span class="s2">, </span><span class="s3">16.25692138747600524</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">11.20400690911820263</span><span class="s2">, </span><span class="s3">14.4978144835829923</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_uniform</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">uniform</span><span class="s2">(</span><span class="s1">low</span><span class="s2">=</span><span class="s3">1.23</span><span class="s2">, </span><span class="s1">high</span><span class="s2">=</span><span class="s3">10.54</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">6.99097932346268003</span><span class="s2">, </span><span class="s3">6.73801597444323974</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">9.50364421400426274</span><span class="s2">, </span><span class="s3">9.53130618907631089</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">5.48995325769805476</span><span class="s2">, </span><span class="s3">8.47493103280052118</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_uniform_range_bounds</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">fmin </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">finfo</span><span class="s2">(</span><span class="s5">'float'</span><span class="s2">).</span><span class="s1">min</span>
        <span class="s1">fmax </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">finfo</span><span class="s2">(</span><span class="s5">'float'</span><span class="s2">).</span><span class="s1">max</span>

        <span class="s1">func </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">uniform</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">OverflowError</span><span class="s2">, </span><span class="s1">func</span><span class="s2">, -</span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s3">0</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">OverflowError</span><span class="s2">, </span><span class="s1">func</span><span class="s2">,  </span><span class="s3">0</span><span class="s2">,      </span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">OverflowError</span><span class="s2">, </span><span class="s1">func</span><span class="s2">,  </span><span class="s1">fmin</span><span class="s2">,   </span><span class="s1">fmax</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">OverflowError</span><span class="s2">, </span><span class="s1">func</span><span class="s2">, [-</span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">], [</span><span class="s3">0</span><span class="s2">])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">OverflowError</span><span class="s2">, </span><span class="s1">func</span><span class="s2">, [</span><span class="s3">0</span><span class="s2">], [</span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">])</span>

        <span class="s4"># (fmax / 1e17) - fmin is within range, so this should not throw</span>
        <span class="s4"># account for i386 extended precision DBL_MAX / 1e17 + DBL_MAX &gt;</span>
        <span class="s4"># DBL_MAX by increasing fmin a bit</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">uniform</span><span class="s2">(</span><span class="s1">low</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nextafter</span><span class="s2">(</span><span class="s1">fmin</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s1">high</span><span class="s2">=</span><span class="s1">fmax </span><span class="s2">/ </span><span class="s3">1e17</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_scalar_exception_propagation</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4"># Tests that exceptions are correctly propagated in distributions</span>
        <span class="s4"># when called with objects that throw exceptions when converted to</span>
        <span class="s4"># scalars.</span>
        <span class="s4">#</span>
        <span class="s4"># Regression test for gh: 8865</span>

        <span class="s0">class </span><span class="s1">ThrowingFloat</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">ndarray</span><span class="s2">):</span>
            <span class="s0">def </span><span class="s1">__float__</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
                <span class="s0">raise </span><span class="s1">TypeError</span>

        <span class="s1">throwing_float </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">(</span><span class="s3">1.0</span><span class="s2">).</span><span class="s1">view</span><span class="s2">(</span><span class="s1">ThrowingFloat</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">uniform</span><span class="s2">, </span><span class="s1">throwing_float</span><span class="s2">,</span>
                      <span class="s1">throwing_float</span><span class="s2">)</span>

        <span class="s0">class </span><span class="s1">ThrowingInteger</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">ndarray</span><span class="s2">):</span>
            <span class="s0">def </span><span class="s1">__int__</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
                <span class="s0">raise </span><span class="s1">TypeError</span>

            <span class="s1">__index__ </span><span class="s2">= </span><span class="s1">__int__</span>

        <span class="s1">throwing_int </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">(</span><span class="s3">1</span><span class="s2">).</span><span class="s1">view</span><span class="s2">(</span><span class="s1">ThrowingInteger</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">hypergeometric</span><span class="s2">, </span><span class="s1">throwing_int</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, </span><span class="s3">1</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_vonmises</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">vonmises</span><span class="s2">(</span><span class="s1">mu</span><span class="s2">=</span><span class="s3">1.23</span><span class="s2">, </span><span class="s1">kappa</span><span class="s2">=</span><span class="s3">1.54</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">2.28567572673902042</span><span class="s2">, </span><span class="s3">2.89163838442285037</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">0.38198375564286025</span><span class="s2">, </span><span class="s3">2.57638023113890746</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">1.19153771588353052</span><span class="s2">, </span><span class="s3">1.83509849681825354</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_vonmises_small</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4"># check infinite loop, gh-4720</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">r </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">vonmises</span><span class="s2">(</span><span class="s1">mu</span><span class="s2">=</span><span class="s3">0.</span><span class="s2">, </span><span class="s1">kappa</span><span class="s2">=</span><span class="s3">1.1e-8</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s3">10</span><span class="s2">**</span><span class="s3">6</span><span class="s2">)</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">testing</span><span class="s2">.</span><span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">isfinite</span><span class="s2">(</span><span class="s1">r</span><span class="s2">).</span><span class="s1">all</span><span class="s2">())</span>

    <span class="s0">def </span><span class="s1">test_wald</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">wald</span><span class="s2">(</span><span class="s1">mean</span><span class="s2">=</span><span class="s3">1.23</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=</span><span class="s3">1.54</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">3.82935265715889983</span><span class="s2">, </span><span class="s3">5.13125249184285526</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">0.35045403618358717</span><span class="s2">, </span><span class="s3">1.50832396872003538</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">0.24124319895843183</span><span class="s2">, </span><span class="s3">0.22031101461955038</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_weibull</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">weibull</span><span class="s2">(</span><span class="s1">a</span><span class="s2">=</span><span class="s3">1.23</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">0.97097342648766727</span><span class="s2">, </span><span class="s3">0.91422896443565516</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">1.89517770034962929</span><span class="s2">, </span><span class="s3">1.91414357960479564</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">0.67057783752390987</span><span class="s2">, </span><span class="s3">1.39494046635066793</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_weibull_0</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">weibull</span><span class="s2">(</span><span class="s1">a</span><span class="s2">=</span><span class="s3">0</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s3">12</span><span class="s2">), </span><span class="s1">np</span><span class="s2">.</span><span class="s1">zeros</span><span class="s2">(</span><span class="s3">12</span><span class="s2">))</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">weibull</span><span class="s2">, </span><span class="s1">a</span><span class="s2">=-</span><span class="s3">0.</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_zipf</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">zipf</span><span class="s2">(</span><span class="s1">a</span><span class="s2">=</span><span class="s3">1.23</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s3">66</span><span class="s2">, </span><span class="s3">29</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">1</span><span class="s2">, </span><span class="s3">1</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s3">3</span><span class="s2">, </span><span class="s3">13</span><span class="s2">]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestBroadcast</span><span class="s2">:</span>
    <span class="s4"># tests that functions that broadcast behave</span>
    <span class="s4"># correctly when presented with non-scalar arguments</span>
    <span class="s0">def </span><span class="s1">setup_method</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">seed </span><span class="s2">= </span><span class="s3">123456789</span>

    <span class="s0">def </span><span class="s1">setSeed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>

    <span class="s4"># TODO: Include test for randint once it can broadcast</span>
    <span class="s4"># Can steal the test written in PR #6938</span>

    <span class="s0">def </span><span class="s1">test_uniform</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">low </span><span class="s2">= [</span><span class="s3">0</span><span class="s2">]</span>
        <span class="s1">high </span><span class="s2">= [</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">uniform </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">uniform</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">0.53283302478975902</span><span class="s2">,</span>
                            <span class="s3">0.53413660089041659</span><span class="s2">,</span>
                            <span class="s3">0.50955303552646702</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">uniform</span><span class="s2">(</span><span class="s1">low </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">high</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">uniform</span><span class="s2">(</span><span class="s1">low</span><span class="s2">, </span><span class="s1">high </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_normal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">loc </span><span class="s2">= [</span><span class="s3">0</span><span class="s2">]</span>
        <span class="s1">scale </span><span class="s2">= [</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">bad_scale </span><span class="s2">= [-</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">normal </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">normal</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">2.2129019979039612</span><span class="s2">,</span>
                            <span class="s3">2.1283977976520019</span><span class="s2">,</span>
                            <span class="s3">1.8417114045748335</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">normal</span><span class="s2">(</span><span class="s1">loc </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">normal</span><span class="s2">, </span><span class="s1">loc </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">bad_scale</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">normal</span><span class="s2">(</span><span class="s1">loc</span><span class="s2">, </span><span class="s1">scale </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">normal</span><span class="s2">, </span><span class="s1">loc</span><span class="s2">, </span><span class="s1">bad_scale </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_beta</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">a </span><span class="s2">= [</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">b </span><span class="s2">= [</span><span class="s3">2</span><span class="s2">]</span>
        <span class="s1">bad_a </span><span class="s2">= [-</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">bad_b </span><span class="s2">= [-</span><span class="s3">2</span><span class="s2">]</span>
        <span class="s1">beta </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">beta</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">0.19843558305989056</span><span class="s2">,</span>
                            <span class="s3">0.075230336409423643</span><span class="s2">,</span>
                            <span class="s3">0.24976865978980844</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">beta</span><span class="s2">(</span><span class="s1">a </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">b</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">beta</span><span class="s2">, </span><span class="s1">bad_a </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">b</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">beta</span><span class="s2">, </span><span class="s1">a </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">bad_b</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">beta</span><span class="s2">(</span><span class="s1">a</span><span class="s2">, </span><span class="s1">b </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">beta</span><span class="s2">, </span><span class="s1">bad_a</span><span class="s2">, </span><span class="s1">b </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">beta</span><span class="s2">, </span><span class="s1">a</span><span class="s2">, </span><span class="s1">bad_b </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_exponential</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">scale </span><span class="s2">= [</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">bad_scale </span><span class="s2">= [-</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">exponential </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">exponential</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">0.76106853658845242</span><span class="s2">,</span>
                            <span class="s3">0.76386282278691653</span><span class="s2">,</span>
                            <span class="s3">0.71243813125891797</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">exponential</span><span class="s2">(</span><span class="s1">scale </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">exponential</span><span class="s2">, </span><span class="s1">bad_scale </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_standard_gamma</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">shape </span><span class="s2">= [</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">bad_shape </span><span class="s2">= [-</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">std_gamma </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_gamma</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">0.76106853658845242</span><span class="s2">,</span>
                            <span class="s3">0.76386282278691653</span><span class="s2">,</span>
                            <span class="s3">0.71243813125891797</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">std_gamma</span><span class="s2">(</span><span class="s1">shape </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">std_gamma</span><span class="s2">, </span><span class="s1">bad_shape </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_gamma</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">shape </span><span class="s2">= [</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">scale </span><span class="s2">= [</span><span class="s3">2</span><span class="s2">]</span>
        <span class="s1">bad_shape </span><span class="s2">= [-</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">bad_scale </span><span class="s2">= [-</span><span class="s3">2</span><span class="s2">]</span>
        <span class="s1">gamma </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">gamma</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">1.5221370731769048</span><span class="s2">,</span>
                            <span class="s3">1.5277256455738331</span><span class="s2">,</span>
                            <span class="s3">1.4248762625178359</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">gamma</span><span class="s2">(</span><span class="s1">shape </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">gamma</span><span class="s2">, </span><span class="s1">bad_shape </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">gamma</span><span class="s2">, </span><span class="s1">shape </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">bad_scale</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">gamma</span><span class="s2">(</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">scale </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">gamma</span><span class="s2">, </span><span class="s1">bad_shape</span><span class="s2">, </span><span class="s1">scale </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">gamma</span><span class="s2">, </span><span class="s1">shape</span><span class="s2">, </span><span class="s1">bad_scale </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_f</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">dfnum </span><span class="s2">= [</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">dfden </span><span class="s2">= [</span><span class="s3">2</span><span class="s2">]</span>
        <span class="s1">bad_dfnum </span><span class="s2">= [-</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">bad_dfden </span><span class="s2">= [-</span><span class="s3">2</span><span class="s2">]</span>
        <span class="s1">f </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">f</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">0.80038951638264799</span><span class="s2">,</span>
                            <span class="s3">0.86768719635363512</span><span class="s2">,</span>
                            <span class="s3">2.7251095168386801</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">f</span><span class="s2">(</span><span class="s1">dfnum </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">dfden</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">f</span><span class="s2">, </span><span class="s1">bad_dfnum </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">dfden</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">f</span><span class="s2">, </span><span class="s1">dfnum </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">bad_dfden</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">f</span><span class="s2">(</span><span class="s1">dfnum</span><span class="s2">, </span><span class="s1">dfden </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">f</span><span class="s2">, </span><span class="s1">bad_dfnum</span><span class="s2">, </span><span class="s1">dfden </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">f</span><span class="s2">, </span><span class="s1">dfnum</span><span class="s2">, </span><span class="s1">bad_dfden </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_noncentral_f</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">dfnum </span><span class="s2">= [</span><span class="s3">2</span><span class="s2">]</span>
        <span class="s1">dfden </span><span class="s2">= [</span><span class="s3">3</span><span class="s2">]</span>
        <span class="s1">nonc </span><span class="s2">= [</span><span class="s3">4</span><span class="s2">]</span>
        <span class="s1">bad_dfnum </span><span class="s2">= [</span><span class="s3">0</span><span class="s2">]</span>
        <span class="s1">bad_dfden </span><span class="s2">= [-</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">bad_nonc </span><span class="s2">= [-</span><span class="s3">2</span><span class="s2">]</span>
        <span class="s1">nonc_f </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">noncentral_f</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">9.1393943263705211</span><span class="s2">,</span>
                            <span class="s3">13.025456344595602</span><span class="s2">,</span>
                            <span class="s3">8.8018098359100545</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">nonc_f</span><span class="s2">(</span><span class="s1">dfnum </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">dfden</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_f</span><span class="s2">, </span><span class="s1">bad_dfnum </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">dfden</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_f</span><span class="s2">, </span><span class="s1">dfnum </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">bad_dfden</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_f</span><span class="s2">, </span><span class="s1">dfnum </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">dfden</span><span class="s2">, </span><span class="s1">bad_nonc</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">nonc_f</span><span class="s2">(</span><span class="s1">dfnum</span><span class="s2">, </span><span class="s1">dfden </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_f</span><span class="s2">, </span><span class="s1">bad_dfnum</span><span class="s2">, </span><span class="s1">dfden </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_f</span><span class="s2">, </span><span class="s1">dfnum</span><span class="s2">, </span><span class="s1">bad_dfden </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_f</span><span class="s2">, </span><span class="s1">dfnum</span><span class="s2">, </span><span class="s1">dfden </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">bad_nonc</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">nonc_f</span><span class="s2">(</span><span class="s1">dfnum</span><span class="s2">, </span><span class="s1">dfden</span><span class="s2">, </span><span class="s1">nonc </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_f</span><span class="s2">, </span><span class="s1">bad_dfnum</span><span class="s2">, </span><span class="s1">dfden</span><span class="s2">, </span><span class="s1">nonc </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_f</span><span class="s2">, </span><span class="s1">dfnum</span><span class="s2">, </span><span class="s1">bad_dfden</span><span class="s2">, </span><span class="s1">nonc </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_f</span><span class="s2">, </span><span class="s1">dfnum</span><span class="s2">, </span><span class="s1">dfden</span><span class="s2">, </span><span class="s1">bad_nonc </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_noncentral_f_small_df</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">6.869638627492048</span><span class="s2">, </span><span class="s3">0.785880199263955</span><span class="s2">])</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">noncentral_f</span><span class="s2">(</span><span class="s3">0.9</span><span class="s2">, </span><span class="s3">0.9</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s3">2</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_chisquare</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">df </span><span class="s2">= [</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">bad_df </span><span class="s2">= [-</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">chisquare </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">chisquare</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">0.57022801133088286</span><span class="s2">,</span>
                            <span class="s3">0.51947702108840776</span><span class="s2">,</span>
                            <span class="s3">0.1320969254923558</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">chisquare</span><span class="s2">(</span><span class="s1">df </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">chisquare</span><span class="s2">, </span><span class="s1">bad_df </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_noncentral_chisquare</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">df </span><span class="s2">= [</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">nonc </span><span class="s2">= [</span><span class="s3">2</span><span class="s2">]</span>
        <span class="s1">bad_df </span><span class="s2">= [-</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">bad_nonc </span><span class="s2">= [-</span><span class="s3">2</span><span class="s2">]</span>
        <span class="s1">nonc_chi </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">noncentral_chisquare</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">9.0015599467913763</span><span class="s2">,</span>
                            <span class="s3">4.5804135049718742</span><span class="s2">,</span>
                            <span class="s3">6.0872302432834564</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">nonc_chi</span><span class="s2">(</span><span class="s1">df </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_chi</span><span class="s2">, </span><span class="s1">bad_df </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_chi</span><span class="s2">, </span><span class="s1">df </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">bad_nonc</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">nonc_chi</span><span class="s2">(</span><span class="s1">df</span><span class="s2">, </span><span class="s1">nonc </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_chi</span><span class="s2">, </span><span class="s1">bad_df</span><span class="s2">, </span><span class="s1">nonc </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_chi</span><span class="s2">, </span><span class="s1">df</span><span class="s2">, </span><span class="s1">bad_nonc </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_standard_t</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">df </span><span class="s2">= [</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">bad_df </span><span class="s2">= [-</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">t </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_t</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">3.0702872575217643</span><span class="s2">,</span>
                            <span class="s3">5.8560725167361607</span><span class="s2">,</span>
                            <span class="s3">1.0274791436474273</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">t</span><span class="s2">(</span><span class="s1">df </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">t</span><span class="s2">, </span><span class="s1">bad_df </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_vonmises</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">mu </span><span class="s2">= [</span><span class="s3">2</span><span class="s2">]</span>
        <span class="s1">kappa </span><span class="s2">= [</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">bad_kappa </span><span class="s2">= [-</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">vonmises </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">vonmises</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">2.9883443664201312</span><span class="s2">,</span>
                            <span class="s2">-</span><span class="s3">2.7064099483995943</span><span class="s2">,</span>
                            <span class="s2">-</span><span class="s3">1.8672476700665914</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">vonmises</span><span class="s2">(</span><span class="s1">mu </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">kappa</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">vonmises</span><span class="s2">, </span><span class="s1">mu </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">bad_kappa</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">vonmises</span><span class="s2">(</span><span class="s1">mu</span><span class="s2">, </span><span class="s1">kappa </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">vonmises</span><span class="s2">, </span><span class="s1">mu</span><span class="s2">, </span><span class="s1">bad_kappa </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_pareto</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">a </span><span class="s2">= [</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">bad_a </span><span class="s2">= [-</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">pareto </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">pareto</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">1.1405622680198362</span><span class="s2">,</span>
                            <span class="s3">1.1465519762044529</span><span class="s2">,</span>
                            <span class="s3">1.0389564467453547</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">pareto</span><span class="s2">(</span><span class="s1">a </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">pareto</span><span class="s2">, </span><span class="s1">bad_a </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_weibull</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">a </span><span class="s2">= [</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">bad_a </span><span class="s2">= [-</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">weibull </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">weibull</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">0.76106853658845242</span><span class="s2">,</span>
                            <span class="s3">0.76386282278691653</span><span class="s2">,</span>
                            <span class="s3">0.71243813125891797</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">weibull</span><span class="s2">(</span><span class="s1">a </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">weibull</span><span class="s2">, </span><span class="s1">bad_a </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_power</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">a </span><span class="s2">= [</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">bad_a </span><span class="s2">= [-</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">power </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">power</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">0.53283302478975902</span><span class="s2">,</span>
                            <span class="s3">0.53413660089041659</span><span class="s2">,</span>
                            <span class="s3">0.50955303552646702</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">power</span><span class="s2">(</span><span class="s1">a </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">power</span><span class="s2">, </span><span class="s1">bad_a </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_laplace</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">loc </span><span class="s2">= [</span><span class="s3">0</span><span class="s2">]</span>
        <span class="s1">scale </span><span class="s2">= [</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">bad_scale </span><span class="s2">= [-</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">laplace </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">laplace</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">0.067921356028507157</span><span class="s2">,</span>
                            <span class="s3">0.070715642226971326</span><span class="s2">,</span>
                            <span class="s3">0.019290950698972624</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">laplace</span><span class="s2">(</span><span class="s1">loc </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">laplace</span><span class="s2">, </span><span class="s1">loc </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">bad_scale</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">laplace</span><span class="s2">(</span><span class="s1">loc</span><span class="s2">, </span><span class="s1">scale </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">laplace</span><span class="s2">, </span><span class="s1">loc</span><span class="s2">, </span><span class="s1">bad_scale </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_gumbel</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">loc </span><span class="s2">= [</span><span class="s3">0</span><span class="s2">]</span>
        <span class="s1">scale </span><span class="s2">= [</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">bad_scale </span><span class="s2">= [-</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">gumbel </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">gumbel</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">0.2730318639556768</span><span class="s2">,</span>
                            <span class="s3">0.26936705726291116</span><span class="s2">,</span>
                            <span class="s3">0.33906220393037939</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">gumbel</span><span class="s2">(</span><span class="s1">loc </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">gumbel</span><span class="s2">, </span><span class="s1">loc </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">bad_scale</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">gumbel</span><span class="s2">(</span><span class="s1">loc</span><span class="s2">, </span><span class="s1">scale </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">gumbel</span><span class="s2">, </span><span class="s1">loc</span><span class="s2">, </span><span class="s1">bad_scale </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_logistic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">loc </span><span class="s2">= [</span><span class="s3">0</span><span class="s2">]</span>
        <span class="s1">scale </span><span class="s2">= [</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">bad_scale </span><span class="s2">= [-</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">logistic </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">logistic</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">0.13152135837586171</span><span class="s2">,</span>
                            <span class="s3">0.13675915696285773</span><span class="s2">,</span>
                            <span class="s3">0.038216792802833396</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">logistic</span><span class="s2">(</span><span class="s1">loc </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">logistic</span><span class="s2">, </span><span class="s1">loc </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">bad_scale</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">logistic</span><span class="s2">(</span><span class="s1">loc</span><span class="s2">, </span><span class="s1">scale </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">logistic</span><span class="s2">, </span><span class="s1">loc</span><span class="s2">, </span><span class="s1">bad_scale </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_lognormal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">mean </span><span class="s2">= [</span><span class="s3">0</span><span class="s2">]</span>
        <span class="s1">sigma </span><span class="s2">= [</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">bad_sigma </span><span class="s2">= [-</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">lognormal </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">lognormal</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">9.1422086044848427</span><span class="s2">,</span>
                            <span class="s3">8.4013952870126261</span><span class="s2">,</span>
                            <span class="s3">6.3073234116578671</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">lognormal</span><span class="s2">(</span><span class="s1">mean </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">sigma</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">lognormal</span><span class="s2">, </span><span class="s1">mean </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">bad_sigma</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">lognormal</span><span class="s2">(</span><span class="s1">mean</span><span class="s2">, </span><span class="s1">sigma </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">lognormal</span><span class="s2">, </span><span class="s1">mean</span><span class="s2">, </span><span class="s1">bad_sigma </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_rayleigh</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">scale </span><span class="s2">= [</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">bad_scale </span><span class="s2">= [-</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">rayleigh </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">rayleigh</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">1.2337491937897689</span><span class="s2">,</span>
                            <span class="s3">1.2360119924878694</span><span class="s2">,</span>
                            <span class="s3">1.1936818095781789</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">rayleigh</span><span class="s2">(</span><span class="s1">scale </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">rayleigh</span><span class="s2">, </span><span class="s1">bad_scale </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_wald</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">mean </span><span class="s2">= [</span><span class="s3">0.5</span><span class="s2">]</span>
        <span class="s1">scale </span><span class="s2">= [</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">bad_mean </span><span class="s2">= [</span><span class="s3">0</span><span class="s2">]</span>
        <span class="s1">bad_scale </span><span class="s2">= [-</span><span class="s3">2</span><span class="s2">]</span>
        <span class="s1">wald </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">wald</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">0.11873681120271318</span><span class="s2">,</span>
                            <span class="s3">0.12450084820795027</span><span class="s2">,</span>
                            <span class="s3">0.9096122728408238</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">wald</span><span class="s2">(</span><span class="s1">mean </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">wald</span><span class="s2">, </span><span class="s1">bad_mean </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">wald</span><span class="s2">, </span><span class="s1">mean </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">bad_scale</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">wald</span><span class="s2">(</span><span class="s1">mean</span><span class="s2">, </span><span class="s1">scale </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">wald</span><span class="s2">, </span><span class="s1">bad_mean</span><span class="s2">, </span><span class="s1">scale </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">wald</span><span class="s2">, </span><span class="s1">mean</span><span class="s2">, </span><span class="s1">bad_scale </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">wald</span><span class="s2">, </span><span class="s3">0.0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">wald</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.0</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_triangular</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">left </span><span class="s2">= [</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">right </span><span class="s2">= [</span><span class="s3">3</span><span class="s2">]</span>
        <span class="s1">mode </span><span class="s2">= [</span><span class="s3">2</span><span class="s2">]</span>
        <span class="s1">bad_left_one </span><span class="s2">= [</span><span class="s3">3</span><span class="s2">]</span>
        <span class="s1">bad_mode_one </span><span class="s2">= [</span><span class="s3">4</span><span class="s2">]</span>
        <span class="s1">bad_left_two</span><span class="s2">, </span><span class="s1">bad_mode_two </span><span class="s2">= </span><span class="s1">right </span><span class="s2">* </span><span class="s3">2</span>
        <span class="s1">triangular </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">triangular</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">2.03339048710429</span><span class="s2">,</span>
                            <span class="s3">2.0347400359389356</span><span class="s2">,</span>
                            <span class="s3">2.0095991069536208</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">triangular</span><span class="s2">(</span><span class="s1">left </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">mode</span><span class="s2">, </span><span class="s1">right</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">triangular</span><span class="s2">, </span><span class="s1">bad_left_one </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">mode</span><span class="s2">, </span><span class="s1">right</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">triangular</span><span class="s2">, </span><span class="s1">left </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">bad_mode_one</span><span class="s2">, </span><span class="s1">right</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">triangular</span><span class="s2">, </span><span class="s1">bad_left_two </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">bad_mode_two</span><span class="s2">,</span>
                      <span class="s1">right</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">triangular</span><span class="s2">(</span><span class="s1">left</span><span class="s2">, </span><span class="s1">mode </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">right</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">triangular</span><span class="s2">, </span><span class="s1">bad_left_one</span><span class="s2">, </span><span class="s1">mode </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">right</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">triangular</span><span class="s2">, </span><span class="s1">left</span><span class="s2">, </span><span class="s1">bad_mode_one </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">right</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">triangular</span><span class="s2">, </span><span class="s1">bad_left_two</span><span class="s2">, </span><span class="s1">bad_mode_two </span><span class="s2">* </span><span class="s3">3</span><span class="s2">,</span>
                      <span class="s1">right</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">triangular</span><span class="s2">(</span><span class="s1">left</span><span class="s2">, </span><span class="s1">mode</span><span class="s2">, </span><span class="s1">right </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">triangular</span><span class="s2">, </span><span class="s1">bad_left_one</span><span class="s2">, </span><span class="s1">mode</span><span class="s2">, </span><span class="s1">right </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">triangular</span><span class="s2">, </span><span class="s1">left</span><span class="s2">, </span><span class="s1">bad_mode_one</span><span class="s2">, </span><span class="s1">right </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">triangular</span><span class="s2">, </span><span class="s1">bad_left_two</span><span class="s2">, </span><span class="s1">bad_mode_two</span><span class="s2">,</span>
                      <span class="s1">right </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_binomial</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">n </span><span class="s2">= [</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">p </span><span class="s2">= [</span><span class="s3">0.5</span><span class="s2">]</span>
        <span class="s1">bad_n </span><span class="s2">= [-</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">bad_p_one </span><span class="s2">= [-</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">bad_p_two </span><span class="s2">= [</span><span class="s3">1.5</span><span class="s2">]</span>
        <span class="s1">binom </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">binomial</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">1</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, </span><span class="s3">1</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">binom</span><span class="s2">(</span><span class="s1">n </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">p</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">binom</span><span class="s2">, </span><span class="s1">bad_n </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">p</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">binom</span><span class="s2">, </span><span class="s1">n </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">bad_p_one</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">binom</span><span class="s2">, </span><span class="s1">n </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">bad_p_two</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">binom</span><span class="s2">(</span><span class="s1">n</span><span class="s2">, </span><span class="s1">p </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">binom</span><span class="s2">, </span><span class="s1">bad_n</span><span class="s2">, </span><span class="s1">p </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">binom</span><span class="s2">, </span><span class="s1">n</span><span class="s2">, </span><span class="s1">bad_p_one </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">binom</span><span class="s2">, </span><span class="s1">n</span><span class="s2">, </span><span class="s1">bad_p_two </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_negative_binomial</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">n </span><span class="s2">= [</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">p </span><span class="s2">= [</span><span class="s3">0.5</span><span class="s2">]</span>
        <span class="s1">bad_n </span><span class="s2">= [-</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">bad_p_one </span><span class="s2">= [-</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">bad_p_two </span><span class="s2">= [</span><span class="s3">1.5</span><span class="s2">]</span>
        <span class="s1">neg_binom </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">negative_binomial</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">1</span><span class="s2">, </span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">neg_binom</span><span class="s2">(</span><span class="s1">n </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">p</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">neg_binom</span><span class="s2">, </span><span class="s1">bad_n </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">p</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">neg_binom</span><span class="s2">, </span><span class="s1">n </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">bad_p_one</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">neg_binom</span><span class="s2">, </span><span class="s1">n </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">bad_p_two</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">neg_binom</span><span class="s2">(</span><span class="s1">n</span><span class="s2">, </span><span class="s1">p </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">neg_binom</span><span class="s2">, </span><span class="s1">bad_n</span><span class="s2">, </span><span class="s1">p </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">neg_binom</span><span class="s2">, </span><span class="s1">n</span><span class="s2">, </span><span class="s1">bad_p_one </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">neg_binom</span><span class="s2">, </span><span class="s1">n</span><span class="s2">, </span><span class="s1">bad_p_two </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_poisson</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">max_lam </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">().</span><span class="s1">_poisson_lam_max</span>

        <span class="s1">lam </span><span class="s2">= [</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">bad_lam_one </span><span class="s2">= [-</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">bad_lam_two </span><span class="s2">= [</span><span class="s1">max_lam </span><span class="s2">* </span><span class="s3">2</span><span class="s2">]</span>
        <span class="s1">poisson </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">poisson</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">1</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, </span><span class="s3">0</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">poisson</span><span class="s2">(</span><span class="s1">lam </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">poisson</span><span class="s2">, </span><span class="s1">bad_lam_one </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">poisson</span><span class="s2">, </span><span class="s1">bad_lam_two </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_zipf</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">a </span><span class="s2">= [</span><span class="s3">2</span><span class="s2">]</span>
        <span class="s1">bad_a </span><span class="s2">= [</span><span class="s3">0</span><span class="s2">]</span>
        <span class="s1">zipf </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">zipf</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">2</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s3">1</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">zipf</span><span class="s2">(</span><span class="s1">a </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">zipf</span><span class="s2">, </span><span class="s1">bad_a </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s0">with </span><span class="s1">np</span><span class="s2">.</span><span class="s1">errstate</span><span class="s2">(</span><span class="s1">invalid</span><span class="s2">=</span><span class="s5">'ignore'</span><span class="s2">):</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">zipf</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">)</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">zipf</span><span class="s2">, [</span><span class="s3">0</span><span class="s2">, </span><span class="s3">0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_geometric</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">p </span><span class="s2">= [</span><span class="s3">0.5</span><span class="s2">]</span>
        <span class="s1">bad_p_one </span><span class="s2">= [-</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">bad_p_two </span><span class="s2">= [</span><span class="s3">1.5</span><span class="s2">]</span>
        <span class="s1">geom </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">geometric</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">2</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s3">2</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">geom</span><span class="s2">(</span><span class="s1">p </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">geom</span><span class="s2">, </span><span class="s1">bad_p_one </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">geom</span><span class="s2">, </span><span class="s1">bad_p_two </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_hypergeometric</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">ngood </span><span class="s2">= [</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">nbad </span><span class="s2">= [</span><span class="s3">2</span><span class="s2">]</span>
        <span class="s1">nsample </span><span class="s2">= [</span><span class="s3">2</span><span class="s2">]</span>
        <span class="s1">bad_ngood </span><span class="s2">= [-</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">bad_nbad </span><span class="s2">= [-</span><span class="s3">2</span><span class="s2">]</span>
        <span class="s1">bad_nsample_one </span><span class="s2">= [</span><span class="s3">0</span><span class="s2">]</span>
        <span class="s1">bad_nsample_two </span><span class="s2">= [</span><span class="s3">4</span><span class="s2">]</span>
        <span class="s1">hypergeom </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">hypergeometric</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">1</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, </span><span class="s3">1</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">hypergeom</span><span class="s2">(</span><span class="s1">ngood </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">nbad</span><span class="s2">, </span><span class="s1">nsample</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s1">bad_ngood </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">nbad</span><span class="s2">, </span><span class="s1">nsample</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s1">ngood </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">bad_nbad</span><span class="s2">, </span><span class="s1">nsample</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s1">ngood </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">nbad</span><span class="s2">, </span><span class="s1">bad_nsample_one</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s1">ngood </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">nbad</span><span class="s2">, </span><span class="s1">bad_nsample_two</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">hypergeom</span><span class="s2">(</span><span class="s1">ngood</span><span class="s2">, </span><span class="s1">nbad </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">nsample</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s1">bad_ngood</span><span class="s2">, </span><span class="s1">nbad </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">nsample</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s1">ngood</span><span class="s2">, </span><span class="s1">bad_nbad </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">nsample</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s1">ngood</span><span class="s2">, </span><span class="s1">nbad </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">bad_nsample_one</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s1">ngood</span><span class="s2">, </span><span class="s1">nbad </span><span class="s2">* </span><span class="s3">3</span><span class="s2">, </span><span class="s1">bad_nsample_two</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">hypergeom</span><span class="s2">(</span><span class="s1">ngood</span><span class="s2">, </span><span class="s1">nbad</span><span class="s2">, </span><span class="s1">nsample </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s1">bad_ngood</span><span class="s2">, </span><span class="s1">nbad</span><span class="s2">, </span><span class="s1">nsample </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s1">ngood</span><span class="s2">, </span><span class="s1">bad_nbad</span><span class="s2">, </span><span class="s1">nsample </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s1">ngood</span><span class="s2">, </span><span class="s1">nbad</span><span class="s2">, </span><span class="s1">bad_nsample_one </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s1">ngood</span><span class="s2">, </span><span class="s1">nbad</span><span class="s2">, </span><span class="s1">bad_nsample_two </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_logseries</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">p </span><span class="s2">= [</span><span class="s3">0.5</span><span class="s2">]</span>
        <span class="s1">bad_p_one </span><span class="s2">= [</span><span class="s3">2</span><span class="s2">]</span>
        <span class="s1">bad_p_two </span><span class="s2">= [-</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">logseries </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">logseries</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">1</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, </span><span class="s3">1</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setSeed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">logseries</span><span class="s2">(</span><span class="s1">p </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">logseries</span><span class="s2">, </span><span class="s1">bad_p_one </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">logseries</span><span class="s2">, </span><span class="s1">bad_p_two </span><span class="s2">* </span><span class="s3">3</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">skipif</span><span class="s2">(</span><span class="s1">IS_WASM</span><span class="s2">, </span><span class="s1">reason</span><span class="s2">=</span><span class="s5">&quot;can't start thread&quot;</span><span class="s2">)</span>
<span class="s0">class </span><span class="s1">TestThread</span><span class="s2">:</span>
    <span class="s4"># make sure each state produces the same sequence even in threads</span>
    <span class="s0">def </span><span class="s1">setup_method</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">seeds </span><span class="s2">= </span><span class="s1">range</span><span class="s2">(</span><span class="s3">4</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">check_function</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">function</span><span class="s2">, </span><span class="s1">sz</span><span class="s2">):</span>
        <span class="s0">from </span><span class="s1">threading </span><span class="s0">import </span><span class="s1">Thread</span>

        <span class="s1">out1 </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">empty</span><span class="s2">((</span><span class="s1">len</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seeds</span><span class="s2">),) + </span><span class="s1">sz</span><span class="s2">)</span>
        <span class="s1">out2 </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">empty</span><span class="s2">((</span><span class="s1">len</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seeds</span><span class="s2">),) + </span><span class="s1">sz</span><span class="s2">)</span>

        <span class="s4"># threaded generation</span>
        <span class="s1">t </span><span class="s2">= [</span><span class="s1">Thread</span><span class="s2">(</span><span class="s1">target</span><span class="s2">=</span><span class="s1">function</span><span class="s2">, </span><span class="s1">args</span><span class="s2">=(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">(</span><span class="s1">s</span><span class="s2">), </span><span class="s1">o</span><span class="s2">))</span>
             <span class="s0">for </span><span class="s1">s</span><span class="s2">, </span><span class="s1">o </span><span class="s0">in </span><span class="s1">zip</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seeds</span><span class="s2">, </span><span class="s1">out1</span><span class="s2">)]</span>
        <span class="s2">[</span><span class="s1">x</span><span class="s2">.</span><span class="s1">start</span><span class="s2">() </span><span class="s0">for </span><span class="s1">x </span><span class="s0">in </span><span class="s1">t</span><span class="s2">]</span>
        <span class="s2">[</span><span class="s1">x</span><span class="s2">.</span><span class="s1">join</span><span class="s2">() </span><span class="s0">for </span><span class="s1">x </span><span class="s0">in </span><span class="s1">t</span><span class="s2">]</span>

        <span class="s4"># the same serial</span>
        <span class="s0">for </span><span class="s1">s</span><span class="s2">, </span><span class="s1">o </span><span class="s0">in </span><span class="s1">zip</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seeds</span><span class="s2">, </span><span class="s1">out2</span><span class="s2">):</span>
            <span class="s1">function</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">(</span><span class="s1">s</span><span class="s2">), </span><span class="s1">o</span><span class="s2">)</span>

        <span class="s4"># these platforms change x87 fpu precision mode in threads</span>
        <span class="s0">if </span><span class="s1">np</span><span class="s2">.</span><span class="s1">intp</span><span class="s2">().</span><span class="s1">dtype</span><span class="s2">.</span><span class="s1">itemsize </span><span class="s2">== </span><span class="s3">4 </span><span class="s0">and </span><span class="s1">sys</span><span class="s2">.</span><span class="s1">platform </span><span class="s2">== </span><span class="s5">&quot;win32&quot;</span><span class="s2">:</span>
            <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">out1</span><span class="s2">, </span><span class="s1">out2</span><span class="s2">)</span>
        <span class="s0">else</span><span class="s2">:</span>
            <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">out1</span><span class="s2">, </span><span class="s1">out2</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_normal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">def </span><span class="s1">gen_random</span><span class="s2">(</span><span class="s1">state</span><span class="s2">, </span><span class="s1">out</span><span class="s2">):</span>
            <span class="s1">out</span><span class="s2">[...] = </span><span class="s1">state</span><span class="s2">.</span><span class="s1">normal</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=</span><span class="s3">10000</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">check_function</span><span class="s2">(</span><span class="s1">gen_random</span><span class="s2">, </span><span class="s1">sz</span><span class="s2">=(</span><span class="s3">10000</span><span class="s2">,))</span>

    <span class="s0">def </span><span class="s1">test_exp</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">def </span><span class="s1">gen_random</span><span class="s2">(</span><span class="s1">state</span><span class="s2">, </span><span class="s1">out</span><span class="s2">):</span>
            <span class="s1">out</span><span class="s2">[...] = </span><span class="s1">state</span><span class="s2">.</span><span class="s1">exponential</span><span class="s2">(</span><span class="s1">scale</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">ones</span><span class="s2">((</span><span class="s3">100</span><span class="s2">, </span><span class="s3">1000</span><span class="s2">)))</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">check_function</span><span class="s2">(</span><span class="s1">gen_random</span><span class="s2">, </span><span class="s1">sz</span><span class="s2">=(</span><span class="s3">100</span><span class="s2">, </span><span class="s3">1000</span><span class="s2">))</span>

    <span class="s0">def </span><span class="s1">test_multinomial</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">def </span><span class="s1">gen_random</span><span class="s2">(</span><span class="s1">state</span><span class="s2">, </span><span class="s1">out</span><span class="s2">):</span>
            <span class="s1">out</span><span class="s2">[...] = </span><span class="s1">state</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s3">10</span><span class="s2">, [</span><span class="s3">1</span><span class="s2">/</span><span class="s3">6.</span><span class="s2">]*</span><span class="s3">6</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s3">10000</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">check_function</span><span class="s2">(</span><span class="s1">gen_random</span><span class="s2">, </span><span class="s1">sz</span><span class="s2">=(</span><span class="s3">10000</span><span class="s2">, </span><span class="s3">6</span><span class="s2">))</span>


<span class="s4"># See Issue #4263</span>
<span class="s0">class </span><span class="s1">TestSingleEltArrayInput</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">setup_method</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">argOne </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">2</span><span class="s2">])</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">argTwo </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">3</span><span class="s2">])</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">argThree </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">4</span><span class="s2">])</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">tgtShape </span><span class="s2">= (</span><span class="s3">1</span><span class="s2">,)</span>

    <span class="s0">def </span><span class="s1">test_one_arg_funcs</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">funcs </span><span class="s2">= (</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">exponential</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_gamma</span><span class="s2">,</span>
                 <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">chisquare</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_t</span><span class="s2">,</span>
                 <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">pareto</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">weibull</span><span class="s2">,</span>
                 <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">power</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">rayleigh</span><span class="s2">,</span>
                 <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">poisson</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">zipf</span><span class="s2">,</span>
                 <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">geometric</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">logseries</span><span class="s2">)</span>

        <span class="s1">probfuncs </span><span class="s2">= (</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">geometric</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">logseries</span><span class="s2">)</span>

        <span class="s0">for </span><span class="s1">func </span><span class="s0">in </span><span class="s1">funcs</span><span class="s2">:</span>
            <span class="s0">if </span><span class="s1">func </span><span class="s0">in </span><span class="s1">probfuncs</span><span class="s2">:  </span><span class="s4"># p &lt; 1.0</span>
                <span class="s1">out </span><span class="s2">= </span><span class="s1">func</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">0.5</span><span class="s2">]))</span>

            <span class="s0">else</span><span class="s2">:</span>
                <span class="s1">out </span><span class="s2">= </span><span class="s1">func</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">argOne</span><span class="s2">)</span>

            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">out</span><span class="s2">.</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">tgtShape</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_two_arg_funcs</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">funcs </span><span class="s2">= (</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">uniform</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">normal</span><span class="s2">,</span>
                 <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">beta</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">gamma</span><span class="s2">,</span>
                 <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">f</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">noncentral_chisquare</span><span class="s2">,</span>
                 <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">vonmises</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">laplace</span><span class="s2">,</span>
                 <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">gumbel</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">logistic</span><span class="s2">,</span>
                 <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">lognormal</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">wald</span><span class="s2">,</span>
                 <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">binomial</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">negative_binomial</span><span class="s2">)</span>

        <span class="s1">probfuncs </span><span class="s2">= (</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">binomial</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">negative_binomial</span><span class="s2">)</span>

        <span class="s0">for </span><span class="s1">func </span><span class="s0">in </span><span class="s1">funcs</span><span class="s2">:</span>
            <span class="s0">if </span><span class="s1">func </span><span class="s0">in </span><span class="s1">probfuncs</span><span class="s2">:  </span><span class="s4"># p &lt;= 1</span>
                <span class="s1">argTwo </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">0.5</span><span class="s2">])</span>

            <span class="s0">else</span><span class="s2">:</span>
                <span class="s1">argTwo </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">argTwo</span>

            <span class="s1">out </span><span class="s2">= </span><span class="s1">func</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">argOne</span><span class="s2">, </span><span class="s1">argTwo</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">out</span><span class="s2">.</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">tgtShape</span><span class="s2">)</span>

            <span class="s1">out </span><span class="s2">= </span><span class="s1">func</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">argOne</span><span class="s2">[</span><span class="s3">0</span><span class="s2">], </span><span class="s1">argTwo</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">out</span><span class="s2">.</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">tgtShape</span><span class="s2">)</span>

            <span class="s1">out </span><span class="s2">= </span><span class="s1">func</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">argOne</span><span class="s2">, </span><span class="s1">argTwo</span><span class="s2">[</span><span class="s3">0</span><span class="s2">])</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">out</span><span class="s2">.</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">tgtShape</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_randint</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">itype </span><span class="s2">= [</span><span class="s1">bool</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">int8</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint8</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">int16</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint16</span><span class="s2">,</span>
                 <span class="s1">np</span><span class="s2">.</span><span class="s1">int32</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint32</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint64</span><span class="s2">]</span>
        <span class="s1">func </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">randint</span>
        <span class="s1">high </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">1</span><span class="s2">])</span>
        <span class="s1">low </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">0</span><span class="s2">])</span>

        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">itype</span><span class="s2">:</span>
            <span class="s1">out </span><span class="s2">= </span><span class="s1">func</span><span class="s2">(</span><span class="s1">low</span><span class="s2">, </span><span class="s1">high</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">out</span><span class="s2">.</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">tgtShape</span><span class="s2">)</span>

            <span class="s1">out </span><span class="s2">= </span><span class="s1">func</span><span class="s2">(</span><span class="s1">low</span><span class="s2">[</span><span class="s3">0</span><span class="s2">], </span><span class="s1">high</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">out</span><span class="s2">.</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">tgtShape</span><span class="s2">)</span>

            <span class="s1">out </span><span class="s2">= </span><span class="s1">func</span><span class="s2">(</span><span class="s1">low</span><span class="s2">, </span><span class="s1">high</span><span class="s2">[</span><span class="s3">0</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">out</span><span class="s2">.</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">tgtShape</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_three_arg_funcs</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">funcs </span><span class="s2">= [</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">noncentral_f</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">triangular</span><span class="s2">,</span>
                 <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">hypergeometric</span><span class="s2">]</span>

        <span class="s0">for </span><span class="s1">func </span><span class="s0">in </span><span class="s1">funcs</span><span class="s2">:</span>
            <span class="s1">out </span><span class="s2">= </span><span class="s1">func</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">argOne</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">argTwo</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">argThree</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">out</span><span class="s2">.</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">tgtShape</span><span class="s2">)</span>

            <span class="s1">out </span><span class="s2">= </span><span class="s1">func</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">argOne</span><span class="s2">[</span><span class="s3">0</span><span class="s2">], </span><span class="s1">self</span><span class="s2">.</span><span class="s1">argTwo</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">argThree</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">out</span><span class="s2">.</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">tgtShape</span><span class="s2">)</span>

            <span class="s1">out </span><span class="s2">= </span><span class="s1">func</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">argOne</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">argTwo</span><span class="s2">[</span><span class="s3">0</span><span class="s2">], </span><span class="s1">self</span><span class="s2">.</span><span class="s1">argThree</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">out</span><span class="s2">.</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">tgtShape</span><span class="s2">)</span>
</pre>
</body>
</html>