<html>
<head>
<title>test_sparse.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #5f826b; font-style: italic;}
.s1 { color: #bcbec4;}
.s2 { color: #cf8e6d;}
.s3 { color: #bcbec4;}
.s4 { color: #2aacb8;}
.s5 { color: #6aab73;}
.s6 { color: #7a7e85;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_sparse.py</font>
</center></td></tr></table>
<pre><span class="s0">&quot;&quot;&quot; 
This file contains a minimal set of tests for compliance with the extension 
array interface test suite, and should contain no other tests. 
The test suite for the full functionality of the array is located in 
`pandas/tests/arrays/`. 
 
The tests in this file are inherited from the BaseExtensionTests, and only 
minimal tweaks should be applied to get the tests passing (by overwriting a 
parent method). 
 
Additional tests should either be added to one of the BaseExtensionTests 
classes (if they are relevant for the extension interface for all dtypes), or 
be added to the array-specific tests in `pandas/tests/arrays/`. 
 
&quot;&quot;&quot;</span>

<span class="s2">import </span><span class="s1">numpy </span><span class="s2">as </span><span class="s1">np</span>
<span class="s2">import </span><span class="s1">pytest</span>

<span class="s2">from </span><span class="s1">pandas</span><span class="s3">.</span><span class="s1">errors </span><span class="s2">import </span><span class="s1">PerformanceWarning</span>

<span class="s2">import </span><span class="s1">pandas </span><span class="s2">as </span><span class="s1">pd</span>
<span class="s2">from </span><span class="s1">pandas </span><span class="s2">import </span><span class="s1">SparseDtype</span>
<span class="s2">import </span><span class="s1">pandas</span><span class="s3">.</span><span class="s1">_testing </span><span class="s2">as </span><span class="s1">tm</span>
<span class="s2">from </span><span class="s1">pandas</span><span class="s3">.</span><span class="s1">arrays </span><span class="s2">import </span><span class="s1">SparseArray</span>
<span class="s2">from </span><span class="s1">pandas</span><span class="s3">.</span><span class="s1">tests</span><span class="s3">.</span><span class="s1">extension </span><span class="s2">import </span><span class="s1">base</span>


<span class="s2">def </span><span class="s1">make_data</span><span class="s3">(</span><span class="s1">fill_value</span><span class="s3">):</span>
    <span class="s1">rng </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s4">2</span><span class="s3">)</span>
    <span class="s2">if </span><span class="s1">np</span><span class="s3">.</span><span class="s1">isnan</span><span class="s3">(</span><span class="s1">fill_value</span><span class="s3">):</span>
        <span class="s1">data </span><span class="s3">= </span><span class="s1">rng</span><span class="s3">.</span><span class="s1">uniform</span><span class="s3">(</span><span class="s1">size</span><span class="s3">=</span><span class="s4">100</span><span class="s3">)</span>
    <span class="s2">else</span><span class="s3">:</span>
        <span class="s1">data </span><span class="s3">= </span><span class="s1">rng</span><span class="s3">.</span><span class="s1">integers</span><span class="s3">(</span><span class="s4">1</span><span class="s3">, </span><span class="s4">100</span><span class="s3">, </span><span class="s1">size</span><span class="s3">=</span><span class="s4">100</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">int</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">data</span><span class="s3">[</span><span class="s4">0</span><span class="s3">] == </span><span class="s1">data</span><span class="s3">[</span><span class="s4">1</span><span class="s3">]:</span>
            <span class="s1">data</span><span class="s3">[</span><span class="s4">0</span><span class="s3">] += </span><span class="s4">1</span>

    <span class="s1">data</span><span class="s3">[</span><span class="s4">2</span><span class="s3">::</span><span class="s4">3</span><span class="s3">] = </span><span class="s1">fill_value</span>
    <span class="s2">return </span><span class="s1">data</span>


<span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">fixture</span>
<span class="s2">def </span><span class="s1">dtype</span><span class="s3">():</span>
    <span class="s2">return </span><span class="s1">SparseDtype</span><span class="s3">()</span>


<span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">fixture</span><span class="s3">(</span><span class="s1">params</span><span class="s3">=[</span><span class="s4">0</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">])</span>
<span class="s2">def </span><span class="s1">data</span><span class="s3">(</span><span class="s1">request</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot;Length-100 PeriodArray for semantics test.&quot;&quot;&quot;</span>
    <span class="s1">res </span><span class="s3">= </span><span class="s1">SparseArray</span><span class="s3">(</span><span class="s1">make_data</span><span class="s3">(</span><span class="s1">request</span><span class="s3">.</span><span class="s1">param</span><span class="s3">), </span><span class="s1">fill_value</span><span class="s3">=</span><span class="s1">request</span><span class="s3">.</span><span class="s1">param</span><span class="s3">)</span>
    <span class="s2">return </span><span class="s1">res</span>


<span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">fixture</span>
<span class="s2">def </span><span class="s1">data_for_twos</span><span class="s3">():</span>
    <span class="s2">return </span><span class="s1">SparseArray</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">ones</span><span class="s3">(</span><span class="s4">100</span><span class="s3">) * </span><span class="s4">2</span><span class="s3">)</span>


<span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">fixture</span><span class="s3">(</span><span class="s1">params</span><span class="s3">=[</span><span class="s4">0</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">])</span>
<span class="s2">def </span><span class="s1">data_missing</span><span class="s3">(</span><span class="s1">request</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot;Length 2 array with [NA, Valid]&quot;&quot;&quot;</span>
    <span class="s2">return </span><span class="s1">SparseArray</span><span class="s3">([</span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s4">1</span><span class="s3">], </span><span class="s1">fill_value</span><span class="s3">=</span><span class="s1">request</span><span class="s3">.</span><span class="s1">param</span><span class="s3">)</span>


<span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">fixture</span><span class="s3">(</span><span class="s1">params</span><span class="s3">=[</span><span class="s4">0</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">])</span>
<span class="s2">def </span><span class="s1">data_repeated</span><span class="s3">(</span><span class="s1">request</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot;Return different versions of data for count times&quot;&quot;&quot;</span>

    <span class="s2">def </span><span class="s1">gen</span><span class="s3">(</span><span class="s1">count</span><span class="s3">):</span>
        <span class="s2">for </span><span class="s1">_ </span><span class="s2">in </span><span class="s1">range</span><span class="s3">(</span><span class="s1">count</span><span class="s3">):</span>
            <span class="s2">yield </span><span class="s1">SparseArray</span><span class="s3">(</span><span class="s1">make_data</span><span class="s3">(</span><span class="s1">request</span><span class="s3">.</span><span class="s1">param</span><span class="s3">), </span><span class="s1">fill_value</span><span class="s3">=</span><span class="s1">request</span><span class="s3">.</span><span class="s1">param</span><span class="s3">)</span>

    <span class="s2">yield </span><span class="s1">gen</span>


<span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">fixture</span><span class="s3">(</span><span class="s1">params</span><span class="s3">=[</span><span class="s4">0</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">])</span>
<span class="s2">def </span><span class="s1">data_for_sorting</span><span class="s3">(</span><span class="s1">request</span><span class="s3">):</span>
    <span class="s2">return </span><span class="s1">SparseArray</span><span class="s3">([</span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">, </span><span class="s4">1</span><span class="s3">], </span><span class="s1">fill_value</span><span class="s3">=</span><span class="s1">request</span><span class="s3">.</span><span class="s1">param</span><span class="s3">)</span>


<span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">fixture</span><span class="s3">(</span><span class="s1">params</span><span class="s3">=[</span><span class="s4">0</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">])</span>
<span class="s2">def </span><span class="s1">data_missing_for_sorting</span><span class="s3">(</span><span class="s1">request</span><span class="s3">):</span>
    <span class="s2">return </span><span class="s1">SparseArray</span><span class="s3">([</span><span class="s4">2</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s4">1</span><span class="s3">], </span><span class="s1">fill_value</span><span class="s3">=</span><span class="s1">request</span><span class="s3">.</span><span class="s1">param</span><span class="s3">)</span>


<span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">fixture</span>
<span class="s2">def </span><span class="s1">na_cmp</span><span class="s3">():</span>
    <span class="s2">return lambda </span><span class="s1">left</span><span class="s3">, </span><span class="s1">right</span><span class="s3">: </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">isna</span><span class="s3">(</span><span class="s1">left</span><span class="s3">) </span><span class="s2">and </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">isna</span><span class="s3">(</span><span class="s1">right</span><span class="s3">)</span>


<span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">fixture</span><span class="s3">(</span><span class="s1">params</span><span class="s3">=[</span><span class="s4">0</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">])</span>
<span class="s2">def </span><span class="s1">data_for_grouping</span><span class="s3">(</span><span class="s1">request</span><span class="s3">):</span>
    <span class="s2">return </span><span class="s1">SparseArray</span><span class="s3">([</span><span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">3</span><span class="s3">], </span><span class="s1">fill_value</span><span class="s3">=</span><span class="s1">request</span><span class="s3">.</span><span class="s1">param</span><span class="s3">)</span>


<span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">fixture</span><span class="s3">(</span><span class="s1">params</span><span class="s3">=[</span><span class="s4">0</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">])</span>
<span class="s2">def </span><span class="s1">data_for_compare</span><span class="s3">(</span><span class="s1">request</span><span class="s3">):</span>
    <span class="s2">return </span><span class="s1">SparseArray</span><span class="s3">([</span><span class="s4">0</span><span class="s3">, </span><span class="s4">0</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, -</span><span class="s4">2</span><span class="s3">, -</span><span class="s4">1</span><span class="s3">, </span><span class="s4">4</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">, </span><span class="s4">0</span><span class="s3">, </span><span class="s4">0</span><span class="s3">], </span><span class="s1">fill_value</span><span class="s3">=</span><span class="s1">request</span><span class="s3">.</span><span class="s1">param</span><span class="s3">)</span>


<span class="s2">class </span><span class="s1">BaseSparseTests</span><span class="s3">:</span>
    <span class="s2">def </span><span class="s1">_check_unsupported</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data</span><span class="s3">):</span>
        <span class="s2">if </span><span class="s1">data</span><span class="s3">.</span><span class="s1">dtype </span><span class="s3">== </span><span class="s1">SparseDtype</span><span class="s3">(</span><span class="s1">int</span><span class="s3">, </span><span class="s4">0</span><span class="s3">):</span>
            <span class="s1">pytest</span><span class="s3">.</span><span class="s1">skip</span><span class="s3">(</span><span class="s5">&quot;Can't store nan in int array.&quot;</span><span class="s3">)</span>


<span class="s2">class </span><span class="s1">TestDtype</span><span class="s3">(</span><span class="s1">BaseSparseTests</span><span class="s3">, </span><span class="s1">base</span><span class="s3">.</span><span class="s1">BaseDtypeTests</span><span class="s3">):</span>
    <span class="s2">def </span><span class="s1">test_array_type_with_arg</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">):</span>
        <span class="s2">assert </span><span class="s1">dtype</span><span class="s3">.</span><span class="s1">construct_array_type</span><span class="s3">() </span><span class="s2">is </span><span class="s1">SparseArray</span>


<span class="s2">class </span><span class="s1">TestInterface</span><span class="s3">(</span><span class="s1">BaseSparseTests</span><span class="s3">, </span><span class="s1">base</span><span class="s3">.</span><span class="s1">BaseInterfaceTests</span><span class="s3">):</span>
    <span class="s2">pass</span>


<span class="s2">class </span><span class="s1">TestConstructors</span><span class="s3">(</span><span class="s1">BaseSparseTests</span><span class="s3">, </span><span class="s1">base</span><span class="s3">.</span><span class="s1">BaseConstructorsTests</span><span class="s3">):</span>
    <span class="s2">pass</span>


<span class="s2">class </span><span class="s1">TestReshaping</span><span class="s3">(</span><span class="s1">BaseSparseTests</span><span class="s3">, </span><span class="s1">base</span><span class="s3">.</span><span class="s1">BaseReshapingTests</span><span class="s3">):</span>
    <span class="s2">def </span><span class="s1">test_concat_mixed_dtypes</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data</span><span class="s3">):</span>
        <span class="s6"># https://github.com/pandas-dev/pandas/issues/20762</span>
        <span class="s6"># This should be the same, aside from concat([sparse, float])</span>
        <span class="s1">df1 </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s5">&quot;A&quot;</span><span class="s3">: </span><span class="s1">data</span><span class="s3">[:</span><span class="s4">3</span><span class="s3">]})</span>
        <span class="s1">df2 </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s5">&quot;A&quot;</span><span class="s3">: [</span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">]})</span>
        <span class="s1">df3 </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s5">&quot;A&quot;</span><span class="s3">: [</span><span class="s5">&quot;a&quot;</span><span class="s3">, </span><span class="s5">&quot;b&quot;</span><span class="s3">, </span><span class="s5">&quot;c&quot;</span><span class="s3">]}).</span><span class="s1">astype</span><span class="s3">(</span><span class="s5">&quot;category&quot;</span><span class="s3">)</span>
        <span class="s1">dfs </span><span class="s3">= [</span><span class="s1">df1</span><span class="s3">, </span><span class="s1">df2</span><span class="s3">, </span><span class="s1">df3</span><span class="s3">]</span>

        <span class="s6"># dataframes</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">concat</span><span class="s3">(</span><span class="s1">dfs</span><span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">concat</span><span class="s3">(</span>
            <span class="s3">[</span><span class="s1">x</span><span class="s3">.</span><span class="s1">apply</span><span class="s3">(</span><span class="s2">lambda </span><span class="s1">s</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">asarray</span><span class="s3">(</span><span class="s1">s</span><span class="s3">).</span><span class="s1">astype</span><span class="s3">(</span><span class="s1">object</span><span class="s3">)) </span><span class="s2">for </span><span class="s1">x </span><span class="s2">in </span><span class="s1">dfs</span><span class="s3">]</span>
        <span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_frame_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s5">&quot;columns&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s3">[</span><span class="s5">&quot;A&quot;</span><span class="s3">, </span><span class="s5">&quot;B&quot;</span><span class="s3">],</span>
            <span class="s1">pd</span><span class="s3">.</span><span class="s1">MultiIndex</span><span class="s3">.</span><span class="s1">from_tuples</span><span class="s3">(</span>
                <span class="s3">[(</span><span class="s5">&quot;A&quot;</span><span class="s3">, </span><span class="s5">&quot;a&quot;</span><span class="s3">), (</span><span class="s5">&quot;A&quot;</span><span class="s3">, </span><span class="s5">&quot;b&quot;</span><span class="s3">)], </span><span class="s1">names</span><span class="s3">=[</span><span class="s5">&quot;outer&quot;</span><span class="s3">, </span><span class="s5">&quot;inner&quot;</span><span class="s3">]</span>
            <span class="s3">),</span>
        <span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s5">&quot;future_stack&quot;</span><span class="s3">, [</span><span class="s2">True</span><span class="s3">, </span><span class="s2">False</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_stack</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data</span><span class="s3">, </span><span class="s1">columns</span><span class="s3">, </span><span class="s1">future_stack</span><span class="s3">):</span>
        <span class="s1">super</span><span class="s3">().</span><span class="s1">test_stack</span><span class="s3">(</span><span class="s1">data</span><span class="s3">, </span><span class="s1">columns</span><span class="s3">, </span><span class="s1">future_stack</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_concat_columns</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data</span><span class="s3">, </span><span class="s1">na_value</span><span class="s3">):</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_unsupported</span><span class="s3">(</span><span class="s1">data</span><span class="s3">)</span>
        <span class="s1">super</span><span class="s3">().</span><span class="s1">test_concat_columns</span><span class="s3">(</span><span class="s1">data</span><span class="s3">, </span><span class="s1">na_value</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_concat_extension_arrays_copy_false</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data</span><span class="s3">, </span><span class="s1">na_value</span><span class="s3">):</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_unsupported</span><span class="s3">(</span><span class="s1">data</span><span class="s3">)</span>
        <span class="s1">super</span><span class="s3">().</span><span class="s1">test_concat_extension_arrays_copy_false</span><span class="s3">(</span><span class="s1">data</span><span class="s3">, </span><span class="s1">na_value</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_align</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data</span><span class="s3">, </span><span class="s1">na_value</span><span class="s3">):</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_unsupported</span><span class="s3">(</span><span class="s1">data</span><span class="s3">)</span>
        <span class="s1">super</span><span class="s3">().</span><span class="s1">test_align</span><span class="s3">(</span><span class="s1">data</span><span class="s3">, </span><span class="s1">na_value</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_align_frame</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data</span><span class="s3">, </span><span class="s1">na_value</span><span class="s3">):</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_unsupported</span><span class="s3">(</span><span class="s1">data</span><span class="s3">)</span>
        <span class="s1">super</span><span class="s3">().</span><span class="s1">test_align_frame</span><span class="s3">(</span><span class="s1">data</span><span class="s3">, </span><span class="s1">na_value</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_align_series_frame</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data</span><span class="s3">, </span><span class="s1">na_value</span><span class="s3">):</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_unsupported</span><span class="s3">(</span><span class="s1">data</span><span class="s3">)</span>
        <span class="s1">super</span><span class="s3">().</span><span class="s1">test_align_series_frame</span><span class="s3">(</span><span class="s1">data</span><span class="s3">, </span><span class="s1">na_value</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_merge</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data</span><span class="s3">, </span><span class="s1">na_value</span><span class="s3">):</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_unsupported</span><span class="s3">(</span><span class="s1">data</span><span class="s3">)</span>
        <span class="s1">super</span><span class="s3">().</span><span class="s1">test_merge</span><span class="s3">(</span><span class="s1">data</span><span class="s3">, </span><span class="s1">na_value</span><span class="s3">)</span>


<span class="s2">class </span><span class="s1">TestGetitem</span><span class="s3">(</span><span class="s1">BaseSparseTests</span><span class="s3">, </span><span class="s1">base</span><span class="s3">.</span><span class="s1">BaseGetitemTests</span><span class="s3">):</span>
    <span class="s2">def </span><span class="s1">test_get</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data</span><span class="s3">):</span>
        <span class="s1">ser </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">Series</span><span class="s3">(</span><span class="s1">data</span><span class="s3">, </span><span class="s1">index</span><span class="s3">=[</span><span class="s4">2 </span><span class="s3">* </span><span class="s1">i </span><span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">range</span><span class="s3">(</span><span class="s1">len</span><span class="s3">(</span><span class="s1">data</span><span class="s3">))])</span>
        <span class="s2">if </span><span class="s1">np</span><span class="s3">.</span><span class="s1">isnan</span><span class="s3">(</span><span class="s1">ser</span><span class="s3">.</span><span class="s1">values</span><span class="s3">.</span><span class="s1">fill_value</span><span class="s3">):</span>
            <span class="s2">assert </span><span class="s1">np</span><span class="s3">.</span><span class="s1">isnan</span><span class="s3">(</span><span class="s1">ser</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s4">4</span><span class="s3">)) </span><span class="s2">and </span><span class="s1">np</span><span class="s3">.</span><span class="s1">isnan</span><span class="s3">(</span><span class="s1">ser</span><span class="s3">.</span><span class="s1">iloc</span><span class="s3">[</span><span class="s4">2</span><span class="s3">])</span>
        <span class="s2">else</span><span class="s3">:</span>
            <span class="s2">assert </span><span class="s1">ser</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s4">4</span><span class="s3">) == </span><span class="s1">ser</span><span class="s3">.</span><span class="s1">iloc</span><span class="s3">[</span><span class="s4">2</span><span class="s3">]</span>
        <span class="s2">assert </span><span class="s1">ser</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s4">2</span><span class="s3">) == </span><span class="s1">ser</span><span class="s3">.</span><span class="s1">iloc</span><span class="s3">[</span><span class="s4">1</span><span class="s3">]</span>

    <span class="s2">def </span><span class="s1">test_reindex</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data</span><span class="s3">, </span><span class="s1">na_value</span><span class="s3">):</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_unsupported</span><span class="s3">(</span><span class="s1">data</span><span class="s3">)</span>
        <span class="s1">super</span><span class="s3">().</span><span class="s1">test_reindex</span><span class="s3">(</span><span class="s1">data</span><span class="s3">, </span><span class="s1">na_value</span><span class="s3">)</span>


<span class="s2">class </span><span class="s1">TestSetitem</span><span class="s3">(</span><span class="s1">BaseSparseTests</span><span class="s3">, </span><span class="s1">base</span><span class="s3">.</span><span class="s1">BaseSetitemTests</span><span class="s3">):</span>
    <span class="s2">pass</span>


<span class="s2">class </span><span class="s1">TestIndex</span><span class="s3">(</span><span class="s1">base</span><span class="s3">.</span><span class="s1">BaseIndexTests</span><span class="s3">):</span>
    <span class="s2">pass</span>


<span class="s2">class </span><span class="s1">TestMissing</span><span class="s3">(</span><span class="s1">BaseSparseTests</span><span class="s3">, </span><span class="s1">base</span><span class="s3">.</span><span class="s1">BaseMissingTests</span><span class="s3">):</span>
    <span class="s2">def </span><span class="s1">test_isna</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data_missing</span><span class="s3">):</span>
        <span class="s1">sarr </span><span class="s3">= </span><span class="s1">SparseArray</span><span class="s3">(</span><span class="s1">data_missing</span><span class="s3">)</span>
        <span class="s1">expected_dtype </span><span class="s3">= </span><span class="s1">SparseDtype</span><span class="s3">(</span><span class="s1">bool</span><span class="s3">, </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">isna</span><span class="s3">(</span><span class="s1">data_missing</span><span class="s3">.</span><span class="s1">dtype</span><span class="s3">.</span><span class="s1">fill_value</span><span class="s3">))</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">SparseArray</span><span class="s3">([</span><span class="s2">True</span><span class="s3">, </span><span class="s2">False</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">expected_dtype</span><span class="s3">)</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">sarr</span><span class="s3">.</span><span class="s1">isna</span><span class="s3">()</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_sp_array_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

        <span class="s6"># test isna for arr without na</span>
        <span class="s1">sarr </span><span class="s3">= </span><span class="s1">sarr</span><span class="s3">.</span><span class="s1">fillna</span><span class="s3">(</span><span class="s4">0</span><span class="s3">)</span>
        <span class="s1">expected_dtype </span><span class="s3">= </span><span class="s1">SparseDtype</span><span class="s3">(</span><span class="s1">bool</span><span class="s3">, </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">isna</span><span class="s3">(</span><span class="s1">data_missing</span><span class="s3">.</span><span class="s1">dtype</span><span class="s3">.</span><span class="s1">fill_value</span><span class="s3">))</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">SparseArray</span><span class="s3">([</span><span class="s2">False</span><span class="s3">, </span><span class="s2">False</span><span class="s3">], </span><span class="s1">fill_value</span><span class="s3">=</span><span class="s2">False</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">expected_dtype</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_equal</span><span class="s3">(</span><span class="s1">sarr</span><span class="s3">.</span><span class="s1">isna</span><span class="s3">(), </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_fillna_limit_backfill</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data_missing</span><span class="s3">):</span>
        <span class="s1">warns </span><span class="s3">= (</span><span class="s1">PerformanceWarning</span><span class="s3">, </span><span class="s1">FutureWarning</span><span class="s3">)</span>
        <span class="s2">with </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_produces_warning</span><span class="s3">(</span><span class="s1">warns</span><span class="s3">, </span><span class="s1">check_stacklevel</span><span class="s3">=</span><span class="s2">False</span><span class="s3">):</span>
            <span class="s1">super</span><span class="s3">().</span><span class="s1">test_fillna_limit_backfill</span><span class="s3">(</span><span class="s1">data_missing</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_fillna_no_op_returns_copy</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data</span><span class="s3">, </span><span class="s1">request</span><span class="s3">):</span>
        <span class="s2">if </span><span class="s1">np</span><span class="s3">.</span><span class="s1">isnan</span><span class="s3">(</span><span class="s1">data</span><span class="s3">.</span><span class="s1">fill_value</span><span class="s3">):</span>
            <span class="s1">request</span><span class="s3">.</span><span class="s1">node</span><span class="s3">.</span><span class="s1">add_marker</span><span class="s3">(</span>
                <span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">xfail</span><span class="s3">(</span><span class="s1">reason</span><span class="s3">=</span><span class="s5">&quot;returns array with different fill value&quot;</span><span class="s3">)</span>
            <span class="s3">)</span>
        <span class="s1">super</span><span class="s3">().</span><span class="s1">test_fillna_no_op_returns_copy</span><span class="s3">(</span><span class="s1">data</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">xfail</span><span class="s3">(</span><span class="s1">reason</span><span class="s3">=</span><span class="s5">&quot;Unsupported&quot;</span><span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_fillna_series</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s6"># this one looks doable.</span>
        <span class="s1">super</span><span class="s3">().</span><span class="s1">test_fillna_series</span><span class="s3">()</span>

    <span class="s2">def </span><span class="s1">test_fillna_frame</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data_missing</span><span class="s3">):</span>
        <span class="s6"># Have to override to specify that fill_value will change.</span>
        <span class="s1">fill_value </span><span class="s3">= </span><span class="s1">data_missing</span><span class="s3">[</span><span class="s4">1</span><span class="s3">]</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s5">&quot;A&quot;</span><span class="s3">: </span><span class="s1">data_missing</span><span class="s3">, </span><span class="s5">&quot;B&quot;</span><span class="s3">: [</span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">]}).</span><span class="s1">fillna</span><span class="s3">(</span><span class="s1">fill_value</span><span class="s3">)</span>

        <span class="s2">if </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">isna</span><span class="s3">(</span><span class="s1">data_missing</span><span class="s3">.</span><span class="s1">fill_value</span><span class="s3">):</span>
            <span class="s1">dtype </span><span class="s3">= </span><span class="s1">SparseDtype</span><span class="s3">(</span><span class="s1">data_missing</span><span class="s3">.</span><span class="s1">dtype</span><span class="s3">, </span><span class="s1">fill_value</span><span class="s3">)</span>
        <span class="s2">else</span><span class="s3">:</span>
            <span class="s1">dtype </span><span class="s3">= </span><span class="s1">data_missing</span><span class="s3">.</span><span class="s1">dtype</span>

        <span class="s1">expected </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s3">{</span>
                <span class="s5">&quot;A&quot;</span><span class="s3">: </span><span class="s1">data_missing</span><span class="s3">.</span><span class="s1">_from_sequence</span><span class="s3">([</span><span class="s1">fill_value</span><span class="s3">, </span><span class="s1">fill_value</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">dtype</span><span class="s3">),</span>
                <span class="s5">&quot;B&quot;</span><span class="s3">: [</span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">],</span>
            <span class="s3">}</span>
        <span class="s3">)</span>

        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_frame_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>


<span class="s2">class </span><span class="s1">TestMethods</span><span class="s3">(</span><span class="s1">BaseSparseTests</span><span class="s3">, </span><span class="s1">base</span><span class="s3">.</span><span class="s1">BaseMethodsTests</span><span class="s3">):</span>
    <span class="s1">_combine_le_expected_dtype </span><span class="s3">= </span><span class="s5">&quot;Sparse[bool]&quot;</span>

    <span class="s2">def </span><span class="s1">test_fillna_copy_frame</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data_missing</span><span class="s3">, </span><span class="s1">using_copy_on_write</span><span class="s3">):</span>
        <span class="s1">arr </span><span class="s3">= </span><span class="s1">data_missing</span><span class="s3">.</span><span class="s1">take</span><span class="s3">([</span><span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">])</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s5">&quot;A&quot;</span><span class="s3">: </span><span class="s1">arr</span><span class="s3">}, </span><span class="s1">copy</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>

        <span class="s1">filled_val </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">iloc</span><span class="s3">[</span><span class="s4">0</span><span class="s3">, </span><span class="s4">0</span><span class="s3">]</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">fillna</span><span class="s3">(</span><span class="s1">filled_val</span><span class="s3">)</span>

        <span class="s2">if </span><span class="s1">hasattr</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">_mgr</span><span class="s3">, </span><span class="s5">&quot;blocks&quot;</span><span class="s3">):</span>
            <span class="s2">if </span><span class="s1">using_copy_on_write</span><span class="s3">:</span>
                <span class="s2">assert </span><span class="s1">df</span><span class="s3">.</span><span class="s1">values</span><span class="s3">.</span><span class="s1">base </span><span class="s2">is </span><span class="s1">result</span><span class="s3">.</span><span class="s1">values</span><span class="s3">.</span><span class="s1">base</span>
            <span class="s2">else</span><span class="s3">:</span>
                <span class="s2">assert </span><span class="s1">df</span><span class="s3">.</span><span class="s1">values</span><span class="s3">.</span><span class="s1">base </span><span class="s2">is not </span><span class="s1">result</span><span class="s3">.</span><span class="s1">values</span><span class="s3">.</span><span class="s1">base</span>
        <span class="s2">assert </span><span class="s1">df</span><span class="s3">.</span><span class="s1">A</span><span class="s3">.</span><span class="s1">_values</span><span class="s3">.</span><span class="s1">to_dense</span><span class="s3">() </span><span class="s2">is </span><span class="s1">arr</span><span class="s3">.</span><span class="s1">to_dense</span><span class="s3">()</span>

    <span class="s2">def </span><span class="s1">test_fillna_copy_series</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data_missing</span><span class="s3">, </span><span class="s1">using_copy_on_write</span><span class="s3">):</span>
        <span class="s1">arr </span><span class="s3">= </span><span class="s1">data_missing</span><span class="s3">.</span><span class="s1">take</span><span class="s3">([</span><span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">])</span>
        <span class="s1">ser </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">Series</span><span class="s3">(</span><span class="s1">arr</span><span class="s3">, </span><span class="s1">copy</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>

        <span class="s1">filled_val </span><span class="s3">= </span><span class="s1">ser</span><span class="s3">[</span><span class="s4">0</span><span class="s3">]</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">ser</span><span class="s3">.</span><span class="s1">fillna</span><span class="s3">(</span><span class="s1">filled_val</span><span class="s3">)</span>

        <span class="s2">if </span><span class="s1">using_copy_on_write</span><span class="s3">:</span>
            <span class="s2">assert </span><span class="s1">ser</span><span class="s3">.</span><span class="s1">_values </span><span class="s2">is </span><span class="s1">result</span><span class="s3">.</span><span class="s1">_values</span>

        <span class="s2">else</span><span class="s3">:</span>
            <span class="s2">assert </span><span class="s1">ser</span><span class="s3">.</span><span class="s1">_values </span><span class="s2">is not </span><span class="s1">result</span><span class="s3">.</span><span class="s1">_values</span>
        <span class="s2">assert </span><span class="s1">ser</span><span class="s3">.</span><span class="s1">_values</span><span class="s3">.</span><span class="s1">to_dense</span><span class="s3">() </span><span class="s2">is </span><span class="s1">arr</span><span class="s3">.</span><span class="s1">to_dense</span><span class="s3">()</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">xfail</span><span class="s3">(</span><span class="s1">reason</span><span class="s3">=</span><span class="s5">&quot;Not Applicable&quot;</span><span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_fillna_length_mismatch</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data_missing</span><span class="s3">):</span>
        <span class="s1">super</span><span class="s3">().</span><span class="s1">test_fillna_length_mismatch</span><span class="s3">(</span><span class="s1">data_missing</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_where_series</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data</span><span class="s3">, </span><span class="s1">na_value</span><span class="s3">):</span>
        <span class="s2">assert </span><span class="s1">data</span><span class="s3">[</span><span class="s4">0</span><span class="s3">] != </span><span class="s1">data</span><span class="s3">[</span><span class="s4">1</span><span class="s3">]</span>
        <span class="s1">cls </span><span class="s3">= </span><span class="s1">type</span><span class="s3">(</span><span class="s1">data</span><span class="s3">)</span>
        <span class="s1">a</span><span class="s3">, </span><span class="s1">b </span><span class="s3">= </span><span class="s1">data</span><span class="s3">[:</span><span class="s4">2</span><span class="s3">]</span>

        <span class="s1">ser </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">Series</span><span class="s3">(</span><span class="s1">cls</span><span class="s3">.</span><span class="s1">_from_sequence</span><span class="s3">([</span><span class="s1">a</span><span class="s3">, </span><span class="s1">a</span><span class="s3">, </span><span class="s1">b</span><span class="s3">, </span><span class="s1">b</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">data</span><span class="s3">.</span><span class="s1">dtype</span><span class="s3">))</span>

        <span class="s1">cond </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s2">True</span><span class="s3">, </span><span class="s2">True</span><span class="s3">, </span><span class="s2">False</span><span class="s3">, </span><span class="s2">False</span><span class="s3">])</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">ser</span><span class="s3">.</span><span class="s1">where</span><span class="s3">(</span><span class="s1">cond</span><span class="s3">)</span>

        <span class="s1">new_dtype </span><span class="s3">= </span><span class="s1">SparseDtype</span><span class="s3">(</span><span class="s5">&quot;float&quot;</span><span class="s3">, </span><span class="s4">0.0</span><span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">Series</span><span class="s3">(</span>
            <span class="s1">cls</span><span class="s3">.</span><span class="s1">_from_sequence</span><span class="s3">([</span><span class="s1">a</span><span class="s3">, </span><span class="s1">a</span><span class="s3">, </span><span class="s1">na_value</span><span class="s3">, </span><span class="s1">na_value</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">new_dtype</span><span class="s3">)</span>
        <span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

        <span class="s1">other </span><span class="s3">= </span><span class="s1">cls</span><span class="s3">.</span><span class="s1">_from_sequence</span><span class="s3">([</span><span class="s1">a</span><span class="s3">, </span><span class="s1">b</span><span class="s3">, </span><span class="s1">a</span><span class="s3">, </span><span class="s1">b</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">data</span><span class="s3">.</span><span class="s1">dtype</span><span class="s3">)</span>
        <span class="s1">cond </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s2">True</span><span class="s3">, </span><span class="s2">False</span><span class="s3">, </span><span class="s2">True</span><span class="s3">, </span><span class="s2">True</span><span class="s3">])</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">ser</span><span class="s3">.</span><span class="s1">where</span><span class="s3">(</span><span class="s1">cond</span><span class="s3">, </span><span class="s1">other</span><span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">Series</span><span class="s3">(</span><span class="s1">cls</span><span class="s3">.</span><span class="s1">_from_sequence</span><span class="s3">([</span><span class="s1">a</span><span class="s3">, </span><span class="s1">b</span><span class="s3">, </span><span class="s1">b</span><span class="s3">, </span><span class="s1">b</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">data</span><span class="s3">.</span><span class="s1">dtype</span><span class="s3">))</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_searchsorted</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data_for_sorting</span><span class="s3">, </span><span class="s1">as_series</span><span class="s3">):</span>
        <span class="s2">with </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_produces_warning</span><span class="s3">(</span><span class="s1">PerformanceWarning</span><span class="s3">, </span><span class="s1">check_stacklevel</span><span class="s3">=</span><span class="s2">False</span><span class="s3">):</span>
            <span class="s1">super</span><span class="s3">().</span><span class="s1">test_searchsorted</span><span class="s3">(</span><span class="s1">data_for_sorting</span><span class="s3">, </span><span class="s1">as_series</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_shift_0_periods</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data</span><span class="s3">):</span>
        <span class="s6"># GH#33856 shifting with periods=0 should return a copy, not same obj</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">data</span><span class="s3">.</span><span class="s1">shift</span><span class="s3">(</span><span class="s4">0</span><span class="s3">)</span>

        <span class="s1">data</span><span class="s3">.</span><span class="s1">_sparse_values</span><span class="s3">[</span><span class="s4">0</span><span class="s3">] = </span><span class="s1">data</span><span class="s3">.</span><span class="s1">_sparse_values</span><span class="s3">[</span><span class="s4">1</span><span class="s3">]</span>
        <span class="s2">assert </span><span class="s1">result</span><span class="s3">.</span><span class="s1">_sparse_values</span><span class="s3">[</span><span class="s4">0</span><span class="s3">] != </span><span class="s1">result</span><span class="s3">.</span><span class="s1">_sparse_values</span><span class="s3">[</span><span class="s4">1</span><span class="s3">]</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s5">&quot;method&quot;</span><span class="s3">, [</span><span class="s5">&quot;argmax&quot;</span><span class="s3">, </span><span class="s5">&quot;argmin&quot;</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_argmin_argmax_all_na</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">method</span><span class="s3">, </span><span class="s1">data</span><span class="s3">, </span><span class="s1">na_value</span><span class="s3">):</span>
        <span class="s6"># overriding because Sparse[int64, 0] cannot handle na_value</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_unsupported</span><span class="s3">(</span><span class="s1">data</span><span class="s3">)</span>
        <span class="s1">super</span><span class="s3">().</span><span class="s1">test_argmin_argmax_all_na</span><span class="s3">(</span><span class="s1">method</span><span class="s3">, </span><span class="s1">data</span><span class="s3">, </span><span class="s1">na_value</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s5">&quot;box&quot;</span><span class="s3">, [</span><span class="s1">pd</span><span class="s3">.</span><span class="s1">array</span><span class="s3">, </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">Series</span><span class="s3">, </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_equals</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data</span><span class="s3">, </span><span class="s1">na_value</span><span class="s3">, </span><span class="s1">as_series</span><span class="s3">, </span><span class="s1">box</span><span class="s3">):</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_unsupported</span><span class="s3">(</span><span class="s1">data</span><span class="s3">)</span>
        <span class="s1">super</span><span class="s3">().</span><span class="s1">test_equals</span><span class="s3">(</span><span class="s1">data</span><span class="s3">, </span><span class="s1">na_value</span><span class="s3">, </span><span class="s1">as_series</span><span class="s3">, </span><span class="s1">box</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s5">&quot;func, na_action, expected&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s3">(</span><span class="s2">lambda </span><span class="s1">x</span><span class="s3">: </span><span class="s1">x</span><span class="s3">, </span><span class="s2">None</span><span class="s3">, </span><span class="s1">SparseArray</span><span class="s3">([</span><span class="s4">1.0</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">])),</span>
            <span class="s3">(</span><span class="s2">lambda </span><span class="s1">x</span><span class="s3">: </span><span class="s1">x</span><span class="s3">, </span><span class="s5">&quot;ignore&quot;</span><span class="s3">, </span><span class="s1">SparseArray</span><span class="s3">([</span><span class="s4">1.0</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">])),</span>
            <span class="s3">(</span><span class="s1">str</span><span class="s3">, </span><span class="s2">None</span><span class="s3">, </span><span class="s1">SparseArray</span><span class="s3">([</span><span class="s5">&quot;1.0&quot;</span><span class="s3">, </span><span class="s5">&quot;nan&quot;</span><span class="s3">], </span><span class="s1">fill_value</span><span class="s3">=</span><span class="s5">&quot;nan&quot;</span><span class="s3">)),</span>
            <span class="s3">(</span><span class="s1">str</span><span class="s3">, </span><span class="s5">&quot;ignore&quot;</span><span class="s3">, </span><span class="s1">SparseArray</span><span class="s3">([</span><span class="s5">&quot;1.0&quot;</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">])),</span>
        <span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_map</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">func</span><span class="s3">, </span><span class="s1">na_action</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">):</span>
        <span class="s6"># GH52096</span>
        <span class="s1">data </span><span class="s3">= </span><span class="s1">SparseArray</span><span class="s3">([</span><span class="s4">1</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">])</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">data</span><span class="s3">.</span><span class="s1">map</span><span class="s3">(</span><span class="s1">func</span><span class="s3">, </span><span class="s1">na_action</span><span class="s3">=</span><span class="s1">na_action</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_extension_array_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s5">&quot;na_action&quot;</span><span class="s3">, [</span><span class="s2">None</span><span class="s3">, </span><span class="s5">&quot;ignore&quot;</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_map_raises</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data</span><span class="s3">, </span><span class="s1">na_action</span><span class="s3">):</span>
        <span class="s6"># GH52096</span>
        <span class="s1">msg </span><span class="s3">= </span><span class="s5">&quot;fill value in the sparse values not supported&quot;</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">ValueError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s1">data</span><span class="s3">.</span><span class="s1">map</span><span class="s3">(</span><span class="s2">lambda </span><span class="s1">x</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s1">na_action</span><span class="s3">=</span><span class="s1">na_action</span><span class="s3">)</span>


<span class="s2">class </span><span class="s1">TestCasting</span><span class="s3">(</span><span class="s1">BaseSparseTests</span><span class="s3">, </span><span class="s1">base</span><span class="s3">.</span><span class="s1">BaseCastingTests</span><span class="s3">):</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">xfail</span><span class="s3">(</span><span class="s1">raises</span><span class="s3">=</span><span class="s1">TypeError</span><span class="s3">, </span><span class="s1">reason</span><span class="s3">=</span><span class="s5">&quot;no sparse StringDtype&quot;</span><span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_astype_string</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data</span><span class="s3">):</span>
        <span class="s1">super</span><span class="s3">().</span><span class="s1">test_astype_string</span><span class="s3">(</span><span class="s1">data</span><span class="s3">)</span>


<span class="s2">class </span><span class="s1">TestArithmeticOps</span><span class="s3">(</span><span class="s1">BaseSparseTests</span><span class="s3">, </span><span class="s1">base</span><span class="s3">.</span><span class="s1">BaseArithmeticOpsTests</span><span class="s3">):</span>
    <span class="s1">series_scalar_exc </span><span class="s3">= </span><span class="s2">None</span>
    <span class="s1">frame_scalar_exc </span><span class="s3">= </span><span class="s2">None</span>
    <span class="s1">divmod_exc </span><span class="s3">= </span><span class="s2">None</span>
    <span class="s1">series_array_exc </span><span class="s3">= </span><span class="s2">None</span>

    <span class="s2">def </span><span class="s1">_skip_if_different_combine</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data</span><span class="s3">):</span>
        <span class="s2">if </span><span class="s1">data</span><span class="s3">.</span><span class="s1">fill_value </span><span class="s3">== </span><span class="s4">0</span><span class="s3">:</span>
            <span class="s6"># arith ops call on dtype.fill_value so that the sparsity</span>
            <span class="s6"># is maintained. Combine can't be called on a dtype in</span>
            <span class="s6"># general, so we can't make the expected. This is tested elsewhere</span>
            <span class="s1">pytest</span><span class="s3">.</span><span class="s1">skip</span><span class="s3">(</span><span class="s5">&quot;Incorrected expected from Series.combine and tested elsewhere&quot;</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_arith_series_with_scalar</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data</span><span class="s3">, </span><span class="s1">all_arithmetic_operators</span><span class="s3">):</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_skip_if_different_combine</span><span class="s3">(</span><span class="s1">data</span><span class="s3">)</span>
        <span class="s1">super</span><span class="s3">().</span><span class="s1">test_arith_series_with_scalar</span><span class="s3">(</span><span class="s1">data</span><span class="s3">, </span><span class="s1">all_arithmetic_operators</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_arith_series_with_array</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data</span><span class="s3">, </span><span class="s1">all_arithmetic_operators</span><span class="s3">):</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_skip_if_different_combine</span><span class="s3">(</span><span class="s1">data</span><span class="s3">)</span>
        <span class="s1">super</span><span class="s3">().</span><span class="s1">test_arith_series_with_array</span><span class="s3">(</span><span class="s1">data</span><span class="s3">, </span><span class="s1">all_arithmetic_operators</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_arith_frame_with_scalar</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data</span><span class="s3">, </span><span class="s1">all_arithmetic_operators</span><span class="s3">, </span><span class="s1">request</span><span class="s3">):</span>
        <span class="s2">if </span><span class="s1">data</span><span class="s3">.</span><span class="s1">dtype</span><span class="s3">.</span><span class="s1">fill_value </span><span class="s3">!= </span><span class="s4">0</span><span class="s3">:</span>
            <span class="s2">pass</span>
        <span class="s2">elif </span><span class="s1">all_arithmetic_operators</span><span class="s3">.</span><span class="s1">strip</span><span class="s3">(</span><span class="s5">&quot;_&quot;</span><span class="s3">) </span><span class="s2">not in </span><span class="s3">[</span>
            <span class="s5">&quot;mul&quot;</span><span class="s3">,</span>
            <span class="s5">&quot;rmul&quot;</span><span class="s3">,</span>
            <span class="s5">&quot;floordiv&quot;</span><span class="s3">,</span>
            <span class="s5">&quot;rfloordiv&quot;</span><span class="s3">,</span>
            <span class="s5">&quot;pow&quot;</span><span class="s3">,</span>
            <span class="s5">&quot;mod&quot;</span><span class="s3">,</span>
            <span class="s5">&quot;rmod&quot;</span><span class="s3">,</span>
        <span class="s3">]:</span>
            <span class="s1">mark </span><span class="s3">= </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">xfail</span><span class="s3">(</span><span class="s1">reason</span><span class="s3">=</span><span class="s5">&quot;result dtype.fill_value mismatch&quot;</span><span class="s3">)</span>
            <span class="s1">request</span><span class="s3">.</span><span class="s1">node</span><span class="s3">.</span><span class="s1">add_marker</span><span class="s3">(</span><span class="s1">mark</span><span class="s3">)</span>
        <span class="s1">super</span><span class="s3">().</span><span class="s1">test_arith_frame_with_scalar</span><span class="s3">(</span><span class="s1">data</span><span class="s3">, </span><span class="s1">all_arithmetic_operators</span><span class="s3">)</span>


<span class="s2">class </span><span class="s1">TestComparisonOps</span><span class="s3">(</span><span class="s1">BaseSparseTests</span><span class="s3">):</span>
    <span class="s2">def </span><span class="s1">_compare_other</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data_for_compare</span><span class="s3">: </span><span class="s1">SparseArray</span><span class="s3">, </span><span class="s1">comparison_op</span><span class="s3">, </span><span class="s1">other</span><span class="s3">):</span>
        <span class="s1">op </span><span class="s3">= </span><span class="s1">comparison_op</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">op</span><span class="s3">(</span><span class="s1">data_for_compare</span><span class="s3">, </span><span class="s1">other</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">SparseArray</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">result</span><span class="s3">.</span><span class="s1">dtype</span><span class="s3">.</span><span class="s1">subtype </span><span class="s3">== </span><span class="s1">np</span><span class="s3">.</span><span class="s1">bool_</span>

        <span class="s2">if </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">other</span><span class="s3">, </span><span class="s1">SparseArray</span><span class="s3">):</span>
            <span class="s1">fill_value </span><span class="s3">= </span><span class="s1">op</span><span class="s3">(</span><span class="s1">data_for_compare</span><span class="s3">.</span><span class="s1">fill_value</span><span class="s3">, </span><span class="s1">other</span><span class="s3">.</span><span class="s1">fill_value</span><span class="s3">)</span>
        <span class="s2">else</span><span class="s3">:</span>
            <span class="s1">fill_value </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">all</span><span class="s3">(</span>
                <span class="s1">op</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">asarray</span><span class="s3">(</span><span class="s1">data_for_compare</span><span class="s3">.</span><span class="s1">fill_value</span><span class="s3">), </span><span class="s1">np</span><span class="s3">.</span><span class="s1">asarray</span><span class="s3">(</span><span class="s1">other</span><span class="s3">))</span>
            <span class="s3">)</span>

            <span class="s1">expected </span><span class="s3">= </span><span class="s1">SparseArray</span><span class="s3">(</span>
                <span class="s1">op</span><span class="s3">(</span><span class="s1">data_for_compare</span><span class="s3">.</span><span class="s1">to_dense</span><span class="s3">(), </span><span class="s1">np</span><span class="s3">.</span><span class="s1">asarray</span><span class="s3">(</span><span class="s1">other</span><span class="s3">)),</span>
                <span class="s1">fill_value</span><span class="s3">=</span><span class="s1">fill_value</span><span class="s3">,</span>
                <span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">bool_</span><span class="s3">,</span>
            <span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_sp_array_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_scalar</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data_for_compare</span><span class="s3">: </span><span class="s1">SparseArray</span><span class="s3">, </span><span class="s1">comparison_op</span><span class="s3">):</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_compare_other</span><span class="s3">(</span><span class="s1">data_for_compare</span><span class="s3">, </span><span class="s1">comparison_op</span><span class="s3">, </span><span class="s4">0</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_compare_other</span><span class="s3">(</span><span class="s1">data_for_compare</span><span class="s3">, </span><span class="s1">comparison_op</span><span class="s3">, </span><span class="s4">1</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_compare_other</span><span class="s3">(</span><span class="s1">data_for_compare</span><span class="s3">, </span><span class="s1">comparison_op</span><span class="s3">, -</span><span class="s4">1</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_compare_other</span><span class="s3">(</span><span class="s1">data_for_compare</span><span class="s3">, </span><span class="s1">comparison_op</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">xfail</span><span class="s3">(</span><span class="s1">reason</span><span class="s3">=</span><span class="s5">&quot;Wrong indices&quot;</span><span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_array</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data_for_compare</span><span class="s3">: </span><span class="s1">SparseArray</span><span class="s3">, </span><span class="s1">comparison_op</span><span class="s3">):</span>
        <span class="s1">arr </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">linspace</span><span class="s3">(-</span><span class="s4">4</span><span class="s3">, </span><span class="s4">5</span><span class="s3">, </span><span class="s4">10</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_compare_other</span><span class="s3">(</span><span class="s1">data_for_compare</span><span class="s3">, </span><span class="s1">comparison_op</span><span class="s3">, </span><span class="s1">arr</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">xfail</span><span class="s3">(</span><span class="s1">reason</span><span class="s3">=</span><span class="s5">&quot;Wrong indices&quot;</span><span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_sparse_array</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data_for_compare</span><span class="s3">: </span><span class="s1">SparseArray</span><span class="s3">, </span><span class="s1">comparison_op</span><span class="s3">):</span>
        <span class="s1">arr </span><span class="s3">= </span><span class="s1">data_for_compare </span><span class="s3">+ </span><span class="s4">1</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_compare_other</span><span class="s3">(</span><span class="s1">data_for_compare</span><span class="s3">, </span><span class="s1">comparison_op</span><span class="s3">, </span><span class="s1">arr</span><span class="s3">)</span>
        <span class="s1">arr </span><span class="s3">= </span><span class="s1">data_for_compare </span><span class="s3">* </span><span class="s4">2</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_compare_other</span><span class="s3">(</span><span class="s1">data_for_compare</span><span class="s3">, </span><span class="s1">comparison_op</span><span class="s3">, </span><span class="s1">arr</span><span class="s3">)</span>


<span class="s2">class </span><span class="s1">TestPrinting</span><span class="s3">(</span><span class="s1">BaseSparseTests</span><span class="s3">, </span><span class="s1">base</span><span class="s3">.</span><span class="s1">BasePrintingTests</span><span class="s3">):</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">xfail</span><span class="s3">(</span><span class="s1">reason</span><span class="s3">=</span><span class="s5">&quot;Different repr&quot;</span><span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_array_repr</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data</span><span class="s3">, </span><span class="s1">size</span><span class="s3">):</span>
        <span class="s1">super</span><span class="s3">().</span><span class="s1">test_array_repr</span><span class="s3">(</span><span class="s1">data</span><span class="s3">, </span><span class="s1">size</span><span class="s3">)</span>


<span class="s2">class </span><span class="s1">TestParsing</span><span class="s3">(</span><span class="s1">BaseSparseTests</span><span class="s3">, </span><span class="s1">base</span><span class="s3">.</span><span class="s1">BaseParsingTests</span><span class="s3">):</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s5">&quot;engine&quot;</span><span class="s3">, [</span><span class="s5">&quot;c&quot;</span><span class="s3">, </span><span class="s5">&quot;python&quot;</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_EA_types</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">engine</span><span class="s3">, </span><span class="s1">data</span><span class="s3">):</span>
        <span class="s1">expected_msg </span><span class="s3">= </span><span class="s5">r&quot;.*must implement _from_sequence_of_strings.*&quot;</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">NotImplementedError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">expected_msg</span><span class="s3">):</span>
            <span class="s1">super</span><span class="s3">().</span><span class="s1">test_EA_types</span><span class="s3">(</span><span class="s1">engine</span><span class="s3">, </span><span class="s1">data</span><span class="s3">)</span>


<span class="s2">class </span><span class="s1">TestNoNumericAccumulations</span><span class="s3">(</span><span class="s1">base</span><span class="s3">.</span><span class="s1">BaseAccumulateTests</span><span class="s3">):</span>
    <span class="s2">pass</span>
</pre>
</body>
</html>