<html>
<head>
<title>uiparser.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #7a7e85;}
.s1 { color: #bcbec4;}
.s2 { color: #cf8e6d;}
.s3 { color: #bcbec4;}
.s4 { color: #5f826b; font-style: italic;}
.s5 { color: #6aab73;}
.s6 { color: #2aacb8;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
uiparser.py</font>
</center></td></tr></table>
<pre><span class="s0">#############################################################################</span>
<span class="s0">##</span>
<span class="s0">## Copyright (C) 2019 Riverbank Computing Limited.</span>
<span class="s0">## Copyright (C) 2006 Thorsten Marek.</span>
<span class="s0">## All right reserved.</span>
<span class="s0">##</span>
<span class="s0">## This file is part of PyQt.</span>
<span class="s0">##</span>
<span class="s0">## You may use this file under the terms of the GPL v2 or the revised BSD</span>
<span class="s0">## license as follows:</span>
<span class="s0">##</span>
<span class="s0">## &quot;Redistribution and use in source and binary forms, with or without</span>
<span class="s0">## modification, are permitted provided that the following conditions are</span>
<span class="s0">## met:</span>
<span class="s0">##   * Redistributions of source code must retain the above copyright</span>
<span class="s0">##     notice, this list of conditions and the following disclaimer.</span>
<span class="s0">##   * Redistributions in binary form must reproduce the above copyright</span>
<span class="s0">##     notice, this list of conditions and the following disclaimer in</span>
<span class="s0">##     the documentation and/or other materials provided with the</span>
<span class="s0">##     distribution.</span>
<span class="s0">##   * Neither the name of the Riverbank Computing Limited nor the names</span>
<span class="s0">##     of its contributors may be used to endorse or promote products</span>
<span class="s0">##     derived from this software without specific prior written</span>
<span class="s0">##     permission.</span>
<span class="s0">##</span>
<span class="s0">## THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span>
<span class="s0">## &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span>
<span class="s0">## LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span>
<span class="s0">## A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span>
<span class="s0">## OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span>
<span class="s0">## SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span>
<span class="s0">## LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span>
<span class="s0">## DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span>
<span class="s0">## THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
<span class="s0">## (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="s0">## OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.&quot;</span>
<span class="s0">##</span>
<span class="s0">#############################################################################</span>


<span class="s2">import </span><span class="s1">sys</span>
<span class="s2">import </span><span class="s1">logging</span>
<span class="s2">import </span><span class="s1">os</span>
<span class="s2">import </span><span class="s1">re</span>
<span class="s2">from </span><span class="s1">xml</span><span class="s3">.</span><span class="s1">etree</span><span class="s3">.</span><span class="s1">ElementTree </span><span class="s2">import </span><span class="s1">parse</span><span class="s3">, </span><span class="s1">SubElement</span>

<span class="s2">from </span><span class="s3">.</span><span class="s1">objcreator </span><span class="s2">import </span><span class="s1">QObjectCreator</span>
<span class="s2">from </span><span class="s3">.</span><span class="s1">properties </span><span class="s2">import </span><span class="s1">Properties</span>


<span class="s1">logger </span><span class="s3">= </span><span class="s1">logging</span><span class="s3">.</span><span class="s1">getLogger</span><span class="s3">(</span><span class="s1">__name__</span><span class="s3">)</span>
<span class="s1">DEBUG </span><span class="s3">= </span><span class="s1">logger</span><span class="s3">.</span><span class="s1">debug</span>

<span class="s1">QtCore </span><span class="s3">= </span><span class="s2">None</span>
<span class="s1">QtWidgets </span><span class="s3">= </span><span class="s2">None</span>


<span class="s2">def </span><span class="s1">_parse_alignment</span><span class="s3">(</span><span class="s1">alignment</span><span class="s3">):</span>
    <span class="s4">&quot;&quot;&quot; Convert a C++ alignment to the corresponding flags. &quot;&quot;&quot;</span>

    <span class="s1">align_flags </span><span class="s3">= </span><span class="s2">None</span>
    <span class="s2">for </span><span class="s1">qt_align </span><span class="s2">in </span><span class="s1">alignment</span><span class="s3">.</span><span class="s1">split</span><span class="s3">(</span><span class="s5">'|'</span><span class="s3">):</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">qt_align </span><span class="s3">= </span><span class="s1">qt_align</span><span class="s3">.</span><span class="s1">split</span><span class="s3">(</span><span class="s5">'::'</span><span class="s3">)</span>
        <span class="s1">align </span><span class="s3">= </span><span class="s1">getattr</span><span class="s3">(</span><span class="s1">QtCore</span><span class="s3">.</span><span class="s1">Qt</span><span class="s3">, </span><span class="s1">qt_align</span><span class="s3">)</span>

        <span class="s2">if </span><span class="s1">align_flags </span><span class="s2">is None</span><span class="s3">:</span>
            <span class="s1">align_flags </span><span class="s3">= </span><span class="s1">align</span>
        <span class="s2">else</span><span class="s3">:</span>
            <span class="s1">align_flags </span><span class="s3">|= </span><span class="s1">align</span>

    <span class="s2">return </span><span class="s1">align_flags</span>


<span class="s2">def </span><span class="s1">_layout_position</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">):</span>
    <span class="s4">&quot;&quot;&quot; Return either (), (0, alignment), (row, column, rowspan, colspan) or 
    (row, column, rowspan, colspan, alignment) depending on the type of layout 
    and its configuration.  The result will be suitable to use as arguments to 
    the layout. 
    &quot;&quot;&quot;</span>

    <span class="s1">row </span><span class="s3">= </span><span class="s1">elem</span><span class="s3">.</span><span class="s1">attrib</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'row'</span><span class="s3">)</span>
    <span class="s1">column </span><span class="s3">= </span><span class="s1">elem</span><span class="s3">.</span><span class="s1">attrib</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'column'</span><span class="s3">)</span>
    <span class="s1">alignment </span><span class="s3">= </span><span class="s1">elem</span><span class="s3">.</span><span class="s1">attrib</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'alignment'</span><span class="s3">)</span>

    <span class="s0"># See if it is a box layout.</span>
    <span class="s2">if </span><span class="s1">row </span><span class="s2">is None or </span><span class="s1">column </span><span class="s2">is None</span><span class="s3">:</span>
        <span class="s2">if </span><span class="s1">alignment </span><span class="s2">is None</span><span class="s3">:</span>
            <span class="s2">return </span><span class="s3">()</span>

        <span class="s2">return </span><span class="s3">(</span><span class="s6">0</span><span class="s3">, </span><span class="s1">_parse_alignment</span><span class="s3">(</span><span class="s1">alignment</span><span class="s3">))</span>

    <span class="s0"># It must be a grid or a form layout.</span>
    <span class="s1">row </span><span class="s3">= </span><span class="s1">int</span><span class="s3">(</span><span class="s1">row</span><span class="s3">)</span>
    <span class="s1">column </span><span class="s3">= </span><span class="s1">int</span><span class="s3">(</span><span class="s1">column</span><span class="s3">)</span>

    <span class="s1">rowspan </span><span class="s3">= </span><span class="s1">int</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">.</span><span class="s1">attrib</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'rowspan'</span><span class="s3">, </span><span class="s6">1</span><span class="s3">))</span>
    <span class="s1">colspan </span><span class="s3">= </span><span class="s1">int</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">.</span><span class="s1">attrib</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'colspan'</span><span class="s3">, </span><span class="s6">1</span><span class="s3">))</span>

    <span class="s2">if </span><span class="s1">alignment </span><span class="s2">is None</span><span class="s3">:</span>
        <span class="s2">return </span><span class="s3">(</span><span class="s1">row</span><span class="s3">, </span><span class="s1">column</span><span class="s3">, </span><span class="s1">rowspan</span><span class="s3">, </span><span class="s1">colspan</span><span class="s3">)</span>

    <span class="s2">return </span><span class="s3">(</span><span class="s1">row</span><span class="s3">, </span><span class="s1">column</span><span class="s3">, </span><span class="s1">rowspan</span><span class="s3">, </span><span class="s1">colspan</span><span class="s3">, </span><span class="s1">_parse_alignment</span><span class="s3">(</span><span class="s1">alignment</span><span class="s3">))</span>


<span class="s2">class </span><span class="s1">WidgetStack</span><span class="s3">(</span><span class="s1">list</span><span class="s3">):</span>
    <span class="s1">topwidget </span><span class="s3">= </span><span class="s2">None</span>
    <span class="s2">def </span><span class="s1">push</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">item</span><span class="s3">):</span>
        <span class="s1">DEBUG</span><span class="s3">(</span><span class="s5">&quot;push %s %s&quot; </span><span class="s3">% (</span><span class="s1">item</span><span class="s3">.</span><span class="s1">metaObject</span><span class="s3">().</span><span class="s1">className</span><span class="s3">(),</span>
                              <span class="s1">item</span><span class="s3">.</span><span class="s1">objectName</span><span class="s3">()))</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">append</span><span class="s3">(</span><span class="s1">item</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">item</span><span class="s3">, </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QWidget</span><span class="s3">):</span>
            <span class="s1">self</span><span class="s3">.</span><span class="s1">topwidget </span><span class="s3">= </span><span class="s1">item</span>

    <span class="s2">def </span><span class="s1">popLayout</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">layout </span><span class="s3">= </span><span class="s1">list</span><span class="s3">.</span><span class="s1">pop</span><span class="s3">(</span><span class="s1">self</span><span class="s3">)</span>
        <span class="s1">DEBUG</span><span class="s3">(</span><span class="s5">&quot;pop layout %s %s&quot; </span><span class="s3">% (</span><span class="s1">layout</span><span class="s3">.</span><span class="s1">metaObject</span><span class="s3">().</span><span class="s1">className</span><span class="s3">(),</span>
                                    <span class="s1">layout</span><span class="s3">.</span><span class="s1">objectName</span><span class="s3">()))</span>
        <span class="s2">return </span><span class="s1">layout</span>

    <span class="s2">def </span><span class="s1">popWidget</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">widget </span><span class="s3">= </span><span class="s1">list</span><span class="s3">.</span><span class="s1">pop</span><span class="s3">(</span><span class="s1">self</span><span class="s3">)</span>
        <span class="s1">DEBUG</span><span class="s3">(</span><span class="s5">&quot;pop widget %s %s&quot; </span><span class="s3">% (</span><span class="s1">widget</span><span class="s3">.</span><span class="s1">metaObject</span><span class="s3">().</span><span class="s1">className</span><span class="s3">(),</span>
                                    <span class="s1">widget</span><span class="s3">.</span><span class="s1">objectName</span><span class="s3">()))</span>
        <span class="s2">for </span><span class="s1">item </span><span class="s2">in </span><span class="s1">reversed</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
            <span class="s2">if </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">item</span><span class="s3">, </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QWidget</span><span class="s3">):</span>
                <span class="s1">self</span><span class="s3">.</span><span class="s1">topwidget </span><span class="s3">= </span><span class="s1">item</span>
                <span class="s2">break</span>
        <span class="s2">else</span><span class="s3">:</span>
            <span class="s1">self</span><span class="s3">.</span><span class="s1">topwidget </span><span class="s3">= </span><span class="s2">None</span>
        <span class="s1">DEBUG</span><span class="s3">(</span><span class="s5">&quot;new topwidget %s&quot; </span><span class="s3">% (</span><span class="s1">self</span><span class="s3">.</span><span class="s1">topwidget</span><span class="s3">,))</span>
        <span class="s2">return </span><span class="s1">widget</span>

    <span class="s2">def </span><span class="s1">peek</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s2">return </span><span class="s1">self</span><span class="s3">[-</span><span class="s6">1</span><span class="s3">]</span>

    <span class="s2">def </span><span class="s1">topIsLayout</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s2">return </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">self</span><span class="s3">[-</span><span class="s6">1</span><span class="s3">], </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QLayout</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">topIsLayoutWidget</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s0"># A plain QWidget is a layout widget unless it's parent is a</span>
        <span class="s0"># QMainWindow or a container widget.  Note that the corresponding uic</span>
        <span class="s0"># test is a little more complicated as it involves features not</span>
        <span class="s0"># supported by pyuic.</span>

        <span class="s2">if </span><span class="s1">type</span><span class="s3">(</span><span class="s1">self</span><span class="s3">[-</span><span class="s6">1</span><span class="s3">]) </span><span class="s2">is not </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QWidget</span><span class="s3">:</span>
            <span class="s2">return False</span>

        <span class="s2">if </span><span class="s1">len</span><span class="s3">(</span><span class="s1">self</span><span class="s3">) &lt; </span><span class="s6">2</span><span class="s3">:</span>
            <span class="s2">return False</span>

        <span class="s1">parent </span><span class="s3">= </span><span class="s1">self</span><span class="s3">[-</span><span class="s6">2</span><span class="s3">]</span>

        <span class="s2">return </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">parent</span><span class="s3">, </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QWidget</span><span class="s3">) </span><span class="s2">and </span><span class="s1">type</span><span class="s3">(</span><span class="s1">parent</span><span class="s3">) </span><span class="s2">not in </span><span class="s3">(</span>
                <span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QMainWindow</span><span class="s3">,</span>
                <span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QStackedWidget</span><span class="s3">,</span>
                <span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QToolBox</span><span class="s3">,</span>
                <span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QTabWidget</span><span class="s3">,</span>
                <span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QScrollArea</span><span class="s3">,</span>
                <span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QMdiArea</span><span class="s3">,</span>
                <span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QWizard</span><span class="s3">,</span>
                <span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QDockWidget</span><span class="s3">)</span>


<span class="s2">class </span><span class="s1">ButtonGroup</span><span class="s3">(</span><span class="s1">object</span><span class="s3">):</span>
    <span class="s4">&quot;&quot;&quot; Encapsulate the configuration of a button group and its implementation. 
    &quot;&quot;&quot;</span>

    <span class="s2">def </span><span class="s1">__init__</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s4">&quot;&quot;&quot; Initialise the button group. &quot;&quot;&quot;</span>

        <span class="s1">self</span><span class="s3">.</span><span class="s1">exclusive </span><span class="s3">= </span><span class="s2">True</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">object </span><span class="s3">= </span><span class="s2">None</span>


<span class="s2">class </span><span class="s1">UIParser</span><span class="s3">(</span><span class="s1">object</span><span class="s3">):    </span>
    <span class="s2">def </span><span class="s1">__init__</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">qtcore_module</span><span class="s3">, </span><span class="s1">qtgui_module</span><span class="s3">, </span><span class="s1">qtwidgets_module</span><span class="s3">, </span><span class="s1">creatorPolicy</span><span class="s3">):</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">factory </span><span class="s3">= </span><span class="s1">QObjectCreator</span><span class="s3">(</span><span class="s1">creatorPolicy</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">wprops </span><span class="s3">= </span><span class="s1">Properties</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">factory</span><span class="s3">, </span><span class="s1">qtcore_module</span><span class="s3">, </span><span class="s1">qtgui_module</span><span class="s3">,</span>
                <span class="s1">qtwidgets_module</span><span class="s3">)</span>
        
        <span class="s2">global </span><span class="s1">QtCore</span><span class="s3">, </span><span class="s1">QtWidgets</span>
        <span class="s1">QtCore </span><span class="s3">= </span><span class="s1">qtcore_module</span>
        <span class="s1">QtWidgets </span><span class="s3">= </span><span class="s1">qtwidgets_module</span>
        
        <span class="s1">self</span><span class="s3">.</span><span class="s1">reset</span><span class="s3">()</span>

    <span class="s2">def </span><span class="s1">uniqueName</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">name</span><span class="s3">):</span>
        <span class="s4">&quot;&quot;&quot;UIParser.uniqueName(string) -&gt; string 
 
        Create a unique name from a string. 
        &gt;&gt;&gt; p = UIParser(QtCore, QtGui, QtWidgets) 
        &gt;&gt;&gt; p.uniqueName(&quot;foo&quot;) 
        'foo' 
        &gt;&gt;&gt; p.uniqueName(&quot;foo&quot;) 
        'foo1' 
        &quot;&quot;&quot;</span>
        <span class="s2">try</span><span class="s3">:</span>
            <span class="s1">suffix </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">name_suffixes</span><span class="s3">[</span><span class="s1">name</span><span class="s3">]</span>
        <span class="s2">except </span><span class="s1">KeyError</span><span class="s3">:</span>
            <span class="s1">self</span><span class="s3">.</span><span class="s1">name_suffixes</span><span class="s3">[</span><span class="s1">name</span><span class="s3">] = </span><span class="s6">0</span>
            <span class="s2">return </span><span class="s1">name</span>

        <span class="s1">suffix </span><span class="s3">+= </span><span class="s6">1</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">name_suffixes</span><span class="s3">[</span><span class="s1">name</span><span class="s3">] = </span><span class="s1">suffix</span>

        <span class="s2">return </span><span class="s5">&quot;%s%i&quot; </span><span class="s3">% (</span><span class="s1">name</span><span class="s3">, </span><span class="s1">suffix</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">reset</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s2">try</span><span class="s3">: </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">reset</span><span class="s3">()</span>
        <span class="s2">except </span><span class="s1">AttributeError</span><span class="s3">: </span><span class="s2">pass</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">toplevelWidget </span><span class="s3">= </span><span class="s2">None</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">stack </span><span class="s3">= </span><span class="s1">WidgetStack</span><span class="s3">()</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">name_suffixes </span><span class="s3">= {}</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">defaults </span><span class="s3">= {</span><span class="s5">'spacing'</span><span class="s3">: -</span><span class="s6">1</span><span class="s3">, </span><span class="s5">'margin'</span><span class="s3">: -</span><span class="s6">1</span><span class="s3">}</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">actions </span><span class="s3">= []</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">currentActionGroup </span><span class="s3">= </span><span class="s2">None</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">resources </span><span class="s3">= []</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">button_groups </span><span class="s3">= {}</span>

    <span class="s2">def </span><span class="s1">setupObject</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">clsname</span><span class="s3">, </span><span class="s1">parent</span><span class="s3">, </span><span class="s1">branch</span><span class="s3">, </span><span class="s1">is_attribute</span><span class="s3">=</span><span class="s2">True</span><span class="s3">):</span>
        <span class="s1">name </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">uniqueName</span><span class="s3">(</span><span class="s1">branch</span><span class="s3">.</span><span class="s1">attrib</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'name'</span><span class="s3">) </span><span class="s2">or </span><span class="s1">clsname</span><span class="s3">[</span><span class="s6">1</span><span class="s3">:].</span><span class="s1">lower</span><span class="s3">())</span>

        <span class="s2">if </span><span class="s1">parent </span><span class="s2">is None</span><span class="s3">:</span>
            <span class="s1">args </span><span class="s3">= ()</span>
        <span class="s2">else</span><span class="s3">:</span>
            <span class="s1">args </span><span class="s3">= (</span><span class="s1">parent</span><span class="s3">, )</span>

        <span class="s1">obj </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">factory</span><span class="s3">.</span><span class="s1">createQObject</span><span class="s3">(</span><span class="s1">clsname</span><span class="s3">, </span><span class="s1">name</span><span class="s3">, </span><span class="s1">args</span><span class="s3">, </span><span class="s1">is_attribute</span><span class="s3">)</span>

        <span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">setProperties</span><span class="s3">(</span><span class="s1">obj</span><span class="s3">, </span><span class="s1">branch</span><span class="s3">)</span>
        <span class="s1">obj</span><span class="s3">.</span><span class="s1">setObjectName</span><span class="s3">(</span><span class="s1">name</span><span class="s3">)</span>

        <span class="s2">if </span><span class="s1">is_attribute</span><span class="s3">:</span>
            <span class="s1">setattr</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">toplevelWidget</span><span class="s3">, </span><span class="s1">name</span><span class="s3">, </span><span class="s1">obj</span><span class="s3">)</span>

        <span class="s2">return </span><span class="s1">obj</span>

    <span class="s2">def </span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">elem</span><span class="s3">, </span><span class="s1">name</span><span class="s3">):</span>
        <span class="s2">for </span><span class="s1">prop </span><span class="s2">in </span><span class="s1">elem</span><span class="s3">.</span><span class="s1">findall</span><span class="s3">(</span><span class="s5">'property'</span><span class="s3">):</span>
            <span class="s2">if </span><span class="s1">prop</span><span class="s3">.</span><span class="s1">attrib</span><span class="s3">[</span><span class="s5">'name'</span><span class="s3">] == </span><span class="s1">name</span><span class="s3">:</span>
                <span class="s2">return </span><span class="s1">prop</span>

        <span class="s2">return None</span>

    <span class="s2">def </span><span class="s1">createWidget</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">elem</span><span class="s3">):</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">column_counter </span><span class="s3">= </span><span class="s6">0</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">row_counter </span><span class="s3">= </span><span class="s6">0</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">item_nr </span><span class="s3">= </span><span class="s6">0</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">itemstack </span><span class="s3">= []</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">sorting_enabled </span><span class="s3">= </span><span class="s2">None</span>

        <span class="s1">widget_class </span><span class="s3">= </span><span class="s1">elem</span><span class="s3">.</span><span class="s1">attrib</span><span class="s3">[</span><span class="s5">'class'</span><span class="s3">].</span><span class="s1">replace</span><span class="s3">(</span><span class="s5">'::'</span><span class="s3">, </span><span class="s5">'.'</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">widget_class </span><span class="s3">== </span><span class="s5">'Line'</span><span class="s3">:</span>
            <span class="s1">widget_class </span><span class="s3">= </span><span class="s5">'QFrame'</span>
        
        <span class="s0"># Ignore the parent if it is a container.</span>
        <span class="s1">parent </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">stack</span><span class="s3">.</span><span class="s1">topwidget</span>
        <span class="s2">if </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">parent</span><span class="s3">, (</span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QDockWidget</span><span class="s3">, </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QMdiArea</span><span class="s3">,</span>
                               <span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QScrollArea</span><span class="s3">, </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QStackedWidget</span><span class="s3">,</span>
                               <span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QToolBox</span><span class="s3">, </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QTabWidget</span><span class="s3">,</span>
                               <span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QWizard</span><span class="s3">)):</span>
            <span class="s1">parent </span><span class="s3">= </span><span class="s2">None</span>

        <span class="s1">self</span><span class="s3">.</span><span class="s1">stack</span><span class="s3">.</span><span class="s1">push</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">setupObject</span><span class="s3">(</span><span class="s1">widget_class</span><span class="s3">, </span><span class="s1">parent</span><span class="s3">, </span><span class="s1">elem</span><span class="s3">))</span>

        <span class="s2">if </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">stack</span><span class="s3">.</span><span class="s1">topwidget</span><span class="s3">, </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QTableWidget</span><span class="s3">):</span>
            <span class="s2">if </span><span class="s1">self</span><span class="s3">.</span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'columnCount'</span><span class="s3">) </span><span class="s2">is None</span><span class="s3">:</span>
                <span class="s1">self</span><span class="s3">.</span><span class="s1">stack</span><span class="s3">.</span><span class="s1">topwidget</span><span class="s3">.</span><span class="s1">setColumnCount</span><span class="s3">(</span><span class="s1">len</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">.</span><span class="s1">findall</span><span class="s3">(</span><span class="s5">&quot;column&quot;</span><span class="s3">)))</span>

            <span class="s2">if </span><span class="s1">self</span><span class="s3">.</span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'rowCount'</span><span class="s3">) </span><span class="s2">is None</span><span class="s3">:</span>
                <span class="s1">self</span><span class="s3">.</span><span class="s1">stack</span><span class="s3">.</span><span class="s1">topwidget</span><span class="s3">.</span><span class="s1">setRowCount</span><span class="s3">(</span><span class="s1">len</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">.</span><span class="s1">findall</span><span class="s3">(</span><span class="s5">&quot;row&quot;</span><span class="s3">)))</span>

        <span class="s1">self</span><span class="s3">.</span><span class="s1">traverseWidgetTree</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">)</span>
        <span class="s1">widget </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">stack</span><span class="s3">.</span><span class="s1">popWidget</span><span class="s3">()</span>

        <span class="s2">if </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">widget</span><span class="s3">, </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QTreeView</span><span class="s3">):</span>
            <span class="s1">self</span><span class="s3">.</span><span class="s1">handleHeaderView</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">&quot;header&quot;</span><span class="s3">, </span><span class="s1">widget</span><span class="s3">.</span><span class="s1">header</span><span class="s3">())</span>

        <span class="s2">elif </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">widget</span><span class="s3">, </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QTableView</span><span class="s3">):</span>
            <span class="s1">self</span><span class="s3">.</span><span class="s1">handleHeaderView</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">&quot;horizontalHeader&quot;</span><span class="s3">,</span>
                    <span class="s1">widget</span><span class="s3">.</span><span class="s1">horizontalHeader</span><span class="s3">())</span>
            <span class="s1">self</span><span class="s3">.</span><span class="s1">handleHeaderView</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">&quot;verticalHeader&quot;</span><span class="s3">,</span>
                    <span class="s1">widget</span><span class="s3">.</span><span class="s1">verticalHeader</span><span class="s3">())</span>

        <span class="s2">elif </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">widget</span><span class="s3">, </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QAbstractButton</span><span class="s3">):</span>
            <span class="s1">bg_i18n </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">getAttribute</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">&quot;buttonGroup&quot;</span><span class="s3">)</span>
            <span class="s2">if </span><span class="s1">bg_i18n </span><span class="s2">is not None</span><span class="s3">:</span>
                <span class="s0"># This should be handled properly in case the problem arises</span>
                <span class="s0"># elsewhere as well.</span>
                <span class="s2">try</span><span class="s3">:</span>
                    <span class="s0"># We are compiling the .ui file.</span>
                    <span class="s1">bg_name </span><span class="s3">= </span><span class="s1">bg_i18n</span><span class="s3">.</span><span class="s1">string</span>
                <span class="s2">except </span><span class="s1">AttributeError</span><span class="s3">:</span>
                    <span class="s0"># We are loading the .ui file.</span>
                    <span class="s1">bg_name </span><span class="s3">= </span><span class="s1">bg_i18n</span>

				<span class="s0"># Designer allows the creation of .ui files without explicit</span>
				<span class="s0"># button groups, even though uic then issues warnings.  We</span>
				<span class="s0"># handle it in two stages by first making sure it has a name</span>
				<span class="s0"># and then making sure one exists with that name.</span>
                <span class="s2">if not </span><span class="s1">bg_name</span><span class="s3">:</span>
                    <span class="s1">bg_name </span><span class="s3">= </span><span class="s5">'buttonGroup'</span>

                <span class="s2">try</span><span class="s3">:</span>
                    <span class="s1">bg </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">button_groups</span><span class="s3">[</span><span class="s1">bg_name</span><span class="s3">]</span>
                <span class="s2">except </span><span class="s1">KeyError</span><span class="s3">:</span>
                    <span class="s1">bg </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">button_groups</span><span class="s3">[</span><span class="s1">bg_name</span><span class="s3">] = </span><span class="s1">ButtonGroup</span><span class="s3">()</span>

                <span class="s2">if </span><span class="s1">bg</span><span class="s3">.</span><span class="s1">object </span><span class="s2">is None</span><span class="s3">:</span>
                    <span class="s1">bg</span><span class="s3">.</span><span class="s1">object </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">factory</span><span class="s3">.</span><span class="s1">createQObject</span><span class="s3">(</span><span class="s5">&quot;QButtonGroup&quot;</span><span class="s3">,</span>
                            <span class="s1">bg_name</span><span class="s3">, (</span><span class="s1">self</span><span class="s3">.</span><span class="s1">toplevelWidget</span><span class="s3">, ))</span>
                    <span class="s1">setattr</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">toplevelWidget</span><span class="s3">, </span><span class="s1">bg_name</span><span class="s3">, </span><span class="s1">bg</span><span class="s3">.</span><span class="s1">object</span><span class="s3">)</span>

                    <span class="s1">bg</span><span class="s3">.</span><span class="s1">object</span><span class="s3">.</span><span class="s1">setObjectName</span><span class="s3">(</span><span class="s1">bg_name</span><span class="s3">)</span>

                    <span class="s2">if not </span><span class="s1">bg</span><span class="s3">.</span><span class="s1">exclusive</span><span class="s3">:</span>
                        <span class="s1">bg</span><span class="s3">.</span><span class="s1">object</span><span class="s3">.</span><span class="s1">setExclusive</span><span class="s3">(</span><span class="s2">False</span><span class="s3">)</span>

                <span class="s1">bg</span><span class="s3">.</span><span class="s1">object</span><span class="s3">.</span><span class="s1">addButton</span><span class="s3">(</span><span class="s1">widget</span><span class="s3">)</span>

        <span class="s2">if </span><span class="s1">self</span><span class="s3">.</span><span class="s1">sorting_enabled </span><span class="s2">is not None</span><span class="s3">:</span>
            <span class="s1">widget</span><span class="s3">.</span><span class="s1">setSortingEnabled</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">sorting_enabled</span><span class="s3">)</span>
            <span class="s1">self</span><span class="s3">.</span><span class="s1">sorting_enabled </span><span class="s3">= </span><span class="s2">None</span>
        
        <span class="s2">if </span><span class="s1">self</span><span class="s3">.</span><span class="s1">stack</span><span class="s3">.</span><span class="s1">topIsLayout</span><span class="s3">():</span>
            <span class="s1">lay </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">stack</span><span class="s3">.</span><span class="s1">peek</span><span class="s3">()</span>
            <span class="s1">lp </span><span class="s3">= </span><span class="s1">elem</span><span class="s3">.</span><span class="s1">attrib</span><span class="s3">[</span><span class="s5">'layout-position'</span><span class="s3">]</span>

            <span class="s2">if </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">lay</span><span class="s3">, </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QFormLayout</span><span class="s3">):</span>
                <span class="s1">lay</span><span class="s3">.</span><span class="s1">setWidget</span><span class="s3">(</span><span class="s1">lp</span><span class="s3">[</span><span class="s6">0</span><span class="s3">], </span><span class="s1">self</span><span class="s3">.</span><span class="s1">_form_layout_role</span><span class="s3">(</span><span class="s1">lp</span><span class="s3">), </span><span class="s1">widget</span><span class="s3">)</span>
            <span class="s2">else</span><span class="s3">:</span>
                <span class="s1">lay</span><span class="s3">.</span><span class="s1">addWidget</span><span class="s3">(</span><span class="s1">widget</span><span class="s3">, *</span><span class="s1">lp</span><span class="s3">)</span>

        <span class="s1">topwidget </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">stack</span><span class="s3">.</span><span class="s1">topwidget</span>

        <span class="s2">if </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">topwidget</span><span class="s3">, </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QToolBox</span><span class="s3">):</span>
            <span class="s1">icon </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">getAttribute</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">&quot;icon&quot;</span><span class="s3">)</span>
            <span class="s2">if </span><span class="s1">icon </span><span class="s2">is not None</span><span class="s3">:</span>
                <span class="s1">topwidget</span><span class="s3">.</span><span class="s1">addItem</span><span class="s3">(</span><span class="s1">widget</span><span class="s3">, </span><span class="s1">icon</span><span class="s3">, </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">getAttribute</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">&quot;label&quot;</span><span class="s3">))</span>
            <span class="s2">else</span><span class="s3">:</span>
                <span class="s1">topwidget</span><span class="s3">.</span><span class="s1">addItem</span><span class="s3">(</span><span class="s1">widget</span><span class="s3">, </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">getAttribute</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">&quot;label&quot;</span><span class="s3">))</span>

            <span class="s1">tooltip </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">getAttribute</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">&quot;toolTip&quot;</span><span class="s3">)</span>
            <span class="s2">if </span><span class="s1">tooltip </span><span class="s2">is not None</span><span class="s3">:</span>
                <span class="s1">topwidget</span><span class="s3">.</span><span class="s1">setItemToolTip</span><span class="s3">(</span><span class="s1">topwidget</span><span class="s3">.</span><span class="s1">indexOf</span><span class="s3">(</span><span class="s1">widget</span><span class="s3">), </span><span class="s1">tooltip</span><span class="s3">)</span>
                
        <span class="s2">elif </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">topwidget</span><span class="s3">, </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QTabWidget</span><span class="s3">):</span>
            <span class="s1">icon </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">getAttribute</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">&quot;icon&quot;</span><span class="s3">)</span>
            <span class="s2">if </span><span class="s1">icon </span><span class="s2">is not None</span><span class="s3">:</span>
                <span class="s1">topwidget</span><span class="s3">.</span><span class="s1">addTab</span><span class="s3">(</span><span class="s1">widget</span><span class="s3">, </span><span class="s1">icon</span><span class="s3">, </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">getAttribute</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">&quot;title&quot;</span><span class="s3">))</span>
            <span class="s2">else</span><span class="s3">:</span>
                <span class="s1">topwidget</span><span class="s3">.</span><span class="s1">addTab</span><span class="s3">(</span><span class="s1">widget</span><span class="s3">, </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">getAttribute</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">&quot;title&quot;</span><span class="s3">))</span>

            <span class="s1">tooltip </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">getAttribute</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">&quot;toolTip&quot;</span><span class="s3">)</span>
            <span class="s2">if </span><span class="s1">tooltip </span><span class="s2">is not None</span><span class="s3">:</span>
                <span class="s1">topwidget</span><span class="s3">.</span><span class="s1">setTabToolTip</span><span class="s3">(</span><span class="s1">topwidget</span><span class="s3">.</span><span class="s1">indexOf</span><span class="s3">(</span><span class="s1">widget</span><span class="s3">), </span><span class="s1">tooltip</span><span class="s3">)</span>
            
        <span class="s2">elif </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">topwidget</span><span class="s3">, </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QWizard</span><span class="s3">):</span>
            <span class="s1">topwidget</span><span class="s3">.</span><span class="s1">addPage</span><span class="s3">(</span><span class="s1">widget</span><span class="s3">)</span>
            
        <span class="s2">elif </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">topwidget</span><span class="s3">, </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QStackedWidget</span><span class="s3">):</span>
            <span class="s1">topwidget</span><span class="s3">.</span><span class="s1">addWidget</span><span class="s3">(</span><span class="s1">widget</span><span class="s3">)</span>
            
        <span class="s2">elif </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">topwidget</span><span class="s3">, (</span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QDockWidget</span><span class="s3">, </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QScrollArea</span><span class="s3">)):</span>
            <span class="s1">topwidget</span><span class="s3">.</span><span class="s1">setWidget</span><span class="s3">(</span><span class="s1">widget</span><span class="s3">)</span>
            
        <span class="s2">elif </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">topwidget</span><span class="s3">, </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QMainWindow</span><span class="s3">):</span>
            <span class="s2">if </span><span class="s1">type</span><span class="s3">(</span><span class="s1">widget</span><span class="s3">) == </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QWidget</span><span class="s3">:</span>
                <span class="s1">topwidget</span><span class="s3">.</span><span class="s1">setCentralWidget</span><span class="s3">(</span><span class="s1">widget</span><span class="s3">)</span>
            <span class="s2">elif </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">widget</span><span class="s3">, </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QToolBar</span><span class="s3">):</span>
                <span class="s1">tbArea </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">getAttribute</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">&quot;toolBarArea&quot;</span><span class="s3">)</span>

                <span class="s2">if </span><span class="s1">tbArea </span><span class="s2">is None</span><span class="s3">:</span>
                    <span class="s1">topwidget</span><span class="s3">.</span><span class="s1">addToolBar</span><span class="s3">(</span><span class="s1">widget</span><span class="s3">)</span>
                <span class="s2">else</span><span class="s3">:</span>
                    <span class="s1">topwidget</span><span class="s3">.</span><span class="s1">addToolBar</span><span class="s3">(</span><span class="s1">tbArea</span><span class="s3">, </span><span class="s1">widget</span><span class="s3">)</span>

                <span class="s1">tbBreak </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">getAttribute</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">&quot;toolBarBreak&quot;</span><span class="s3">)</span>

                <span class="s2">if </span><span class="s1">tbBreak</span><span class="s3">:</span>
                    <span class="s1">topwidget</span><span class="s3">.</span><span class="s1">insertToolBarBreak</span><span class="s3">(</span><span class="s1">widget</span><span class="s3">)</span>

            <span class="s2">elif </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">widget</span><span class="s3">, </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QMenuBar</span><span class="s3">):</span>
                <span class="s1">topwidget</span><span class="s3">.</span><span class="s1">setMenuBar</span><span class="s3">(</span><span class="s1">widget</span><span class="s3">)</span>
            <span class="s2">elif </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">widget</span><span class="s3">, </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QStatusBar</span><span class="s3">):</span>
                <span class="s1">topwidget</span><span class="s3">.</span><span class="s1">setStatusBar</span><span class="s3">(</span><span class="s1">widget</span><span class="s3">)</span>
            <span class="s2">elif </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">widget</span><span class="s3">, </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QDockWidget</span><span class="s3">):</span>
                <span class="s1">dwArea </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">getAttribute</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">&quot;dockWidgetArea&quot;</span><span class="s3">)</span>
                <span class="s1">topwidget</span><span class="s3">.</span><span class="s1">addDockWidget</span><span class="s3">(</span><span class="s1">QtCore</span><span class="s3">.</span><span class="s1">Qt</span><span class="s3">.</span><span class="s1">DockWidgetArea</span><span class="s3">(</span><span class="s1">dwArea</span><span class="s3">),</span>
                        <span class="s1">widget</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">handleHeaderView</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">elem</span><span class="s3">, </span><span class="s1">name</span><span class="s3">, </span><span class="s1">header</span><span class="s3">):</span>
        <span class="s1">value </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">getAttribute</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s1">name </span><span class="s3">+ </span><span class="s5">&quot;Visible&quot;</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">value </span><span class="s2">is not None</span><span class="s3">:</span>
            <span class="s1">header</span><span class="s3">.</span><span class="s1">setVisible</span><span class="s3">(</span><span class="s1">value</span><span class="s3">)</span>

        <span class="s1">value </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">getAttribute</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s1">name </span><span class="s3">+ </span><span class="s5">&quot;CascadingSectionResizes&quot;</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">value </span><span class="s2">is not None</span><span class="s3">:</span>
            <span class="s1">header</span><span class="s3">.</span><span class="s1">setCascadingSectionResizes</span><span class="s3">(</span><span class="s1">value</span><span class="s3">)</span>

        <span class="s1">value </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">getAttribute</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s1">name </span><span class="s3">+ </span><span class="s5">&quot;DefaultSectionSize&quot;</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">value </span><span class="s2">is not None</span><span class="s3">:</span>
            <span class="s1">header</span><span class="s3">.</span><span class="s1">setDefaultSectionSize</span><span class="s3">(</span><span class="s1">value</span><span class="s3">)</span>

        <span class="s1">value </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">getAttribute</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s1">name </span><span class="s3">+ </span><span class="s5">&quot;HighlightSections&quot;</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">value </span><span class="s2">is not None</span><span class="s3">:</span>
            <span class="s1">header</span><span class="s3">.</span><span class="s1">setHighlightSections</span><span class="s3">(</span><span class="s1">value</span><span class="s3">)</span>

        <span class="s1">value </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">getAttribute</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s1">name </span><span class="s3">+ </span><span class="s5">&quot;MinimumSectionSize&quot;</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">value </span><span class="s2">is not None</span><span class="s3">:</span>
            <span class="s1">header</span><span class="s3">.</span><span class="s1">setMinimumSectionSize</span><span class="s3">(</span><span class="s1">value</span><span class="s3">)</span>

        <span class="s1">value </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">getAttribute</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s1">name </span><span class="s3">+ </span><span class="s5">&quot;ShowSortIndicator&quot;</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">value </span><span class="s2">is not None</span><span class="s3">:</span>
            <span class="s1">header</span><span class="s3">.</span><span class="s1">setSortIndicatorShown</span><span class="s3">(</span><span class="s1">value</span><span class="s3">)</span>

        <span class="s1">value </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">getAttribute</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s1">name </span><span class="s3">+ </span><span class="s5">&quot;StretchLastSection&quot;</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">value </span><span class="s2">is not None</span><span class="s3">:</span>
            <span class="s1">header</span><span class="s3">.</span><span class="s1">setStretchLastSection</span><span class="s3">(</span><span class="s1">value</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">createSpacer</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">elem</span><span class="s3">):</span>
        <span class="s1">width </span><span class="s3">= </span><span class="s1">elem</span><span class="s3">.</span><span class="s1">findtext</span><span class="s3">(</span><span class="s5">&quot;property/size/width&quot;</span><span class="s3">)</span>
        <span class="s1">height </span><span class="s3">= </span><span class="s1">elem</span><span class="s3">.</span><span class="s1">findtext</span><span class="s3">(</span><span class="s5">&quot;property/size/height&quot;</span><span class="s3">)</span>

        <span class="s2">if </span><span class="s1">width </span><span class="s2">is None or </span><span class="s1">height </span><span class="s2">is None</span><span class="s3">:</span>
            <span class="s1">size_args </span><span class="s3">= ()</span>
        <span class="s2">else</span><span class="s3">:</span>
            <span class="s1">size_args </span><span class="s3">= (</span><span class="s1">int</span><span class="s3">(</span><span class="s1">width</span><span class="s3">), </span><span class="s1">int</span><span class="s3">(</span><span class="s1">height</span><span class="s3">))</span>

        <span class="s1">sizeType </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">&quot;sizeType&quot;</span><span class="s3">,</span>
                <span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QSizePolicy</span><span class="s3">.</span><span class="s1">Expanding</span><span class="s3">)</span>

        <span class="s1">policy </span><span class="s3">= (</span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QSizePolicy</span><span class="s3">.</span><span class="s1">Minimum</span><span class="s3">, </span><span class="s1">sizeType</span><span class="s3">)</span>

        <span class="s2">if </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">&quot;orientation&quot;</span><span class="s3">) == </span><span class="s1">QtCore</span><span class="s3">.</span><span class="s1">Qt</span><span class="s3">.</span><span class="s1">Horizontal</span><span class="s3">:</span>
            <span class="s1">policy </span><span class="s3">= </span><span class="s1">policy</span><span class="s3">[</span><span class="s6">1</span><span class="s3">], </span><span class="s1">policy</span><span class="s3">[</span><span class="s6">0</span><span class="s3">]</span>

        <span class="s1">spacer </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">factory</span><span class="s3">.</span><span class="s1">createQObject</span><span class="s3">(</span><span class="s5">&quot;QSpacerItem&quot;</span><span class="s3">,</span>
                <span class="s1">self</span><span class="s3">.</span><span class="s1">uniqueName</span><span class="s3">(</span><span class="s5">&quot;spacerItem&quot;</span><span class="s3">), </span><span class="s1">size_args </span><span class="s3">+ </span><span class="s1">policy</span><span class="s3">,</span>
                <span class="s1">is_attribute</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>

        <span class="s2">if </span><span class="s1">self</span><span class="s3">.</span><span class="s1">stack</span><span class="s3">.</span><span class="s1">topIsLayout</span><span class="s3">():</span>
            <span class="s1">lay </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">stack</span><span class="s3">.</span><span class="s1">peek</span><span class="s3">()</span>
            <span class="s1">lp </span><span class="s3">= </span><span class="s1">elem</span><span class="s3">.</span><span class="s1">attrib</span><span class="s3">[</span><span class="s5">'layout-position'</span><span class="s3">]</span>

            <span class="s2">if </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">lay</span><span class="s3">, </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QFormLayout</span><span class="s3">):</span>
                <span class="s1">lay</span><span class="s3">.</span><span class="s1">setItem</span><span class="s3">(</span><span class="s1">lp</span><span class="s3">[</span><span class="s6">0</span><span class="s3">], </span><span class="s1">self</span><span class="s3">.</span><span class="s1">_form_layout_role</span><span class="s3">(</span><span class="s1">lp</span><span class="s3">), </span><span class="s1">spacer</span><span class="s3">)</span>
            <span class="s2">else</span><span class="s3">:</span>
                <span class="s1">lay</span><span class="s3">.</span><span class="s1">addItem</span><span class="s3">(</span><span class="s1">spacer</span><span class="s3">, *</span><span class="s1">lp</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">createLayout</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">elem</span><span class="s3">):</span>
        <span class="s0"># We use an internal property to handle margins which will use separate</span>
        <span class="s0"># left, top, right and bottom margins if they are found to be</span>
        <span class="s0"># different.  The following will select, in order of preference,</span>
        <span class="s0"># separate margins, the same margin in all directions, and the default</span>
        <span class="s0"># margin.</span>
        <span class="s1">margin </span><span class="s3">= -</span><span class="s6">1 </span><span class="s2">if </span><span class="s1">self</span><span class="s3">.</span><span class="s1">stack</span><span class="s3">.</span><span class="s1">topIsLayout</span><span class="s3">() </span><span class="s2">else </span><span class="s1">self</span><span class="s3">.</span><span class="s1">defaults</span><span class="s3">[</span><span class="s5">'margin'</span><span class="s3">]</span>
        <span class="s1">margin </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'margin'</span><span class="s3">, </span><span class="s1">margin</span><span class="s3">)</span>
        <span class="s1">left </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'leftMargin'</span><span class="s3">, </span><span class="s1">margin</span><span class="s3">)</span>
        <span class="s1">top </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'topMargin'</span><span class="s3">, </span><span class="s1">margin</span><span class="s3">)</span>
        <span class="s1">right </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'rightMargin'</span><span class="s3">, </span><span class="s1">margin</span><span class="s3">)</span>
        <span class="s1">bottom </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'bottomMargin'</span><span class="s3">, </span><span class="s1">margin</span><span class="s3">)</span>

        <span class="s0"># A layout widget should, by default, have no margins.</span>
        <span class="s2">if </span><span class="s1">self</span><span class="s3">.</span><span class="s1">stack</span><span class="s3">.</span><span class="s1">topIsLayoutWidget</span><span class="s3">():</span>
            <span class="s2">if </span><span class="s1">left </span><span class="s3">&lt; </span><span class="s6">0</span><span class="s3">: </span><span class="s1">left </span><span class="s3">= </span><span class="s6">0</span>
            <span class="s2">if </span><span class="s1">top </span><span class="s3">&lt; </span><span class="s6">0</span><span class="s3">: </span><span class="s1">top </span><span class="s3">= </span><span class="s6">0</span>
            <span class="s2">if </span><span class="s1">right </span><span class="s3">&lt; </span><span class="s6">0</span><span class="s3">: </span><span class="s1">right </span><span class="s3">= </span><span class="s6">0</span>
            <span class="s2">if </span><span class="s1">bottom </span><span class="s3">&lt; </span><span class="s6">0</span><span class="s3">: </span><span class="s1">bottom </span><span class="s3">= </span><span class="s6">0</span>

        <span class="s2">if </span><span class="s1">left </span><span class="s3">&gt;= </span><span class="s6">0 </span><span class="s2">or </span><span class="s1">top </span><span class="s3">&gt;= </span><span class="s6">0 </span><span class="s2">or </span><span class="s1">right </span><span class="s3">&gt;= </span><span class="s6">0 </span><span class="s2">or </span><span class="s1">bottom </span><span class="s3">&gt;= </span><span class="s6">0</span><span class="s3">:</span>
            <span class="s0"># We inject the new internal property.</span>
            <span class="s1">cme </span><span class="s3">= </span><span class="s1">SubElement</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'property'</span><span class="s3">, </span><span class="s1">name</span><span class="s3">=</span><span class="s5">'pyuicMargins'</span><span class="s3">)</span>
            <span class="s1">SubElement</span><span class="s3">(</span><span class="s1">cme</span><span class="s3">, </span><span class="s5">'number'</span><span class="s3">).</span><span class="s1">text </span><span class="s3">= </span><span class="s1">str</span><span class="s3">(</span><span class="s1">left</span><span class="s3">)</span>
            <span class="s1">SubElement</span><span class="s3">(</span><span class="s1">cme</span><span class="s3">, </span><span class="s5">'number'</span><span class="s3">).</span><span class="s1">text </span><span class="s3">= </span><span class="s1">str</span><span class="s3">(</span><span class="s1">top</span><span class="s3">)</span>
            <span class="s1">SubElement</span><span class="s3">(</span><span class="s1">cme</span><span class="s3">, </span><span class="s5">'number'</span><span class="s3">).</span><span class="s1">text </span><span class="s3">= </span><span class="s1">str</span><span class="s3">(</span><span class="s1">right</span><span class="s3">)</span>
            <span class="s1">SubElement</span><span class="s3">(</span><span class="s1">cme</span><span class="s3">, </span><span class="s5">'number'</span><span class="s3">).</span><span class="s1">text </span><span class="s3">= </span><span class="s1">str</span><span class="s3">(</span><span class="s1">bottom</span><span class="s3">)</span>

        <span class="s0"># We use an internal property to handle spacing which will use separate</span>
        <span class="s0"># horizontal and vertical spacing if they are found to be different.</span>
        <span class="s0"># The following will select, in order of preference, separate</span>
        <span class="s0"># horizontal and vertical spacing, the same spacing in both directions,</span>
        <span class="s0"># and the default spacing.</span>
        <span class="s1">spacing </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'spacing'</span><span class="s3">,</span>
                <span class="s1">self</span><span class="s3">.</span><span class="s1">defaults</span><span class="s3">[</span><span class="s5">'spacing'</span><span class="s3">])</span>
        <span class="s1">horiz </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'horizontalSpacing'</span><span class="s3">, </span><span class="s1">spacing</span><span class="s3">)</span>
        <span class="s1">vert </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'verticalSpacing'</span><span class="s3">, </span><span class="s1">spacing</span><span class="s3">)</span>

        <span class="s2">if </span><span class="s1">horiz </span><span class="s3">&gt;= </span><span class="s6">0 </span><span class="s2">or </span><span class="s1">vert </span><span class="s3">&gt;= </span><span class="s6">0</span><span class="s3">:</span>
            <span class="s0"># We inject the new internal property.</span>
            <span class="s1">cme </span><span class="s3">= </span><span class="s1">SubElement</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'property'</span><span class="s3">, </span><span class="s1">name</span><span class="s3">=</span><span class="s5">'pyuicSpacing'</span><span class="s3">)</span>
            <span class="s1">SubElement</span><span class="s3">(</span><span class="s1">cme</span><span class="s3">, </span><span class="s5">'number'</span><span class="s3">).</span><span class="s1">text </span><span class="s3">= </span><span class="s1">str</span><span class="s3">(</span><span class="s1">horiz</span><span class="s3">)</span>
            <span class="s1">SubElement</span><span class="s3">(</span><span class="s1">cme</span><span class="s3">, </span><span class="s5">'number'</span><span class="s3">).</span><span class="s1">text </span><span class="s3">= </span><span class="s1">str</span><span class="s3">(</span><span class="s1">vert</span><span class="s3">)</span>

        <span class="s1">classname </span><span class="s3">= </span><span class="s1">elem</span><span class="s3">.</span><span class="s1">attrib</span><span class="s3">[</span><span class="s5">&quot;class&quot;</span><span class="s3">]</span>
        <span class="s2">if </span><span class="s1">self</span><span class="s3">.</span><span class="s1">stack</span><span class="s3">.</span><span class="s1">topIsLayout</span><span class="s3">():</span>
            <span class="s1">parent </span><span class="s3">= </span><span class="s2">None</span>
        <span class="s2">else</span><span class="s3">:</span>
            <span class="s1">parent </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">stack</span><span class="s3">.</span><span class="s1">topwidget</span>
        <span class="s2">if </span><span class="s5">&quot;name&quot; </span><span class="s2">not in </span><span class="s1">elem</span><span class="s3">.</span><span class="s1">attrib</span><span class="s3">:</span>
            <span class="s1">elem</span><span class="s3">.</span><span class="s1">attrib</span><span class="s3">[</span><span class="s5">&quot;name&quot;</span><span class="s3">] = </span><span class="s1">classname</span><span class="s3">[</span><span class="s6">1</span><span class="s3">:].</span><span class="s1">lower</span><span class="s3">()</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">stack</span><span class="s3">.</span><span class="s1">push</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">setupObject</span><span class="s3">(</span><span class="s1">classname</span><span class="s3">, </span><span class="s1">parent</span><span class="s3">, </span><span class="s1">elem</span><span class="s3">))</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">traverseWidgetTree</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">)</span>

        <span class="s1">layout </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">stack</span><span class="s3">.</span><span class="s1">popLayout</span><span class="s3">()</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">configureLayout</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s1">layout</span><span class="s3">)</span>

        <span class="s2">if </span><span class="s1">self</span><span class="s3">.</span><span class="s1">stack</span><span class="s3">.</span><span class="s1">topIsLayout</span><span class="s3">():</span>
            <span class="s1">top_layout </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">stack</span><span class="s3">.</span><span class="s1">peek</span><span class="s3">()</span>
            <span class="s1">lp </span><span class="s3">= </span><span class="s1">elem</span><span class="s3">.</span><span class="s1">attrib</span><span class="s3">[</span><span class="s5">'layout-position'</span><span class="s3">]</span>

            <span class="s2">if </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">top_layout</span><span class="s3">, </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QFormLayout</span><span class="s3">):</span>
                <span class="s1">top_layout</span><span class="s3">.</span><span class="s1">setLayout</span><span class="s3">(</span><span class="s1">lp</span><span class="s3">[</span><span class="s6">0</span><span class="s3">], </span><span class="s1">self</span><span class="s3">.</span><span class="s1">_form_layout_role</span><span class="s3">(</span><span class="s1">lp</span><span class="s3">), </span><span class="s1">layout</span><span class="s3">)</span>
            <span class="s2">else</span><span class="s3">:</span>
                <span class="s1">top_layout</span><span class="s3">.</span><span class="s1">addLayout</span><span class="s3">(</span><span class="s1">layout</span><span class="s3">, *</span><span class="s1">lp</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">configureLayout</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">elem</span><span class="s3">, </span><span class="s1">layout</span><span class="s3">):</span>
        <span class="s2">if </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">layout</span><span class="s3">, </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QGridLayout</span><span class="s3">):</span>
            <span class="s1">self</span><span class="s3">.</span><span class="s1">setArray</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'columnminimumwidth'</span><span class="s3">,</span>
                    <span class="s1">layout</span><span class="s3">.</span><span class="s1">setColumnMinimumWidth</span><span class="s3">)</span>
            <span class="s1">self</span><span class="s3">.</span><span class="s1">setArray</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'rowminimumheight'</span><span class="s3">,</span>
                    <span class="s1">layout</span><span class="s3">.</span><span class="s1">setRowMinimumHeight</span><span class="s3">)</span>
            <span class="s1">self</span><span class="s3">.</span><span class="s1">setArray</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'columnstretch'</span><span class="s3">, </span><span class="s1">layout</span><span class="s3">.</span><span class="s1">setColumnStretch</span><span class="s3">)</span>
            <span class="s1">self</span><span class="s3">.</span><span class="s1">setArray</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'rowstretch'</span><span class="s3">, </span><span class="s1">layout</span><span class="s3">.</span><span class="s1">setRowStretch</span><span class="s3">)</span>

        <span class="s2">elif </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">layout</span><span class="s3">, </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QBoxLayout</span><span class="s3">):</span>
            <span class="s1">self</span><span class="s3">.</span><span class="s1">setArray</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'stretch'</span><span class="s3">, </span><span class="s1">layout</span><span class="s3">.</span><span class="s1">setStretch</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">setArray</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">elem</span><span class="s3">, </span><span class="s1">name</span><span class="s3">, </span><span class="s1">setter</span><span class="s3">):</span>
        <span class="s1">array </span><span class="s3">= </span><span class="s1">elem</span><span class="s3">.</span><span class="s1">attrib</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s1">name</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">array</span><span class="s3">:</span>
            <span class="s2">for </span><span class="s1">idx</span><span class="s3">, </span><span class="s1">value </span><span class="s2">in </span><span class="s1">enumerate</span><span class="s3">(</span><span class="s1">array</span><span class="s3">.</span><span class="s1">split</span><span class="s3">(</span><span class="s5">','</span><span class="s3">)):</span>
                <span class="s1">value </span><span class="s3">= </span><span class="s1">int</span><span class="s3">(</span><span class="s1">value</span><span class="s3">)</span>
                <span class="s2">if </span><span class="s1">value </span><span class="s3">&gt; </span><span class="s6">0</span><span class="s3">:</span>
                    <span class="s1">setter</span><span class="s3">(</span><span class="s1">idx</span><span class="s3">, </span><span class="s1">value</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">disableSorting</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">w</span><span class="s3">):</span>
        <span class="s2">if </span><span class="s1">self</span><span class="s3">.</span><span class="s1">item_nr </span><span class="s3">== </span><span class="s6">0</span><span class="s3">:</span>
            <span class="s1">self</span><span class="s3">.</span><span class="s1">sorting_enabled </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">factory</span><span class="s3">.</span><span class="s1">invoke</span><span class="s3">(</span><span class="s5">&quot;__sortingEnabled&quot;</span><span class="s3">,</span>
                    <span class="s1">w</span><span class="s3">.</span><span class="s1">isSortingEnabled</span><span class="s3">)</span>
            <span class="s1">w</span><span class="s3">.</span><span class="s1">setSortingEnabled</span><span class="s3">(</span><span class="s2">False</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">handleItem</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">elem</span><span class="s3">):</span>
        <span class="s2">if </span><span class="s1">self</span><span class="s3">.</span><span class="s1">stack</span><span class="s3">.</span><span class="s1">topIsLayout</span><span class="s3">():</span>
            <span class="s1">elem</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">attrib</span><span class="s3">[</span><span class="s5">'layout-position'</span><span class="s3">] = </span><span class="s1">_layout_position</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">)</span>
            <span class="s1">self</span><span class="s3">.</span><span class="s1">traverseWidgetTree</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">)</span>
        <span class="s2">else</span><span class="s3">:</span>
            <span class="s1">w </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">stack</span><span class="s3">.</span><span class="s1">topwidget</span>

            <span class="s2">if </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">w</span><span class="s3">, </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QComboBox</span><span class="s3">):</span>
                <span class="s1">text </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">&quot;text&quot;</span><span class="s3">)</span>
                <span class="s1">icon </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">&quot;icon&quot;</span><span class="s3">)</span>

                <span class="s2">if </span><span class="s1">icon</span><span class="s3">:</span>
                    <span class="s1">w</span><span class="s3">.</span><span class="s1">addItem</span><span class="s3">(</span><span class="s1">icon</span><span class="s3">, </span><span class="s5">''</span><span class="s3">)</span>
                <span class="s2">else</span><span class="s3">:</span>
                    <span class="s1">w</span><span class="s3">.</span><span class="s1">addItem</span><span class="s3">(</span><span class="s5">''</span><span class="s3">)</span>

                <span class="s1">w</span><span class="s3">.</span><span class="s1">setItemText</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">item_nr</span><span class="s3">, </span><span class="s1">text</span><span class="s3">)</span>

            <span class="s2">elif </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">w</span><span class="s3">, </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QListWidget</span><span class="s3">):</span>
                <span class="s1">self</span><span class="s3">.</span><span class="s1">disableSorting</span><span class="s3">(</span><span class="s1">w</span><span class="s3">)</span>
                <span class="s1">item </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">createWidgetItem</span><span class="s3">(</span><span class="s5">'QListWidgetItem'</span><span class="s3">, </span><span class="s1">elem</span><span class="s3">, </span><span class="s1">w</span><span class="s3">.</span><span class="s1">item</span><span class="s3">,</span>
                        <span class="s1">self</span><span class="s3">.</span><span class="s1">item_nr</span><span class="s3">)</span>
                <span class="s1">w</span><span class="s3">.</span><span class="s1">addItem</span><span class="s3">(</span><span class="s1">item</span><span class="s3">)</span>

            <span class="s2">elif </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">w</span><span class="s3">, </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QTreeWidget</span><span class="s3">):</span>
                <span class="s2">if </span><span class="s1">self</span><span class="s3">.</span><span class="s1">itemstack</span><span class="s3">:</span>
                    <span class="s1">parent</span><span class="s3">, </span><span class="s1">_ </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">itemstack</span><span class="s3">[-</span><span class="s6">1</span><span class="s3">]</span>
                    <span class="s1">_</span><span class="s3">, </span><span class="s1">nr_in_root </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">itemstack</span><span class="s3">[</span><span class="s6">0</span><span class="s3">]</span>
                <span class="s2">else</span><span class="s3">:</span>
                    <span class="s1">parent </span><span class="s3">= </span><span class="s1">w</span>
                    <span class="s1">nr_in_root </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">item_nr</span>

                <span class="s1">item </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">factory</span><span class="s3">.</span><span class="s1">createQObject</span><span class="s3">(</span><span class="s5">&quot;QTreeWidgetItem&quot;</span><span class="s3">,</span>
                        <span class="s5">&quot;item_%d&quot; </span><span class="s3">% </span><span class="s1">len</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">itemstack</span><span class="s3">), (</span><span class="s1">parent</span><span class="s3">, ), </span><span class="s2">False</span><span class="s3">)</span>

                <span class="s2">if </span><span class="s1">self</span><span class="s3">.</span><span class="s1">item_nr </span><span class="s3">== </span><span class="s6">0 </span><span class="s2">and not </span><span class="s1">self</span><span class="s3">.</span><span class="s1">itemstack</span><span class="s3">:</span>
                    <span class="s1">self</span><span class="s3">.</span><span class="s1">sorting_enabled </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">factory</span><span class="s3">.</span><span class="s1">invoke</span><span class="s3">(</span><span class="s5">&quot;__sortingEnabled&quot;</span><span class="s3">, </span><span class="s1">w</span><span class="s3">.</span><span class="s1">isSortingEnabled</span><span class="s3">)</span>
                    <span class="s1">w</span><span class="s3">.</span><span class="s1">setSortingEnabled</span><span class="s3">(</span><span class="s2">False</span><span class="s3">)</span>

                <span class="s1">self</span><span class="s3">.</span><span class="s1">itemstack</span><span class="s3">.</span><span class="s1">append</span><span class="s3">((</span><span class="s1">item</span><span class="s3">, </span><span class="s1">self</span><span class="s3">.</span><span class="s1">item_nr</span><span class="s3">))</span>
                <span class="s1">self</span><span class="s3">.</span><span class="s1">item_nr </span><span class="s3">= </span><span class="s6">0</span>

                <span class="s0"># We have to access the item via the tree when setting the</span>
                <span class="s0"># text.</span>
                <span class="s1">titm </span><span class="s3">= </span><span class="s1">w</span><span class="s3">.</span><span class="s1">topLevelItem</span><span class="s3">(</span><span class="s1">nr_in_root</span><span class="s3">)</span>
                <span class="s2">for </span><span class="s1">child</span><span class="s3">, </span><span class="s1">nr_in_parent </span><span class="s2">in </span><span class="s1">self</span><span class="s3">.</span><span class="s1">itemstack</span><span class="s3">[</span><span class="s6">1</span><span class="s3">:]:</span>
                    <span class="s1">titm </span><span class="s3">= </span><span class="s1">titm</span><span class="s3">.</span><span class="s1">child</span><span class="s3">(</span><span class="s1">nr_in_parent</span><span class="s3">)</span>

                <span class="s1">column </span><span class="s3">= -</span><span class="s6">1</span>
                <span class="s2">for </span><span class="s1">prop </span><span class="s2">in </span><span class="s1">elem</span><span class="s3">.</span><span class="s1">findall</span><span class="s3">(</span><span class="s5">'property'</span><span class="s3">):</span>
                    <span class="s1">c_prop </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">convert</span><span class="s3">(</span><span class="s1">prop</span><span class="s3">)</span>
                    <span class="s1">c_prop_name </span><span class="s3">= </span><span class="s1">prop</span><span class="s3">.</span><span class="s1">attrib</span><span class="s3">[</span><span class="s5">'name'</span><span class="s3">]</span>

                    <span class="s2">if </span><span class="s1">c_prop_name </span><span class="s3">== </span><span class="s5">'text'</span><span class="s3">:</span>
                        <span class="s1">column </span><span class="s3">+= </span><span class="s6">1</span>
                        <span class="s2">if </span><span class="s1">c_prop</span><span class="s3">:</span>
                            <span class="s1">titm</span><span class="s3">.</span><span class="s1">setText</span><span class="s3">(</span><span class="s1">column</span><span class="s3">, </span><span class="s1">c_prop</span><span class="s3">)</span>
                    <span class="s2">elif </span><span class="s1">c_prop_name </span><span class="s3">== </span><span class="s5">'statusTip'</span><span class="s3">:</span>
                        <span class="s1">item</span><span class="s3">.</span><span class="s1">setStatusTip</span><span class="s3">(</span><span class="s1">column</span><span class="s3">, </span><span class="s1">c_prop</span><span class="s3">)</span>
                    <span class="s2">elif </span><span class="s1">c_prop_name </span><span class="s3">== </span><span class="s5">'toolTip'</span><span class="s3">:</span>
                        <span class="s1">item</span><span class="s3">.</span><span class="s1">setToolTip</span><span class="s3">(</span><span class="s1">column</span><span class="s3">, </span><span class="s1">c_prop</span><span class="s3">)</span>
                    <span class="s2">elif </span><span class="s1">c_prop_name </span><span class="s3">== </span><span class="s5">'whatsThis'</span><span class="s3">:</span>
                        <span class="s1">item</span><span class="s3">.</span><span class="s1">setWhatsThis</span><span class="s3">(</span><span class="s1">column</span><span class="s3">, </span><span class="s1">c_prop</span><span class="s3">)</span>
                    <span class="s2">elif </span><span class="s1">c_prop_name </span><span class="s3">== </span><span class="s5">'font'</span><span class="s3">:</span>
                        <span class="s1">item</span><span class="s3">.</span><span class="s1">setFont</span><span class="s3">(</span><span class="s1">column</span><span class="s3">, </span><span class="s1">c_prop</span><span class="s3">)</span>
                    <span class="s2">elif </span><span class="s1">c_prop_name </span><span class="s3">== </span><span class="s5">'icon'</span><span class="s3">:</span>
                        <span class="s1">item</span><span class="s3">.</span><span class="s1">setIcon</span><span class="s3">(</span><span class="s1">column</span><span class="s3">, </span><span class="s1">c_prop</span><span class="s3">)</span>
                    <span class="s2">elif </span><span class="s1">c_prop_name </span><span class="s3">== </span><span class="s5">'background'</span><span class="s3">:</span>
                        <span class="s1">item</span><span class="s3">.</span><span class="s1">setBackground</span><span class="s3">(</span><span class="s1">column</span><span class="s3">, </span><span class="s1">c_prop</span><span class="s3">)</span>
                    <span class="s2">elif </span><span class="s1">c_prop_name </span><span class="s3">== </span><span class="s5">'foreground'</span><span class="s3">:</span>
                        <span class="s1">item</span><span class="s3">.</span><span class="s1">setForeground</span><span class="s3">(</span><span class="s1">column</span><span class="s3">, </span><span class="s1">c_prop</span><span class="s3">)</span>
                    <span class="s2">elif </span><span class="s1">c_prop_name </span><span class="s3">== </span><span class="s5">'flags'</span><span class="s3">:</span>
                        <span class="s1">item</span><span class="s3">.</span><span class="s1">setFlags</span><span class="s3">(</span><span class="s1">c_prop</span><span class="s3">)</span>
                    <span class="s2">elif </span><span class="s1">c_prop_name </span><span class="s3">== </span><span class="s5">'checkState'</span><span class="s3">:</span>
                        <span class="s1">item</span><span class="s3">.</span><span class="s1">setCheckState</span><span class="s3">(</span><span class="s1">column</span><span class="s3">, </span><span class="s1">c_prop</span><span class="s3">)</span>

                <span class="s1">self</span><span class="s3">.</span><span class="s1">traverseWidgetTree</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">)</span>
                <span class="s1">_</span><span class="s3">, </span><span class="s1">self</span><span class="s3">.</span><span class="s1">item_nr </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">itemstack</span><span class="s3">.</span><span class="s1">pop</span><span class="s3">()</span>

            <span class="s2">elif </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">w</span><span class="s3">, </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QTableWidget</span><span class="s3">):</span>
                <span class="s1">row </span><span class="s3">= </span><span class="s1">int</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">.</span><span class="s1">attrib</span><span class="s3">[</span><span class="s5">'row'</span><span class="s3">])</span>
                <span class="s1">col </span><span class="s3">= </span><span class="s1">int</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">.</span><span class="s1">attrib</span><span class="s3">[</span><span class="s5">'column'</span><span class="s3">])</span>

                <span class="s1">self</span><span class="s3">.</span><span class="s1">disableSorting</span><span class="s3">(</span><span class="s1">w</span><span class="s3">)</span>
                <span class="s1">item </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">createWidgetItem</span><span class="s3">(</span><span class="s5">'QTableWidgetItem'</span><span class="s3">, </span><span class="s1">elem</span><span class="s3">, </span><span class="s1">w</span><span class="s3">.</span><span class="s1">item</span><span class="s3">,</span>
                        <span class="s1">row</span><span class="s3">, </span><span class="s1">col</span><span class="s3">)</span>
                <span class="s1">w</span><span class="s3">.</span><span class="s1">setItem</span><span class="s3">(</span><span class="s1">row</span><span class="s3">, </span><span class="s1">col</span><span class="s3">, </span><span class="s1">item</span><span class="s3">)</span>

            <span class="s1">self</span><span class="s3">.</span><span class="s1">item_nr </span><span class="s3">+= </span><span class="s6">1</span>

    <span class="s2">def </span><span class="s1">addAction</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">elem</span><span class="s3">):</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">actions</span><span class="s3">.</span><span class="s1">append</span><span class="s3">((</span><span class="s1">self</span><span class="s3">.</span><span class="s1">stack</span><span class="s3">.</span><span class="s1">topwidget</span><span class="s3">, </span><span class="s1">elem</span><span class="s3">.</span><span class="s1">attrib</span><span class="s3">[</span><span class="s5">&quot;name&quot;</span><span class="s3">]))</span>

    <span class="s3">@</span><span class="s1">staticmethod</span>
    <span class="s2">def </span><span class="s1">any_i18n</span><span class="s3">(*</span><span class="s1">args</span><span class="s3">):</span>
        <span class="s4">&quot;&quot;&quot; Return True if any argument appears to be an i18n string. &quot;&quot;&quot;</span>

        <span class="s2">for </span><span class="s1">a </span><span class="s2">in </span><span class="s1">args</span><span class="s3">:</span>
            <span class="s2">if </span><span class="s1">a </span><span class="s2">is not None and not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">a</span><span class="s3">, </span><span class="s1">str</span><span class="s3">):</span>
                <span class="s2">return True</span>

        <span class="s2">return False</span>

    <span class="s2">def </span><span class="s1">createWidgetItem</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">item_type</span><span class="s3">, </span><span class="s1">elem</span><span class="s3">, </span><span class="s1">getter</span><span class="s3">, *</span><span class="s1">getter_args</span><span class="s3">):</span>
        <span class="s4">&quot;&quot;&quot; Create a specific type of widget item. &quot;&quot;&quot;</span>

        <span class="s1">item </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">factory</span><span class="s3">.</span><span class="s1">createQObject</span><span class="s3">(</span><span class="s1">item_type</span><span class="s3">, </span><span class="s5">&quot;item&quot;</span><span class="s3">, (), </span><span class="s2">False</span><span class="s3">)</span>
        <span class="s1">props </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span>

        <span class="s0"># Note that not all types of widget items support the full set of</span>
        <span class="s0"># properties.</span>

        <span class="s1">text </span><span class="s3">= </span><span class="s1">props</span><span class="s3">.</span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'text'</span><span class="s3">)</span>
        <span class="s1">status_tip </span><span class="s3">= </span><span class="s1">props</span><span class="s3">.</span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'statusTip'</span><span class="s3">)</span>
        <span class="s1">tool_tip </span><span class="s3">= </span><span class="s1">props</span><span class="s3">.</span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'toolTip'</span><span class="s3">)</span>
        <span class="s1">whats_this </span><span class="s3">= </span><span class="s1">props</span><span class="s3">.</span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'whatsThis'</span><span class="s3">)</span>

        <span class="s2">if </span><span class="s1">self</span><span class="s3">.</span><span class="s1">any_i18n</span><span class="s3">(</span><span class="s1">text</span><span class="s3">, </span><span class="s1">status_tip</span><span class="s3">, </span><span class="s1">tool_tip</span><span class="s3">, </span><span class="s1">whats_this</span><span class="s3">):</span>
            <span class="s1">self</span><span class="s3">.</span><span class="s1">factory</span><span class="s3">.</span><span class="s1">invoke</span><span class="s3">(</span><span class="s5">&quot;item&quot;</span><span class="s3">, </span><span class="s1">getter</span><span class="s3">, </span><span class="s1">getter_args</span><span class="s3">)</span>

        <span class="s2">if </span><span class="s1">text</span><span class="s3">:</span>
            <span class="s1">item</span><span class="s3">.</span><span class="s1">setText</span><span class="s3">(</span><span class="s1">text</span><span class="s3">)</span>

        <span class="s2">if </span><span class="s1">status_tip</span><span class="s3">:</span>
            <span class="s1">item</span><span class="s3">.</span><span class="s1">setStatusTip</span><span class="s3">(</span><span class="s1">status_tip</span><span class="s3">)</span>

        <span class="s2">if </span><span class="s1">tool_tip</span><span class="s3">:</span>
            <span class="s1">item</span><span class="s3">.</span><span class="s1">setToolTip</span><span class="s3">(</span><span class="s1">tool_tip</span><span class="s3">)</span>

        <span class="s2">if </span><span class="s1">whats_this</span><span class="s3">:</span>
            <span class="s1">item</span><span class="s3">.</span><span class="s1">setWhatsThis</span><span class="s3">(</span><span class="s1">whats_this</span><span class="s3">)</span>

        <span class="s1">text_alignment </span><span class="s3">= </span><span class="s1">props</span><span class="s3">.</span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'textAlignment'</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">text_alignment</span><span class="s3">:</span>
            <span class="s1">item</span><span class="s3">.</span><span class="s1">setTextAlignment</span><span class="s3">(</span><span class="s1">text_alignment</span><span class="s3">)</span>

        <span class="s1">font </span><span class="s3">= </span><span class="s1">props</span><span class="s3">.</span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'font'</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">font</span><span class="s3">:</span>
            <span class="s1">item</span><span class="s3">.</span><span class="s1">setFont</span><span class="s3">(</span><span class="s1">font</span><span class="s3">)</span>

        <span class="s1">icon </span><span class="s3">= </span><span class="s1">props</span><span class="s3">.</span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'icon'</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">icon</span><span class="s3">:</span>
            <span class="s1">item</span><span class="s3">.</span><span class="s1">setIcon</span><span class="s3">(</span><span class="s1">icon</span><span class="s3">)</span>

        <span class="s1">background </span><span class="s3">= </span><span class="s1">props</span><span class="s3">.</span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'background'</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">background</span><span class="s3">:</span>
            <span class="s1">item</span><span class="s3">.</span><span class="s1">setBackground</span><span class="s3">(</span><span class="s1">background</span><span class="s3">)</span>

        <span class="s1">foreground </span><span class="s3">= </span><span class="s1">props</span><span class="s3">.</span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'foreground'</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">foreground</span><span class="s3">:</span>
            <span class="s1">item</span><span class="s3">.</span><span class="s1">setForeground</span><span class="s3">(</span><span class="s1">foreground</span><span class="s3">)</span>

        <span class="s1">flags </span><span class="s3">= </span><span class="s1">props</span><span class="s3">.</span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'flags'</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">flags</span><span class="s3">:</span>
            <span class="s1">item</span><span class="s3">.</span><span class="s1">setFlags</span><span class="s3">(</span><span class="s1">flags</span><span class="s3">)</span>

        <span class="s1">check_state </span><span class="s3">= </span><span class="s1">props</span><span class="s3">.</span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'checkState'</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">check_state</span><span class="s3">:</span>
            <span class="s1">item</span><span class="s3">.</span><span class="s1">setCheckState</span><span class="s3">(</span><span class="s1">check_state</span><span class="s3">)</span>

        <span class="s2">return </span><span class="s1">item</span>

    <span class="s2">def </span><span class="s1">addHeader</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">elem</span><span class="s3">):</span>
        <span class="s1">w </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">stack</span><span class="s3">.</span><span class="s1">topwidget</span>

        <span class="s2">if </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">w</span><span class="s3">, </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QTreeWidget</span><span class="s3">):</span>
            <span class="s1">props </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span>
            <span class="s1">col </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">column_counter</span>

            <span class="s1">text </span><span class="s3">= </span><span class="s1">props</span><span class="s3">.</span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'text'</span><span class="s3">)</span>
            <span class="s2">if </span><span class="s1">text</span><span class="s3">:</span>
                <span class="s1">w</span><span class="s3">.</span><span class="s1">headerItem</span><span class="s3">().</span><span class="s1">setText</span><span class="s3">(</span><span class="s1">col</span><span class="s3">, </span><span class="s1">text</span><span class="s3">)</span>

            <span class="s1">status_tip </span><span class="s3">= </span><span class="s1">props</span><span class="s3">.</span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'statusTip'</span><span class="s3">)</span>
            <span class="s2">if </span><span class="s1">status_tip</span><span class="s3">:</span>
                <span class="s1">w</span><span class="s3">.</span><span class="s1">headerItem</span><span class="s3">().</span><span class="s1">setStatusTip</span><span class="s3">(</span><span class="s1">col</span><span class="s3">, </span><span class="s1">status_tip</span><span class="s3">)</span>

            <span class="s1">tool_tip </span><span class="s3">= </span><span class="s1">props</span><span class="s3">.</span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'toolTip'</span><span class="s3">)</span>
            <span class="s2">if </span><span class="s1">tool_tip</span><span class="s3">:</span>
                <span class="s1">w</span><span class="s3">.</span><span class="s1">headerItem</span><span class="s3">().</span><span class="s1">setToolTip</span><span class="s3">(</span><span class="s1">col</span><span class="s3">, </span><span class="s1">tool_tip</span><span class="s3">)</span>

            <span class="s1">whats_this </span><span class="s3">= </span><span class="s1">props</span><span class="s3">.</span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'whatsThis'</span><span class="s3">)</span>
            <span class="s2">if </span><span class="s1">whats_this</span><span class="s3">:</span>
                <span class="s1">w</span><span class="s3">.</span><span class="s1">headerItem</span><span class="s3">().</span><span class="s1">setWhatsThis</span><span class="s3">(</span><span class="s1">col</span><span class="s3">, </span><span class="s1">whats_this</span><span class="s3">)</span>

            <span class="s1">text_alignment </span><span class="s3">= </span><span class="s1">props</span><span class="s3">.</span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'textAlignment'</span><span class="s3">)</span>
            <span class="s2">if </span><span class="s1">text_alignment</span><span class="s3">:</span>
                <span class="s1">w</span><span class="s3">.</span><span class="s1">headerItem</span><span class="s3">().</span><span class="s1">setTextAlignment</span><span class="s3">(</span><span class="s1">col</span><span class="s3">, </span><span class="s1">text_alignment</span><span class="s3">)</span>

            <span class="s1">font </span><span class="s3">= </span><span class="s1">props</span><span class="s3">.</span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'font'</span><span class="s3">)</span>
            <span class="s2">if </span><span class="s1">font</span><span class="s3">:</span>
                <span class="s1">w</span><span class="s3">.</span><span class="s1">headerItem</span><span class="s3">().</span><span class="s1">setFont</span><span class="s3">(</span><span class="s1">col</span><span class="s3">, </span><span class="s1">font</span><span class="s3">)</span>

            <span class="s1">icon </span><span class="s3">= </span><span class="s1">props</span><span class="s3">.</span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'icon'</span><span class="s3">)</span>
            <span class="s2">if </span><span class="s1">icon</span><span class="s3">:</span>
                <span class="s1">w</span><span class="s3">.</span><span class="s1">headerItem</span><span class="s3">().</span><span class="s1">setIcon</span><span class="s3">(</span><span class="s1">col</span><span class="s3">, </span><span class="s1">icon</span><span class="s3">)</span>

            <span class="s1">background </span><span class="s3">= </span><span class="s1">props</span><span class="s3">.</span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'background'</span><span class="s3">)</span>
            <span class="s2">if </span><span class="s1">background</span><span class="s3">:</span>
                <span class="s1">w</span><span class="s3">.</span><span class="s1">headerItem</span><span class="s3">().</span><span class="s1">setBackground</span><span class="s3">(</span><span class="s1">col</span><span class="s3">, </span><span class="s1">background</span><span class="s3">)</span>

            <span class="s1">foreground </span><span class="s3">= </span><span class="s1">props</span><span class="s3">.</span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'foreground'</span><span class="s3">)</span>
            <span class="s2">if </span><span class="s1">foreground</span><span class="s3">:</span>
                <span class="s1">w</span><span class="s3">.</span><span class="s1">headerItem</span><span class="s3">().</span><span class="s1">setForeground</span><span class="s3">(</span><span class="s1">col</span><span class="s3">, </span><span class="s1">foreground</span><span class="s3">)</span>

            <span class="s1">self</span><span class="s3">.</span><span class="s1">column_counter </span><span class="s3">+= </span><span class="s6">1</span>

        <span class="s2">elif </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">w</span><span class="s3">, </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QTableWidget</span><span class="s3">):</span>
            <span class="s2">if </span><span class="s1">len</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">) != </span><span class="s6">0</span><span class="s3">:</span>
                <span class="s2">if </span><span class="s1">elem</span><span class="s3">.</span><span class="s1">tag </span><span class="s3">== </span><span class="s5">'column'</span><span class="s3">:</span>
                    <span class="s1">item </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">createWidgetItem</span><span class="s3">(</span><span class="s5">'QTableWidgetItem'</span><span class="s3">, </span><span class="s1">elem</span><span class="s3">,</span>
                            <span class="s1">w</span><span class="s3">.</span><span class="s1">horizontalHeaderItem</span><span class="s3">, </span><span class="s1">self</span><span class="s3">.</span><span class="s1">column_counter</span><span class="s3">)</span>
                    <span class="s1">w</span><span class="s3">.</span><span class="s1">setHorizontalHeaderItem</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">column_counter</span><span class="s3">, </span><span class="s1">item</span><span class="s3">)</span>
                    <span class="s1">self</span><span class="s3">.</span><span class="s1">column_counter </span><span class="s3">+= </span><span class="s6">1</span>
                <span class="s2">elif </span><span class="s1">elem</span><span class="s3">.</span><span class="s1">tag </span><span class="s3">== </span><span class="s5">'row'</span><span class="s3">:</span>
                    <span class="s1">item </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">createWidgetItem</span><span class="s3">(</span><span class="s5">'QTableWidgetItem'</span><span class="s3">, </span><span class="s1">elem</span><span class="s3">,</span>
                            <span class="s1">w</span><span class="s3">.</span><span class="s1">verticalHeaderItem</span><span class="s3">, </span><span class="s1">self</span><span class="s3">.</span><span class="s1">row_counter</span><span class="s3">)</span>
                    <span class="s1">w</span><span class="s3">.</span><span class="s1">setVerticalHeaderItem</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">row_counter</span><span class="s3">, </span><span class="s1">item</span><span class="s3">)</span>
                    <span class="s1">self</span><span class="s3">.</span><span class="s1">row_counter </span><span class="s3">+= </span><span class="s6">1</span>

    <span class="s2">def </span><span class="s1">setZOrder</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">elem</span><span class="s3">):</span>
        <span class="s0"># Designer can generate empty zorder elements.</span>
        <span class="s2">if </span><span class="s1">elem</span><span class="s3">.</span><span class="s1">text </span><span class="s2">is None</span><span class="s3">:</span>
            <span class="s2">return</span>

        <span class="s0"># Designer allows the z-order of spacer items to be specified even</span>
        <span class="s0"># though they can't be raised, so ignore any missing raise_() method.</span>
        <span class="s2">try</span><span class="s3">:</span>
            <span class="s1">getattr</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">toplevelWidget</span><span class="s3">, </span><span class="s1">elem</span><span class="s3">.</span><span class="s1">text</span><span class="s3">).</span><span class="s1">raise_</span><span class="s3">()</span>
        <span class="s2">except </span><span class="s1">AttributeError</span><span class="s3">:</span>
            <span class="s0"># Note that uic issues a warning message.</span>
            <span class="s2">pass</span>

    <span class="s2">def </span><span class="s1">createAction</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">elem</span><span class="s3">):</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">setupObject</span><span class="s3">(</span><span class="s5">&quot;QAction&quot;</span><span class="s3">, </span><span class="s1">self</span><span class="s3">.</span><span class="s1">currentActionGroup </span><span class="s2">or </span><span class="s1">self</span><span class="s3">.</span><span class="s1">toplevelWidget</span><span class="s3">,</span>
                         <span class="s1">elem</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">createActionGroup</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">elem</span><span class="s3">):</span>
        <span class="s1">action_group </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">setupObject</span><span class="s3">(</span><span class="s5">&quot;QActionGroup&quot;</span><span class="s3">, </span><span class="s1">self</span><span class="s3">.</span><span class="s1">toplevelWidget</span><span class="s3">, </span><span class="s1">elem</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">currentActionGroup </span><span class="s3">= </span><span class="s1">action_group</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">traverseWidgetTree</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">currentActionGroup </span><span class="s3">= </span><span class="s2">None</span>

    <span class="s1">widgetTreeItemHandlers </span><span class="s3">= {</span>
        <span class="s5">&quot;widget&quot;    </span><span class="s3">: </span><span class="s1">createWidget</span><span class="s3">,</span>
        <span class="s5">&quot;addaction&quot; </span><span class="s3">: </span><span class="s1">addAction</span><span class="s3">,</span>
        <span class="s5">&quot;layout&quot;    </span><span class="s3">: </span><span class="s1">createLayout</span><span class="s3">,</span>
        <span class="s5">&quot;spacer&quot;    </span><span class="s3">: </span><span class="s1">createSpacer</span><span class="s3">,</span>
        <span class="s5">&quot;item&quot;      </span><span class="s3">: </span><span class="s1">handleItem</span><span class="s3">,</span>
        <span class="s5">&quot;action&quot;    </span><span class="s3">: </span><span class="s1">createAction</span><span class="s3">,</span>
        <span class="s5">&quot;actiongroup&quot;</span><span class="s3">: </span><span class="s1">createActionGroup</span><span class="s3">,</span>
        <span class="s5">&quot;column&quot;    </span><span class="s3">: </span><span class="s1">addHeader</span><span class="s3">,</span>
        <span class="s5">&quot;row&quot;       </span><span class="s3">: </span><span class="s1">addHeader</span><span class="s3">,</span>
        <span class="s5">&quot;zorder&quot;    </span><span class="s3">: </span><span class="s1">setZOrder</span><span class="s3">,</span>
        <span class="s3">}</span>

    <span class="s2">def </span><span class="s1">traverseWidgetTree</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">elem</span><span class="s3">):</span>
        <span class="s2">for </span><span class="s1">child </span><span class="s2">in </span><span class="s1">iter</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">):</span>
            <span class="s2">try</span><span class="s3">:</span>
                <span class="s1">handler </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">widgetTreeItemHandlers</span><span class="s3">[</span><span class="s1">child</span><span class="s3">.</span><span class="s1">tag</span><span class="s3">]</span>
            <span class="s2">except </span><span class="s1">KeyError</span><span class="s3">: </span>
                <span class="s2">continue</span>

            <span class="s1">handler</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">child</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">createUserInterface</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">elem</span><span class="s3">):</span>
        <span class="s0"># Get the names of the class and widget.</span>
        <span class="s1">cname </span><span class="s3">= </span><span class="s1">elem</span><span class="s3">.</span><span class="s1">attrib</span><span class="s3">[</span><span class="s5">&quot;class&quot;</span><span class="s3">]</span>
        <span class="s1">wname </span><span class="s3">= </span><span class="s1">elem</span><span class="s3">.</span><span class="s1">attrib</span><span class="s3">[</span><span class="s5">&quot;name&quot;</span><span class="s3">]</span>

        <span class="s0"># If there was no widget name then derive it from the class name.</span>
        <span class="s2">if not </span><span class="s1">wname</span><span class="s3">:</span>
            <span class="s1">wname </span><span class="s3">= </span><span class="s1">cname</span>

            <span class="s2">if </span><span class="s1">wname</span><span class="s3">.</span><span class="s1">startswith</span><span class="s3">(</span><span class="s5">&quot;Q&quot;</span><span class="s3">):</span>
                <span class="s1">wname </span><span class="s3">= </span><span class="s1">wname</span><span class="s3">[</span><span class="s6">1</span><span class="s3">:]</span>

            <span class="s1">wname </span><span class="s3">= </span><span class="s1">wname</span><span class="s3">[</span><span class="s6">0</span><span class="s3">].</span><span class="s1">lower</span><span class="s3">() + </span><span class="s1">wname</span><span class="s3">[</span><span class="s6">1</span><span class="s3">:]</span>

        <span class="s1">self</span><span class="s3">.</span><span class="s1">toplevelWidget </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">createToplevelWidget</span><span class="s3">(</span><span class="s1">cname</span><span class="s3">, </span><span class="s1">wname</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">toplevelWidget</span><span class="s3">.</span><span class="s1">setObjectName</span><span class="s3">(</span><span class="s1">wname</span><span class="s3">)</span>
        <span class="s1">DEBUG</span><span class="s3">(</span><span class="s5">&quot;toplevel widget is %s&quot;</span><span class="s3">,</span>
              <span class="s1">self</span><span class="s3">.</span><span class="s1">toplevelWidget</span><span class="s3">.</span><span class="s1">metaObject</span><span class="s3">().</span><span class="s1">className</span><span class="s3">())</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">setProperties</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">toplevelWidget</span><span class="s3">, </span><span class="s1">elem</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">stack</span><span class="s3">.</span><span class="s1">push</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">toplevelWidget</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">traverseWidgetTree</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">stack</span><span class="s3">.</span><span class="s1">popWidget</span><span class="s3">()</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">addActions</span><span class="s3">()</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">setBuddies</span><span class="s3">()</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">setDelayedProps</span><span class="s3">()</span>
        
    <span class="s2">def </span><span class="s1">addActions</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s2">for </span><span class="s1">widget</span><span class="s3">, </span><span class="s1">action_name </span><span class="s2">in </span><span class="s1">self</span><span class="s3">.</span><span class="s1">actions</span><span class="s3">:</span>
            <span class="s2">if </span><span class="s1">action_name </span><span class="s3">== </span><span class="s5">&quot;separator&quot;</span><span class="s3">:</span>
                <span class="s1">widget</span><span class="s3">.</span><span class="s1">addSeparator</span><span class="s3">()</span>
            <span class="s2">else</span><span class="s3">:</span>
                <span class="s1">DEBUG</span><span class="s3">(</span><span class="s5">&quot;add action %s to %s&quot;</span><span class="s3">, </span><span class="s1">action_name</span><span class="s3">, </span><span class="s1">widget</span><span class="s3">.</span><span class="s1">objectName</span><span class="s3">())</span>
                <span class="s1">action_obj </span><span class="s3">= </span><span class="s1">getattr</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">toplevelWidget</span><span class="s3">, </span><span class="s1">action_name</span><span class="s3">)</span>
                <span class="s2">if </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">action_obj</span><span class="s3">, </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QMenu</span><span class="s3">):</span>
                    <span class="s1">widget</span><span class="s3">.</span><span class="s1">addAction</span><span class="s3">(</span><span class="s1">action_obj</span><span class="s3">.</span><span class="s1">menuAction</span><span class="s3">())</span>
                <span class="s2">elif not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">action_obj</span><span class="s3">, </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QActionGroup</span><span class="s3">):</span>
                    <span class="s1">widget</span><span class="s3">.</span><span class="s1">addAction</span><span class="s3">(</span><span class="s1">action_obj</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">setDelayedProps</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s2">for </span><span class="s1">widget</span><span class="s3">, </span><span class="s1">layout</span><span class="s3">, </span><span class="s1">setter</span><span class="s3">, </span><span class="s1">args </span><span class="s2">in </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">delayed_props</span><span class="s3">:</span>
            <span class="s2">if </span><span class="s1">layout</span><span class="s3">:</span>
                <span class="s1">widget </span><span class="s3">= </span><span class="s1">widget</span><span class="s3">.</span><span class="s1">layout</span><span class="s3">()</span>

            <span class="s1">setter </span><span class="s3">= </span><span class="s1">getattr</span><span class="s3">(</span><span class="s1">widget</span><span class="s3">, </span><span class="s1">setter</span><span class="s3">)</span>
            <span class="s1">setter</span><span class="s3">(</span><span class="s1">args</span><span class="s3">)</span>
            
    <span class="s2">def </span><span class="s1">setBuddies</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s2">for </span><span class="s1">widget</span><span class="s3">, </span><span class="s1">buddy </span><span class="s2">in </span><span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">buddies</span><span class="s3">:</span>
            <span class="s1">DEBUG</span><span class="s3">(</span><span class="s5">&quot;%s is buddy of %s&quot;</span><span class="s3">, </span><span class="s1">buddy</span><span class="s3">, </span><span class="s1">widget</span><span class="s3">.</span><span class="s1">objectName</span><span class="s3">())</span>
            <span class="s2">try</span><span class="s3">:</span>
                <span class="s1">widget</span><span class="s3">.</span><span class="s1">setBuddy</span><span class="s3">(</span><span class="s1">getattr</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">toplevelWidget</span><span class="s3">, </span><span class="s1">buddy</span><span class="s3">))</span>
            <span class="s2">except </span><span class="s1">AttributeError</span><span class="s3">:</span>
                <span class="s1">DEBUG</span><span class="s3">(</span><span class="s5">&quot;ERROR in ui spec: %s (buddy of %s) does not exist&quot;</span><span class="s3">,</span>
                      <span class="s1">buddy</span><span class="s3">, </span><span class="s1">widget</span><span class="s3">.</span><span class="s1">objectName</span><span class="s3">())</span>

    <span class="s2">def </span><span class="s1">classname</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">elem</span><span class="s3">):</span>
        <span class="s1">DEBUG</span><span class="s3">(</span><span class="s5">&quot;uiname is %s&quot;</span><span class="s3">, </span><span class="s1">elem</span><span class="s3">.</span><span class="s1">text</span><span class="s3">)</span>
        <span class="s1">name </span><span class="s3">= </span><span class="s1">elem</span><span class="s3">.</span><span class="s1">text</span>

        <span class="s2">if </span><span class="s1">name </span><span class="s2">is None</span><span class="s3">:</span>
            <span class="s1">name </span><span class="s3">= </span><span class="s5">&quot;&quot;</span>

        <span class="s1">self</span><span class="s3">.</span><span class="s1">uiname </span><span class="s3">= </span><span class="s1">name</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">uiname </span><span class="s3">= </span><span class="s1">name</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">setContext</span><span class="s3">(</span><span class="s1">name</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">setContext</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">context</span><span class="s3">):</span>
        <span class="s4">&quot;&quot;&quot; 
        Reimplemented by a sub-class if it needs to know the translation 
        context. 
        &quot;&quot;&quot;</span>
        <span class="s2">pass</span>

    <span class="s2">def </span><span class="s1">readDefaults</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">elem</span><span class="s3">):</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">defaults</span><span class="s3">[</span><span class="s5">'margin'</span><span class="s3">] = </span><span class="s1">int</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">.</span><span class="s1">attrib</span><span class="s3">[</span><span class="s5">'margin'</span><span class="s3">])</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">defaults</span><span class="s3">[</span><span class="s5">'spacing'</span><span class="s3">] = </span><span class="s1">int</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">.</span><span class="s1">attrib</span><span class="s3">[</span><span class="s5">'spacing'</span><span class="s3">])</span>

    <span class="s2">def </span><span class="s1">setTaborder</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">elem</span><span class="s3">):</span>
        <span class="s1">lastwidget </span><span class="s3">= </span><span class="s2">None</span>
        <span class="s2">for </span><span class="s1">widget_elem </span><span class="s2">in </span><span class="s1">elem</span><span class="s3">:</span>
            <span class="s1">widget </span><span class="s3">= </span><span class="s1">getattr</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">toplevelWidget</span><span class="s3">, </span><span class="s1">widget_elem</span><span class="s3">.</span><span class="s1">text</span><span class="s3">)</span>

            <span class="s2">if </span><span class="s1">lastwidget </span><span class="s2">is not None</span><span class="s3">:</span>
                <span class="s1">self</span><span class="s3">.</span><span class="s1">toplevelWidget</span><span class="s3">.</span><span class="s1">setTabOrder</span><span class="s3">(</span><span class="s1">lastwidget</span><span class="s3">, </span><span class="s1">widget</span><span class="s3">)</span>

            <span class="s1">lastwidget </span><span class="s3">= </span><span class="s1">widget</span>

    <span class="s2">def </span><span class="s1">readResources</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">elem</span><span class="s3">):</span>
        <span class="s4">&quot;&quot;&quot; 
        Read a &quot;resources&quot; tag and add the module to import to the parser's 
        list of them. 
        &quot;&quot;&quot;</span>
        <span class="s2">try</span><span class="s3">:</span>
            <span class="s1">iterator </span><span class="s3">= </span><span class="s1">getattr</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'iter'</span><span class="s3">)</span>
        <span class="s2">except </span><span class="s1">AttributeError</span><span class="s3">:</span>
            <span class="s1">iterator </span><span class="s3">= </span><span class="s1">getattr</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">, </span><span class="s5">'getiterator'</span><span class="s3">)</span>

        <span class="s2">for </span><span class="s1">include </span><span class="s2">in </span><span class="s1">iterator</span><span class="s3">(</span><span class="s5">&quot;include&quot;</span><span class="s3">):</span>
            <span class="s1">loc </span><span class="s3">= </span><span class="s1">include</span><span class="s3">.</span><span class="s1">attrib</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">&quot;location&quot;</span><span class="s3">)</span>

            <span class="s0"># Apply the convention for naming the Python files generated by</span>
            <span class="s0"># pyrcc5.</span>
            <span class="s2">if </span><span class="s1">loc </span><span class="s2">and </span><span class="s1">loc</span><span class="s3">.</span><span class="s1">endswith</span><span class="s3">(</span><span class="s5">'.qrc'</span><span class="s3">):</span>
                <span class="s1">mname </span><span class="s3">= </span><span class="s1">os</span><span class="s3">.</span><span class="s1">path</span><span class="s3">.</span><span class="s1">basename</span><span class="s3">(</span><span class="s1">loc</span><span class="s3">[:-</span><span class="s6">4</span><span class="s3">] + </span><span class="s1">self</span><span class="s3">.</span><span class="s1">_resource_suffix</span><span class="s3">)</span>
                <span class="s2">if </span><span class="s1">mname </span><span class="s2">not in </span><span class="s1">self</span><span class="s3">.</span><span class="s1">resources</span><span class="s3">:</span>
                    <span class="s1">self</span><span class="s3">.</span><span class="s1">resources</span><span class="s3">.</span><span class="s1">append</span><span class="s3">(</span><span class="s1">mname</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">createConnections</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">elem</span><span class="s3">):</span>
        <span class="s2">def </span><span class="s1">name2object</span><span class="s3">(</span><span class="s1">obj</span><span class="s3">):</span>
            <span class="s2">if </span><span class="s1">obj </span><span class="s3">== </span><span class="s1">self</span><span class="s3">.</span><span class="s1">uiname</span><span class="s3">:</span>
                <span class="s2">return </span><span class="s1">self</span><span class="s3">.</span><span class="s1">toplevelWidget</span>
            <span class="s2">else</span><span class="s3">:</span>
                <span class="s2">return </span><span class="s1">getattr</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">toplevelWidget</span><span class="s3">, </span><span class="s1">obj</span><span class="s3">)</span>

        <span class="s2">for </span><span class="s1">conn </span><span class="s2">in </span><span class="s1">iter</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">):</span>
            <span class="s1">signal </span><span class="s3">= </span><span class="s1">conn</span><span class="s3">.</span><span class="s1">findtext</span><span class="s3">(</span><span class="s5">'signal'</span><span class="s3">)</span>
            <span class="s1">signal_name</span><span class="s3">, </span><span class="s1">signal_args </span><span class="s3">= </span><span class="s1">signal</span><span class="s3">.</span><span class="s1">split</span><span class="s3">(</span><span class="s5">'('</span><span class="s3">)</span>
            <span class="s1">signal_args </span><span class="s3">= </span><span class="s1">signal_args</span><span class="s3">[:-</span><span class="s6">1</span><span class="s3">].</span><span class="s1">replace</span><span class="s3">(</span><span class="s5">' '</span><span class="s3">, </span><span class="s5">''</span><span class="s3">)</span>
            <span class="s1">sender </span><span class="s3">= </span><span class="s1">name2object</span><span class="s3">(</span><span class="s1">conn</span><span class="s3">.</span><span class="s1">findtext</span><span class="s3">(</span><span class="s5">'sender'</span><span class="s3">))</span>
            <span class="s1">bound_signal </span><span class="s3">= </span><span class="s1">getattr</span><span class="s3">(</span><span class="s1">sender</span><span class="s3">, </span><span class="s1">signal_name</span><span class="s3">)</span>

            <span class="s1">slot </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">factory</span><span class="s3">.</span><span class="s1">getSlot</span><span class="s3">(</span><span class="s1">name2object</span><span class="s3">(</span><span class="s1">conn</span><span class="s3">.</span><span class="s1">findtext</span><span class="s3">(</span><span class="s5">'receiver'</span><span class="s3">)),</span>
                    <span class="s1">conn</span><span class="s3">.</span><span class="s1">findtext</span><span class="s3">(</span><span class="s5">'slot'</span><span class="s3">).</span><span class="s1">split</span><span class="s3">(</span><span class="s5">'('</span><span class="s3">)[</span><span class="s6">0</span><span class="s3">])</span>

            <span class="s2">if </span><span class="s1">signal_args </span><span class="s3">== </span><span class="s5">''</span><span class="s3">:</span>
                <span class="s1">bound_signal</span><span class="s3">.</span><span class="s1">connect</span><span class="s3">(</span><span class="s1">slot</span><span class="s3">)</span>
            <span class="s2">else</span><span class="s3">:</span>
                <span class="s1">signal_args </span><span class="s3">= </span><span class="s1">signal_args</span><span class="s3">.</span><span class="s1">split</span><span class="s3">(</span><span class="s5">','</span><span class="s3">)</span>

                <span class="s2">if </span><span class="s1">len</span><span class="s3">(</span><span class="s1">signal_args</span><span class="s3">) == </span><span class="s6">1</span><span class="s3">:</span>
                    <span class="s1">bound_signal</span><span class="s3">[</span><span class="s1">signal_args</span><span class="s3">[</span><span class="s6">0</span><span class="s3">]].</span><span class="s1">connect</span><span class="s3">(</span><span class="s1">slot</span><span class="s3">)</span>
                <span class="s2">else</span><span class="s3">:</span>
                    <span class="s1">bound_signal</span><span class="s3">[</span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">signal_args</span><span class="s3">)].</span><span class="s1">connect</span><span class="s3">(</span><span class="s1">slot</span><span class="s3">)</span>

        <span class="s1">QtCore</span><span class="s3">.</span><span class="s1">QMetaObject</span><span class="s3">.</span><span class="s1">connectSlotsByName</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">toplevelWidget</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">customWidgets</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">elem</span><span class="s3">):</span>
        <span class="s2">def </span><span class="s1">header2module</span><span class="s3">(</span><span class="s1">header</span><span class="s3">):</span>
            <span class="s4">&quot;&quot;&quot;header2module(header) -&gt; string 
 
            Convert paths to C++ header files to according Python modules 
            &gt;&gt;&gt; header2module(&quot;foo/bar/baz.h&quot;) 
            'foo.bar.baz' 
            &quot;&quot;&quot;</span>
            <span class="s2">if </span><span class="s1">header</span><span class="s3">.</span><span class="s1">endswith</span><span class="s3">(</span><span class="s5">&quot;.h&quot;</span><span class="s3">):</span>
                <span class="s1">header </span><span class="s3">= </span><span class="s1">header</span><span class="s3">[:-</span><span class="s6">2</span><span class="s3">]</span>

            <span class="s1">mpath </span><span class="s3">= []</span>
            <span class="s2">for </span><span class="s1">part </span><span class="s2">in </span><span class="s1">header</span><span class="s3">.</span><span class="s1">split</span><span class="s3">(</span><span class="s5">'/'</span><span class="s3">):</span>
                <span class="s0"># Ignore any empty parts or those that refer to the current</span>
                <span class="s0"># directory.</span>
                <span class="s2">if </span><span class="s1">part </span><span class="s2">not in </span><span class="s3">(</span><span class="s5">''</span><span class="s3">, </span><span class="s5">'.'</span><span class="s3">):</span>
                    <span class="s2">if </span><span class="s1">part </span><span class="s3">== </span><span class="s5">'..'</span><span class="s3">:</span>
                        <span class="s0"># We should allow this for Python3.</span>
                        <span class="s2">raise </span><span class="s1">SyntaxError</span><span class="s3">(</span><span class="s5">&quot;custom widget header file name may not contain '..'.&quot;</span><span class="s3">)</span>

                    <span class="s1">mpath</span><span class="s3">.</span><span class="s1">append</span><span class="s3">(</span><span class="s1">part</span><span class="s3">)</span>

            <span class="s2">return </span><span class="s5">'.'</span><span class="s3">.</span><span class="s1">join</span><span class="s3">(</span><span class="s1">mpath</span><span class="s3">)</span>
    
        <span class="s2">for </span><span class="s1">custom_widget </span><span class="s2">in </span><span class="s1">iter</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">):</span>
            <span class="s1">classname </span><span class="s3">= </span><span class="s1">custom_widget</span><span class="s3">.</span><span class="s1">findtext</span><span class="s3">(</span><span class="s5">&quot;class&quot;</span><span class="s3">)</span>
            <span class="s1">self</span><span class="s3">.</span><span class="s1">factory</span><span class="s3">.</span><span class="s1">addCustomWidget</span><span class="s3">(</span><span class="s1">classname</span><span class="s3">,</span>
                                     <span class="s1">custom_widget</span><span class="s3">.</span><span class="s1">findtext</span><span class="s3">(</span><span class="s5">&quot;extends&quot;</span><span class="s3">) </span><span class="s2">or </span><span class="s5">&quot;QWidget&quot;</span><span class="s3">,</span>
                                     <span class="s1">header2module</span><span class="s3">(</span><span class="s1">custom_widget</span><span class="s3">.</span><span class="s1">findtext</span><span class="s3">(</span><span class="s5">&quot;header&quot;</span><span class="s3">)))</span>

    <span class="s2">def </span><span class="s1">createToplevelWidget</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">classname</span><span class="s3">, </span><span class="s1">widgetname</span><span class="s3">):</span>
        <span class="s2">raise </span><span class="s1">NotImplementedError</span>

    <span class="s2">def </span><span class="s1">buttonGroups</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">elem</span><span class="s3">):</span>
        <span class="s2">for </span><span class="s1">button_group </span><span class="s2">in </span><span class="s1">iter</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">):</span>
            <span class="s2">if </span><span class="s1">button_group</span><span class="s3">.</span><span class="s1">tag </span><span class="s3">== </span><span class="s5">'buttongroup'</span><span class="s3">:</span>
                <span class="s1">bg_name </span><span class="s3">= </span><span class="s1">button_group</span><span class="s3">.</span><span class="s1">attrib</span><span class="s3">[</span><span class="s5">'name'</span><span class="s3">]</span>
                <span class="s1">bg </span><span class="s3">= </span><span class="s1">ButtonGroup</span><span class="s3">()</span>
                <span class="s1">self</span><span class="s3">.</span><span class="s1">button_groups</span><span class="s3">[</span><span class="s1">bg_name</span><span class="s3">] = </span><span class="s1">bg</span>

                <span class="s1">prop </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">getProperty</span><span class="s3">(</span><span class="s1">button_group</span><span class="s3">, </span><span class="s5">'exclusive'</span><span class="s3">)</span>
                <span class="s2">if </span><span class="s1">prop </span><span class="s2">is not None</span><span class="s3">:</span>
                    <span class="s2">if </span><span class="s1">prop</span><span class="s3">.</span><span class="s1">findtext</span><span class="s3">(</span><span class="s5">'bool'</span><span class="s3">) == </span><span class="s5">'false'</span><span class="s3">:</span>
                        <span class="s1">bg</span><span class="s3">.</span><span class="s1">exclusive </span><span class="s3">= </span><span class="s2">False</span>

    <span class="s0"># finalize will be called after the whole tree has been parsed and can be</span>
    <span class="s0"># overridden.</span>
    <span class="s2">def </span><span class="s1">finalize</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s2">pass</span>

    <span class="s2">def </span><span class="s1">parse</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">filename</span><span class="s3">, </span><span class="s1">resource_suffix</span><span class="s3">):</span>
        <span class="s2">if </span><span class="s1">hasattr</span><span class="s3">(</span><span class="s1">filename</span><span class="s3">, </span><span class="s5">'read'</span><span class="s3">):</span>
            <span class="s1">base_dir </span><span class="s3">= </span><span class="s5">''</span>
        <span class="s2">else</span><span class="s3">:</span>
            <span class="s0"># Allow the filename to be a QString.</span>
            <span class="s1">filename </span><span class="s3">= </span><span class="s1">str</span><span class="s3">(</span><span class="s1">filename</span><span class="s3">)</span>
            <span class="s1">base_dir </span><span class="s3">= </span><span class="s1">os</span><span class="s3">.</span><span class="s1">path</span><span class="s3">.</span><span class="s1">dirname</span><span class="s3">(</span><span class="s1">filename</span><span class="s3">)</span>

        <span class="s1">self</span><span class="s3">.</span><span class="s1">wprops</span><span class="s3">.</span><span class="s1">set_base_dir</span><span class="s3">(</span><span class="s1">base_dir</span><span class="s3">)</span>

        <span class="s1">self</span><span class="s3">.</span><span class="s1">_resource_suffix </span><span class="s3">= </span><span class="s1">resource_suffix</span>

        <span class="s0"># The order in which the different branches are handled is important.</span>
        <span class="s0"># The widget tree handler relies on all custom widgets being known, and</span>
        <span class="s0"># in order to create the connections, all widgets have to be populated.</span>
        <span class="s1">branchHandlers </span><span class="s3">= (</span>
            <span class="s3">(</span><span class="s5">&quot;layoutdefault&quot;</span><span class="s3">, </span><span class="s1">self</span><span class="s3">.</span><span class="s1">readDefaults</span><span class="s3">),</span>
            <span class="s3">(</span><span class="s5">&quot;class&quot;</span><span class="s3">,         </span><span class="s1">self</span><span class="s3">.</span><span class="s1">classname</span><span class="s3">),</span>
            <span class="s3">(</span><span class="s5">&quot;buttongroups&quot;</span><span class="s3">,  </span><span class="s1">self</span><span class="s3">.</span><span class="s1">buttonGroups</span><span class="s3">),</span>
            <span class="s3">(</span><span class="s5">&quot;customwidgets&quot;</span><span class="s3">, </span><span class="s1">self</span><span class="s3">.</span><span class="s1">customWidgets</span><span class="s3">),</span>
            <span class="s3">(</span><span class="s5">&quot;widget&quot;</span><span class="s3">,        </span><span class="s1">self</span><span class="s3">.</span><span class="s1">createUserInterface</span><span class="s3">),</span>
            <span class="s3">(</span><span class="s5">&quot;connections&quot;</span><span class="s3">,   </span><span class="s1">self</span><span class="s3">.</span><span class="s1">createConnections</span><span class="s3">),</span>
            <span class="s3">(</span><span class="s5">&quot;tabstops&quot;</span><span class="s3">,      </span><span class="s1">self</span><span class="s3">.</span><span class="s1">setTaborder</span><span class="s3">),</span>
            <span class="s3">(</span><span class="s5">&quot;resources&quot;</span><span class="s3">,     </span><span class="s1">self</span><span class="s3">.</span><span class="s1">readResources</span><span class="s3">),</span>
        <span class="s3">)</span>

        <span class="s1">document </span><span class="s3">= </span><span class="s1">parse</span><span class="s3">(</span><span class="s1">filename</span><span class="s3">)</span>
        <span class="s1">root </span><span class="s3">= </span><span class="s1">document</span><span class="s3">.</span><span class="s1">getroot</span><span class="s3">()</span>

        <span class="s2">if </span><span class="s1">root</span><span class="s3">.</span><span class="s1">tag </span><span class="s3">!= </span><span class="s5">'ui'</span><span class="s3">:</span>
            <span class="s2">raise </span><span class="s1">SyntaxError</span><span class="s3">(</span><span class="s5">&quot;not created by Qt Designer&quot;</span><span class="s3">)</span>

        <span class="s1">version </span><span class="s3">= </span><span class="s1">root</span><span class="s3">.</span><span class="s1">attrib</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'version'</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">version </span><span class="s2">is None</span><span class="s3">:</span>
            <span class="s2">raise </span><span class="s1">SyntaxError</span><span class="s3">(</span><span class="s5">&quot;missing version number&quot;</span><span class="s3">)</span>

        <span class="s0"># Right now, only version 4.0 is supported.</span>
        <span class="s2">if </span><span class="s1">version </span><span class="s3">!= </span><span class="s5">'4.0'</span><span class="s3">:</span>
            <span class="s2">raise </span><span class="s1">SyntaxError</span><span class="s3">(</span><span class="s5">&quot;only Qt Designer files v4.0 are supported&quot;</span><span class="s3">)</span>

        <span class="s2">for </span><span class="s1">tagname</span><span class="s3">, </span><span class="s1">actor </span><span class="s2">in </span><span class="s1">branchHandlers</span><span class="s3">:</span>
            <span class="s1">elem </span><span class="s3">= </span><span class="s1">document</span><span class="s3">.</span><span class="s1">find</span><span class="s3">(</span><span class="s1">tagname</span><span class="s3">)</span>
            <span class="s2">if </span><span class="s1">elem </span><span class="s2">is not None</span><span class="s3">:</span>
                <span class="s1">actor</span><span class="s3">(</span><span class="s1">elem</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">finalize</span><span class="s3">()</span>
        <span class="s1">w </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">toplevelWidget</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">reset</span><span class="s3">()</span>
        <span class="s2">return </span><span class="s1">w</span>

    <span class="s3">@</span><span class="s1">staticmethod</span>
    <span class="s2">def </span><span class="s1">_form_layout_role</span><span class="s3">(</span><span class="s1">layout_position</span><span class="s3">):</span>
        <span class="s2">if </span><span class="s1">layout_position</span><span class="s3">[</span><span class="s6">3</span><span class="s3">] &gt; </span><span class="s6">1</span><span class="s3">:</span>
            <span class="s1">role </span><span class="s3">= </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QFormLayout</span><span class="s3">.</span><span class="s1">SpanningRole</span>
        <span class="s2">elif </span><span class="s1">layout_position</span><span class="s3">[</span><span class="s6">1</span><span class="s3">] == </span><span class="s6">1</span><span class="s3">:</span>
            <span class="s1">role </span><span class="s3">= </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QFormLayout</span><span class="s3">.</span><span class="s1">FieldRole</span>
        <span class="s2">else</span><span class="s3">:</span>
            <span class="s1">role </span><span class="s3">= </span><span class="s1">QtWidgets</span><span class="s3">.</span><span class="s1">QFormLayout</span><span class="s3">.</span><span class="s1">LabelRole</span>

        <span class="s2">return </span><span class="s1">role</span>
</pre>
</body>
</html>